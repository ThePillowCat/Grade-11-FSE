/**
 * Version: baf4caef7b0dd7471dd76c3dc5db25e58fe75145ce31e12f9f3da02c27b2a1fb
 * Bundle: phase2
 **/

cf.resources.confirm('bundle_phase2', function() {

/* modules: alerts */

"use strict";cf.module("alerts",function(t){return{types:{alertType:function(e){e.inherit("text"),e.data&&""!=e.data||(e.data=t.nt(e.nt()).string[1])}}}});

/* modules: hover */

"use strict";cf.module("hover",function(e,s,t,r){var o={_defaults:{hoverClass:"xds-hover-hoverable-hovered",timeout:70},_hoverClass:"xds-hover-hoverable-hovered",_hoverableClass:"xds-hover-hoverable",_hoverInEvent:"xdsHoverIn",_hoverOutEvent:"xdsHoverOut",_timeout:70,_settings:{},_handlers:{timerExpire:function(){if(o._settings.lastHovered){if(o._settings.curHovered&&o._settings.lastHovered[0].id==o._settings.curHovered[0].id)return;var e={to:!1};o._settings.curHovered&&(e.to=o._settings.curHovered),o._settings.lastHovered.removeClass(o._hoverClass).trigger(o._hoverOutEvent,e)}if(o._settings.curHovered){var s={from:o._settings.lastHovered};o._settings.lastHovered=o._settings.curHovered.trigger(o._hoverInEvent,s).addClass(o._hoverClass)}else o._settings.lastHovered=!1;o._settings.timer=!1},onLeave:function(e){o._settings.curHovered=!1},onMove:function(e){o._settings.timer&&s.clearTimeout(o._settings.timer),o._settings.curHovered=$(this),o._settings.timer=s.setTimeout(o._handlers.timerExpire,o._timeout)}},init:function(t,r,i){e.platform.mobile||(o.unbindAll(),o._hoverClass=t.arg("hoverClass")||o._defaults.hoverClass,o._timeout=t.arg("hoverTimeout")||o._defaults.timeout,o._settings.timer&&s.clearTimeout(o._settings.timer),o._settings.lastHovered&&o._handlers.timerExpire(),o._settings={timer:!1})},unbindAll:function(){$("."+o._hoverableClass).removeClass(o._hoverClass).off("mousemove",o._handlers.onMove).off("mouseleave",o._handlers.onLeave)},register:function(e,s,t){$(e.id()).on("mousemove",o._handlers.onMove).on("mouseleave",o._handlers.onLeave).addClass(o._hoverableClass)}};return o});

/* modules: planner */

"use strict";cf.module("planner",function(r,t,e,n){return{fn:{filterCoursePlan:function(r){if(r.data){var t=r.data.tree,e=!1,n=function(r){return r.length>=1&&3!=r[0].state&&{tree:r=e(r)}},a=(e=function(r){var t=[];for(var e in r)if(r.hasOwnProperty(e)){var a=r[e];a&&a.tree&&(a=n(a.tree)),a&&t.push(a)}return t})(t);r.data.tree=a}}}}});

/* modules: polls */

"use strict";cf.module("polls",function(t,e,a,o){var l={fieldInput:"xds-polls-types-f_enum-input",fieldWrapper:"xds-polls-types-f_enum-field",virtual:"xds-forms-field-virtual",addButton:"xds-polls-types-f_enum-addfield",graphVoted:"xds-polls-type-pollGraph-voted"},s=function(e){return t.tpl(e,l)},n=!1,i=!1;return{fn:{cacheQuestion:function(t){i=t.val(),13==t.e.keyCode&&(t.stopPropagation(),t.preventDefault())},viewVotes:function(e){var a=e.siblings.likersList;if(a&&a.liker&&a.liker.length>0){var o=t.clone(e.parent_xdo().xds.fields.likersList);o.type="responsive.layout.body",o.id="body",o.sparse=!0,e.event("lightbox",{xds:{xds:{id:"voterslightbox",fields:[{id:"title",type:"lightbox.title",title:e.get_arg("lightboxTitle")||e.get_arg("label")},o],_responsive:[{p:{type:"responsive.layout.page"},c:{cols:3}}]},data:{body:a}}})}}},types:{question:function(e){!e.data&&i&&(e.data=i,i=!1),e.data&&(e.data=t.get("sanitizer").sanitize(e.data,"textonly"))},f_enum:function(e){var a,l,i=2,r=function(e,a,o){var l=t.tpl(t.lang("Answer {{idx}}"),{idx:""+(parseInt(e)+1)}),n="xds-polls-types-f_enum-field-last";return!1===a&&(n=""),t.tpl(s("<div class='{{fieldWrapper}} {{lastClass}}'><input class='{{fieldInput}} xdl-forms-input {{virtual}}' type='text' name='{{idx}}' value='{{defaultValue}}' aria-label='{{placeholder}}' placeholder='{{placeholder}}' autocapitalize='sentences'></div>"),{idx:e,lastClass:n,placeholder:l,defaultValue:o||""})},d=function(){e.get_parent(1).find(s(".{{fieldInput}}")).off("change"),e.get_parent(1).find(s(".{{fieldInput}}")).on("keydown",function(t){var a,o=e.get_parent(1).find(s(".{{fieldInput}}"));if(13===t.keyCode&&!t.shiftKey){if($(this).attr("name")==$(o[o.length-1]).attr("name"))e.trigger("addField");else for(a=0;a<o.length;a++)if($(this).attr("name")==$(o[a]).attr("name")){$(o[a+1]).focus();break}t.stopPropagation(),t.preventDefault()}}),e.get_parent(1).find(s(".{{fieldInput}}")).on("keyup",function(t){e.trigger("updateEnum")}),e.on("updateEnum",function(t){var a,o=e.get_parent(1).find(s(".{{fieldInput}}")),l={},i=0;for(a=0;a<o.length;a++)$(o[a]).val().trim()&&(l[i+1]=$(o[a]).val(),i+=1);e.dom().val(JSON.stringify(l)),n=JSON.stringify(l);var r=0;for(a in l)l.hasOwnProperty(a)&&(r+=1);var d="show";r<2&&(d="hide"),e.target("*footer")[d]()})},p=[],v=[];if(e.get_val())for(l in a=JSON.parse(e.get_val()))p[parseInt(l,10)]=a[l];if(e.xds.fields){var u=-1;for(l in e.xds.fields)++u<p.length||(p[u]=e.xds.fields[l].title)}for(;p.length<2;)p.push(o);for(i in p)v.push(r(i,i===p.length-1,p[i]));i=parseInt(i)+1,e.arg("wrap","div").inherit("f_hidden").preclosetag(v.join("")+s("<div role='button' aria-label='"+t.lang("Add Poll Option")+"' class='{{addButton}}' tabindex=\"0\"></div>")).ready(function(){e.get_parent(1).find(s(".{{addButton}}")).on("click",function(){e.trigger("addField")}).on("keydown",function(t){[13,32].includes(t.keyCode)&&(e.trigger("addField"),t.stopPropagation(),t.preventDefault())}),d(),e.trigger("updateEnum")}).on("addField",function(e,a,o){var l=i;e.dom().parent().find(".xds-polls-types-f_enum-field-last").removeClass("xds-polls-types-f_enum-field-last"),$(r(i++)).insertBefore(e.get_parent(1).find(s(".{{addButton}}"))),$(t.tpl(s("input.{{fieldInput}}[name={{idx}}]"),{idx:l})).focus(),d()})},simplePollActionTitle:function(t){var e=t.state.get("votes")||0,a=t.state.get("likers");a&&(e=a.length),t.xds.appendTitle=!0,t.set_val(e),e>1?t.xds.title=t.arg("titleMulti"):1==e?t.xds.title=t.arg("titleSingle"):t.exitBlank()},simplePoll:function(e){var a=e.get_val(e.arg("votesField")),l=e.get_val(e.arg("votedField")),s=e.arg("preVoteTitle"),n="xds-polls-types-simplePoll-title",i="xds-polls-types-simplePoll-noVotes",r="xds-polls-types-simplePoll-voteCount",d={count:"",countClass:r,titleClass:n};e.arg("noShowCount")?d.count="":a&&a>0&&(e.arg("noCommands")===o||!e.arg("noCommands"))?d.count=a:d.countClass=d.countClass+" "+i,l&&(s=e.arg("postVoteTitle"),e.addClass("Like-unlike")),e.arg("noCommands")&&(s="",e.addClass("xds-polls-types-simplePoll-noCommands")),s=t.tpl(s,d),a&&a>0||e.addClass(i),e.state.set("votes",a),e.inherit("block").postclosetag(s).arg("wrap","span"),e.on("voted",function(e,o,p){p.trigger_altprops&&(p=p.trigger_altprops);var v=p.newVal,u=!1;a=isNaN(parseInt(a))?0:parseInt(a),"1"===v?(l=!0,a+=1):(l=!1,a-=1),e.state.set("voted",l),u=a>0;var g=function(t,a){var o=t.split("-"),l=e.data;l||(e.data={},l=e.data);for(var s=0;s<o.length;s++)l[o[s]]||(l[o[s]]={}),s==o.length-1&&(l[o[s]]=a),l=l[o[s]]};if(g(e.arg("votesField"),a),g(e.arg("votedField"),l),e.arg("votersField")){e.find(".Like-like-likers");var c={cdLiker:[]};if(e.state.get("likers")&&(c.cdLiker=e.state.get("likers")),l){for(var f=!1,h=0;h<c.cdLiker.length;h++)if(c.cdLiker[h].nid===t.gbl.user.nid){f=!0;break}f||c.cdLiker.push({profpic:t.gbl.user.profpic,nid:t.gbl.user.nid,unid:t.gbl.user.nid,name:t.gbl.user.name})}else{for(var x=[],y=0;y<c.cdLiker.length;y++)c.cdLiker[y].nid!=t.gbl.user.nid&&x.push(c.cdLiker[y]);c.cdLiker=x}e.state.set("likers",c.cdLiker),c.cdLiker.length>0&&(u=!0)}u?e.dom().removeClass(i):e.dom().addClass(i),s=l?e.arg("postVoteTitle"):e.arg("preVoteTitle"),e.update(),d.count=a,d.countClass=r,e.arg("noShowCount")?d.count="":0==a&&(d.count="",d.countClass=r+" "+i),e.state.set("votes",a),s=t.tpl(s,d),e.parent_xdo(1).find("."+r).remove(),e.parent_xdo(1).find("."+n).replaceWith(s)})},pollGraph:function(a){!a.data.enum&&n&&(a.data.enum=n,n=!1),a.tag("div");var l=a.data.enum,s=a.data.vote,i=a.arg("showResults")!==o?a.arg("showResults"):a.get_val("showResults")||0,r=a.arg("showEligible"),d=a.get_val("createid")==t.gbl.user.nid,p=""==a.get_val("createid")||a.get_val("createid")==t.gbl.user.nid||s&&s.voted||!1,v=s&&s.tally||!1,u=s&&s.votes||0,g=a.data.voters||!1,c=a.data.eligible||!1,f=a.data.eligiblenames||!1,h=r?c.length:u,x=a.arg("xdsVote")&&a.get_perm(a.arg("xdsVote"))&&(!r||-1!==(c||[]).indexOf(t.gbl.user.nid)),y=function(e){var a=t.lang("{{count}} votes");return 1===e&&(a=t.lang("{{count}} vote")),t.tpl(a,{count:""+e})},m=function(e,o){if(p||i&&!x){var l,s=0,n="0";return v&&v[e]&&(n=v[e],s=v[e]/h*100),l=y(n),t.tpl("<div class='xds-polls-type-pollGraph-voted'><span class='xds-polls-type-pollGraph-title'>{{val}}</span><div class='xds-polls-type-pollGraph-voteblock'><div class='xds-polls-type-pollGraph-votes {{colourClass}}' style='width: 0%;' targetWidth='{{percent}}'></div></div><span class='xds-polls-type-pollGraph-votecount'><span class='xds-polls-type-pollGraph-votecount-percent'>{{pctStr}}</span><span class='xds-polls-type-pollGraph-votecount-count'>{{countStr}}</span></span></div>",{val:t.get("sanitizer").sanitize(o,"textonly"),countStr:l,percent:s,pctStr:Math.round(100*s)/100+"%",colourClass:"xds-polls-types-pollGraph-colour-"+(e-1)%4})}return t.tpl("<div class='xds-polls-type-pollGraph-option'><input type='radio' name='{{id}}-{{name}}-vote' value='{{idx}}' name='{{val}}' aria-label='{{val}}'><span class='xds-polls-type-pollGraph-title'>{{val}}</span></input></div>",{name:a.name(),idx:e,val:t.get("sanitizer").sanitize(o,"textonly"),id:a.id()})};try{l=JSON.parse(l)}catch(t){l=!1}var b=function(){var e,o,s={cdVotes:[]},n={},i={},d=-1,p=h;for(o in l)l.hasOwnProperty(o)&&(e={title:t.get("sanitizer").sanitize(l[o],"textonly"),id:o,votecount:{count:0,percent:0},voters:!1,votes:0},v&&v[o]&&(p-=v[o],e.votecount.count=v[o],e.votecount.percent=e.votes=Math.round(v[o]/h*1e4)/100),n[o]=e,s.cdVotes.push(e),d=Math.max(d,parseInt(o,10)));if(r&&((e={title:a.arg("textNoResponse")||t.lang("No response"),id:++d,votecount:{count:p,percent:Math.round(p/h*1e4)/100},voters:!1,votes:0}).votes=e.votecount.percent,n[d]=e,s.cdVotes.push(e)),g&&g.voter)for(o=0;o<g.voter.length;o++)(e=n[g.voter[o].value]).voters||(e.voters={voter:[]}),i[g.voter[o].nid]=!0,e.voters.voter.push(g.voter[o]);if(r&&f)for(o=0;o<f.length;o++)i[f[o].nid]||((e=n[d]).voters||(e.voters={voter:[]}),e.voters.voter.push(f[o]));a.map(s)};b();var k=function(){if(l&&!p&&x){var e,a=[];for(e in l)l.hasOwnProperty(e)&&a.push(m(e,l[e]));return a.join("")}return!p&&!x&&!i||p&&!i&&!d?t.lang("The creator of this poll has chosen to keep the results private."):d||p&&i?"":t.lang("Unable to view poll due to permissions restrictions.")};a.posttag("<div class='contents'>"+k()+"</div>"),p||a.on("pollVote",function(e,a,o){var l=e.get_parent(1).find("input:checked");l.length>0&&t.post({url:{nid:e.cnid(),xds:e.arg("xdsVote")},data:{vote:l.attr("value")},success:function(){var a,o;s||(e.data.vote={},s=e.data.vote),(o=jQuery.extend({},e.data)).vote||(o.vote={}),(a=o.vote).voted=!0,v?(a.tally[l.attr("value")]+=1,a.votes+=1):((v=a.tally={})[l.attr("value")]=1,a.votes=1),e.trigger("xds-notif-version"),t.notif.nodetag.fire(!1,!0,"submitPoll"),e.trigger("pollDataChanged",o),e.trigger("xds-poll-voting-completed")}})}),p&&(a.addClass("xds-polls-type-pollGraph-voted"),a.ready(function(){e.setTimeout(function(){var t,e=a.find(".xds-polls-type-pollGraph-votes");for(t=0;t<e.length;t++)parseFloat($(e[t]).attr("targetWidth"))&&$(e[t]).css("width",$(e[t]).attr("targetWidth")+"%");for(e=a.find(".xds-polls-types-percentageGraph-fill"),t=0;t<e.length;t++)parseFloat($(e[t]).attr("targetWidth"))&&$(e[t]).css("width",$(e[t]).attr("targetWidth")+"%")},100)})),x||a.addClass("xds-polls-type-pollGraph-unvotable"),i||d?a.on("votersListRetrieved",function(t,e,a){t.data.voters=g=a.voters,t.data.eligiblenames=f=a.eligible,b(),t.update(),t.data.voters?t.dom().addClass("xds-polls-type-pollGraph-votersShown"):t.dom().removeClass("xds-polls-type-pollGraph-votersShown")}).on("pollDataChanged",function(t,e,a){var o=!1;t.data.voters&&(o=!0),delete t.data.voters;var l=!1;if(p||a.vote&&a.vote.voted&&(t.data.vote=a.vote,p=t.data.vote.voted,t.dom().find(".contents").html(k()),l=!0,t.dom().find(".xds-poll-voteButton").hide()),a.vote&&a.vote.tally){var s,n,i,r,d=a.vote.votes,g=t.find(".xds-polls-types-percentageGraph-fill");for(s=0;s<g.length;s++)n=s+1,((i=a.vote.tally[n]||0)!==(v[n]||0)||d!==u||l)&&(r=i/d*100,$(g[s]).css("width",r+"%").parent().parent().find(".xds-polls-type-pollGraph-votecount").html(y(i)));t.data.vote=a.vote}b(),t.update(),o&&t.trigger("xds-poll-internal-getVoters")}):a.on("pollDataChanged",function(t,e,a){!p&&a.vote&&a.vote.voted&&(t.data.vote=a.vote,p=t.data.vote.voted,t.dom().find(".contents").html(k()),b(),t.update())})},percentageGraph:function(t){t.tag("div").displayVal="<div class='xds-polls-types-percentageGraph-fill' style='width: 0%;' targetWidth='"+t.data+"'>&nbsp;</div>",t.on("dataUpdated",function(t){t.find(".xds-polls-types-percentageGraph-fill").css("width",t.data+"%")})},templatedTitle:function(e){var a=e.arg("titleIfNone")||"0";1==e.data?a=e.arg("titleIfOne"):e.data>1&&(a=e.arg("title")),a=a||"{{data}}",e.tag("span").displayVal=t.tpl(a,{data:t.get("sanitizer").sanitize(""+e.data,"strict")})},voteRow:function(t){t.tag("div")}},getVoters:function(e){t.ajax({xdo:e,url:{nid:e.nid(),xds:e.get_arg("xds")},callback:function(t){t&&t.slices&&t.slices.length>0&&t.slices[0].data&&e.trigger("votersListRetrieved",t.slices[0].data)}})},hideVoters:function(t){t.trigger("votersListRetrieved",!1)},canViewVotes:function(e){var a=e.get_val("createid")==t.gbl.user.nid,o=e.parent_xdo();return a||o.data&&o.data.vote&&o.data.vote.voted&&o.data.showResults},hasVotes:function(t){var e=t.siblings.votes,a=0;if(e){for(var o=0;o<e.length;o++)a+=e[o].votes;if(a>0)return!0}return!1}}});

/* modules: toc */

"use strict";function asyncGeneratorStep(t,e,i,a,r,n,s){try{var o=t[n](s),d=o.value}catch(t){return void i(t)}o.done?e(d):Promise.resolve(d).then(a,r)}function _asyncToGenerator(t){return function(){var e=this,i=arguments;return new Promise(function(a,r){var n=t.apply(e,i);function s(t){asyncGeneratorStep(n,a,r,s,o,"next",t)}function o(t){asyncGeneratorStep(n,a,r,s,o,"throw",t)}s(void 0)})}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}cf.module("toc",function(t,e,i){var a=0,r=function(){function e(i,r,n){if(_classCallCheck(this,e),t.is_xdo(i)){var s=i;this.isRoot=!0,i=i.data||{},this.data=i,this.data.id=s.nid(),this.xds=s.arg("xds"),this.xdsFetch=s.arg("xdsFetch"),this.tocIncluded=s.arg("included"),this.nid=s.nid(),this.xdoref=s.ref()}if("string"==typeof i)throw new Error("Invalid TOC");this.data=i,this.root=n||this,this.parent=r,this.idMap={},this.data.id?this.id=this.data.id:(a++,this.id=this.data.id="f"+a),this.root.idMap[this.id]=this,this.walk(i&&i.items)}return _createClass(e,[{key:"walk",value:function(i,a){var r=this;this.items=[],t.is_arr(i)&&i.map(function(t){r.idMap[t.id]=new e(t,r,r.root),r.isRoot&&(r.idMap[t.id].isTreeTop=!0),r.items.push(r.idMap[t.id])})}},{key:"queueOp",value:function(t){return this._key&&(t.key=this._key),this._ops?this._ops.push(t):(this._ops=[t],this.exec()),this}},{key:"add",value:function(e,i,a){a||(a=i,i="after");var r={op:"add",path:e};return t.extend(r,a),this.queueOp(r)}},{key:"addAfter",value:function(t){throw new Error("Not Implemented")}},{key:"addBefore",value:function(t){throw new Error("Not Implemented")}},{key:"addInside",value:function(t){throw new Error("Not Implemented")}},{key:"update",value:function(e,i){var a={op:"update",path:e};return t.extend(a,i),this.queueOp(a)}},{key:"copy",value:function(t,e,i,a){return this.queueOp({op:"copy",pathnid:t,path:e,dest:i,where:a})}},{key:"restore",value:function(t){if(t)return this.queueOp({op:"update",path:t,display:null});this.root.restore(this.id)}},{key:"del",value:function(t){if(t)return this.queueOp({op:"del",path:t});this.root.del(this.id)}},{key:"updateId",value:function(t){var e=this.id;return this.id=t,this.root.idMap[this.id]=this,delete this.root.idMap[e],this}},{key:"key",value:function(t){return this._key=t,this}},{key:"move",value:function(t,e,i){return"inside"===i&&(i="sub"),this.queueOp({op:"move",path:t,dest:e,where:i})}},{key:"altNid",value:function(t){return this._altNid=t,this}},{key:"multi",value:function(){return this._ops=[],this}},{key:"local",value:function(){return this._local=!0,this}},{key:"getRaw",value:function(t){return[]}},{key:"localOp",value:function(t){if("add"===t.op){var i=t.where||"after",a=this.idMap[t.path||this.root.nid];if("after"===i){var r=""==t.path?this.root:a.parent;r.data.items||(r.data.items=[]);var n,s=r.data.items;s.map(function(t,e){t.id==a.id&&(n=e)});var o=s.slice(0,n+1),d={};for(var u in t)"path"!==u&&"op"!==u&&(d[u]=t[u]);o.push(d),r.data.items=o.concat(s.slice(n+1)),this.root.idMap[t.nid]=new e(d,r,this.root)}}}},{key:"localOps",value:function(t){var e=this;t.map(function(t){e.localOp(t)})}},{key:"commit",value:function(){if(this.data.temp){delete this.data.temp;var t=this.data.origop;delete this.data.origop,this.root.add(t.path,t.where,this.data)}else this.root.update(this.id,this.data)}},{key:"exec",value:function(e){var i=this,a=this._ops,r=this._altNid||this.nid,n=this._altNid;return delete this._ops,delete this._key,delete this._altNid,this._local?(delete this._local,void this.localOps(a)):(t.post({url:{nid:r,xds:this.xds},data:{toccmds:JSON.stringify(a)},callback:function(e){e.results&&e.results.map(function(e){e.error&&t.dialog(e.error)}),n||i.refresh(e.toc)}}),this)}},{key:"refresh",value:function(t){t&&this.xdo&&(this.xdo.data=t),this.data=t,this.xdo.update()}},{key:"fetch",value:function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.ajax({url:{nid:this.nid,xds:this.xdsFetch},xdo:this.xdo}).then(function(e){var a=e.slices[0].data,r=a;if(i.xdo){if(i.tocIncluded){var n=i.xdo.path.split("-");n.shift();var s=n.join("-");i.xdo.data=t.search(s,a)}else i.xdo.data=r.toc;return i.refresh(r.toc),i.xdo.setTimeout(function(){i.xdo.update()},0),i.data}}));case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getIdFromNid",value:function(t){var e=this.itemByNid(t);return!!e&&e.id}},{key:"itemByNid",value:function(e){var i=!1;return function a(r){t.is_arr(r)&&r.map(function(t){t.nid!=e?t.items&&a(t.items):i=t})}(this.root.data.items),i}},{key:"flat",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=[];return function a(r){t.is_arr(r)&&r.map(function(t){("del"!==t.display||"del"==t.display&&e)&&(i.push(t),t.items&&a(t.items))})}(this.root.data.items),i}},{key:"summarize",value:function(){var t=this.flat(!1),e={};for(var i in t)if(!t[i].display||"del"!==t[i].display){var a="6.61";t[i].type&&(a=t[i].type),void 0===e[a]?e[a]=1:e[a]=e[a]+1}return e}},{key:"xdo",get:function(){return this.xdoref.resolve()},set:function(t){this.xdoref=t.ref()}}]),e}(),n={init:function(t){if(!(t.data instanceof r)){var e=new r(t);e.name=t.arg("name")||"toc",t.state.set(e.name,e)}},Toc:r};return t.toc=n,n});

/* resources: AffectedState */

"use strict";cf.resource("AffectedState",function(t,e,r){var n={"-1":"",1:"😀",2:"😕",3:"😴"};return{menu:function(t){var e=t.state.get("astate")||-1,r=n[e];t.xds.title=r,t.wrapTitle=!0,t.inherit("dd.menu")}}});

/* resources: CartridgeView */

"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}cf.resource("CartridgeView",function(e,t,a){var i={RENDER:["text/plain","text/html","application/edsby"],iframePrefix:{"application/vnd.openxmlformats-officedocument.wordprocessingml.document":"https://view.officeapps.live.com/op/view.aspx?src=","application/msword":"https://view.officeapps.live.com/op/view.aspx?src=","application/vnd.ms-word.document.macroEnabled.12":"https://view.officeapps.live.com/op/view.aspx?src=","application/vnd.ms-excel":"https://view.officeapps.live.com/op/view.aspx?src=","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"https://view.officeapps.live.com/op/view.aspx?src=","application/vnd.ms-excel.sheet.macroEnabled.12":"https://view.officeapps.live.com/op/view.aspx?src=","application/vnd.ms-excel.sheet.binary.macroEnabled.12":"https://view.officeapps.live.com/op/view.aspx?src=","application/vnd.ms-powerpoint":"https://view.officeapps.live.com/op/view.aspx?src=","application/vnd.openxmlformats-officedocument.presentationml.presentation":"https://view.officeapps.live.com/op/view.aspx?src=","application/vnd.openxmlformats-officedocument.presentationml.slideshow":"https://view.officeapps.live.com/op/view.aspx?src=","application/vnd.ms-powerpoint.presentation.macroEnabled.12":"https://view.officeapps.live.com/op/view.aspx?src=","application/vnd.ms-powerpoint.slideshow.macroEnabled.12":"https://view.officeapps.live.com/op/view.aspx?src=","application/pdf":e.gbl.lib+"/pdf_js/web/viewer.html?file="},edsbyMap:{},resourceMap:{},utils:{progress:{},handleNewItem:function(t,a,i){var o=function(){var e=t.state.top().get("toc");t.state.top().set("activeObject",a.nid),t.update_setting("objectMode",2),t.state.top().set("objectMode",2),e.local().add(i.dest,i.where,a)},n=t.target("*frameBody").find(e.$css.dirtyForm);n.length>0?n.xdo.closeForm().then(o):o()},mergeOld:function(t){var a=e.obj_to_arr(t.items),o=[];a.map(function(e){4!=e.nodesubtype||i.manifestMap[e.nid]||(o.push(e),i.manifestMap[e.nid]=e),e.type=e.nodetype+"."+e.nodesubtype,e.ctype="application/edsby"}),a.map(function(e){if(3==e.nodesubtype&&!i.manifestMap[e.nid]){if(e.thread||(e.thread=-1),-1===e.thread){var t=i.manifestMap[e.thread];t||(t={title:"Unit",items:[]},i.manifestMap[-1]=t,o.push(t))}var a=i.manifestMap[e.thread];a&&(a.items||(a.items=[]),a.items.push(e))}}),!i.manifest&&o.length&&(i.manifest={organizations:[]}),o.length&&i.manifest.organizations.push({items:o})},manifestMap:function(){i.manifestMap={};for(var e=i.manifest&&i.manifest.organizations.length,t=function e(t){t&&t.nid&&(i.manifestMap[t.nid]=t),t&&t.items&&t.items.map(e)};e--;)t(i.manifest.organizations[e])},getSettings:function(t){var a=t&&t.data||{},o={};if(a.href&&(o.href=a.href),i.edsbyMap[a.type]){var n=i.edsbyMap[a.type];e.is_arr(n)&&(n=n[0]),o.xdsEdit=n.xdsEdit,o.xdsView=n.xdsView}else o.xdsEdit="LOPageEdit";return o.nid=a.nid,o.rid=a.rid,o.cnid=[e.gbl.nid,a.rid,a.nid].join("/"),o},get:function(e,t){return e.state.get("toc").idMap[t]},getActive:function(e){return i.utils.get(e,void 0===e.state.top().get("activeObject")?"":e.state.top().get("activeObject"))},markDocumentComplete:function(t,a,o){var n=t;a&&(n=n.caller());var r=i.utils.getActive(n);if(r.data.nid)return e.get("cfnp").get(n,{xds:n.arg("xds"),nid:[n.nid(),r.data.nid]}).then(function(){o&&t.dom().hide(),n.state.set("progress-"+r.data.nid,1);var e=n.state.peek("overallprogress");if(e&&e.combo){e.combo.completed[r.data.nid]=1;var a=Object.keys(e.combo.completed).length/e.combo.total;e.combo.progress=a,n.state.set("overallprogress",JSON.parse(JSON.stringify(e)))}1===n.state.top().get("conditionalrelease")&&n.trigger("xds-lo-completed",{docnid:n.nid()})})},dimensions:function(){return{width:100,height:e.window.height()-(e.layout.isPhone()?34:200)}},insert:function(e,t){var a=t.shift(),o=i.manifest.organizations[a];o||(i.manifest.organizations.push({items:[]}),o=i.manifest.organizations[i.manifest.organizations.length-1]);for(var n=t.pop(),r=o,s=t.shift();s;)r=r.items[s],s=t.shift();r.items||(r.items=[]),r.items.splice(n,0,e)},replace:function(e,t){},save:function(t){e.post({url:{nid:i.nid,xds:i.xdsSave},data:{manifest:JSON.stringify(i.manifest)},callback:function(){i.$saved.resolve().update_setting("objectMode",1),i.$saved.resolve().state.set("objectMode",1),t&&t(),i.$saved.resolve().dom().show(),i.$saved.resolve().setTimeout(function(){i.$saved.resolve().dom().hide()},1e3)}})}},myprogress:function(e){var t=e.data;t&&t.combo&&(t.cprogress=t.combo.progress,t.complete=t.cprogress),t||e.exitBlank()},progressUpdate:function(t){if(t.state.setnx("progress",t.state.get("progress")||{}),t.has_role("Class Owner")||t.has_role("Moderator"))t.exitBlank();else{var a=t.state.get("progress");for(var i in a)t.state.top().set("progress-"+i,1);0==Object.keys(a).length&&t.setTimeout(function(){o()}),t.on("update",o),t.exitBlank()}function o(){e.get_data({nid:t.nid(),xds:t.arg("xds"),_t:Date.now()},function(a){var i=t.state.get("progress");a&&a.combo&&(e.extend(i,a.combo.completed),Object.keys(i).length>0&&t.state.update("progress"),t.state.set("overallprogress",JSON.parse(JSON.stringify(a))),t.state.set("myprogress",a.combo.completed))})}},init:function(t){t.state.setnx("objectMode",1),t.global("copierSkipDateUpdate",!0),t.ready(function(e){i.$saved=e.target("*saved").xdo.ref()}),i.rmap={},t.arg("noninteractive")?t.state.set("interactive",!1):t.state.set("interactive",!0);var a=t.has_write(t.arg("xds"));if(!a&&t.arg("selectableRoles")){var o=t.arg("selectableRoles").split(","),n=!0,r=!1,s=void 0;try{for(var d,c=o[Symbol.iterator]();!(n=(d=c.next()).done);n=!0){var l=d.value;if(t.has_role(l)){a=!0;break}}}catch(e){r=!0,s=e}finally{try{n||null==c.return||c.return()}finally{if(r)throw s}}}if(!a&&t.arg("selectableNodeTypes")){var p=t.arg("selectableNodeTypes").split(","),f=!0,g=!1,u=void 0;try{for(var m,v=p[Symbol.iterator]();!(f=(m=v.next()).done);f=!0){var h=m.value,b=e.lookup("nt",h);if(t.nt()===b.val()){a=!0;break}}}catch(e){g=!0,u=e}finally{try{f||null==v.return||v.return()}finally{if(g)throw u}}}a&&t.state.set("buttonBar",!0)},noContent:function(e){i.titleRendered?e.exit(!0):(e.addClass("xds-CartridgeView-item"),e.addClass("xds-CartridgeView-item-inside"),e.inherit("CartridgeView.dropTarget"),e.inherit("noContent"))},fullScreenButton:function(e){if(!e.state.get("activeObject")||1!=e.state.get("objectMode"))return!1;e.state.get("fullScreen")?(e.arg("icon","compress-arrows-alt"),e.tooltip=!1,e.xds.title=e.arg("titleExit"),e.inherit("fa.icon")):(e.arg("icon","expand-arrows-alt"),e.showTitle=!1,delete e.tooltip,e.inherit("fa.glyph")),e.on("click",function(e){var t=!e.state.get("fullScreen");e.state.set("fullScreen",t),e.state.global().set("containsFullScreen",t)}),e.state.get("fullScreen")&&e.ready("addClass",{className:"xds-CartridgeView-fullscreen",target:"*frame"})},modeButton:function(e){var t=e.arg("mode")||"editMode",a=e.state.get(t);e.displayVal=a?e.arg("titleClose"):e.arg("title"),e.on("click",function(){e.state.set(t,!a)}),i.xdsSave=e.arg("xds"),e.showTitle=!1},visibilityChange:function(e){var t=e.state.data.release;void 0===t&&(t=2);var a,i="";if(0==t)i="toggle-off",a=2;else{if(2!=t)return e.exitBlank();i="toggle-on",a=0,e.addStyle("color","#74b844")}for(var o=e.get_toc().parent;o;)0==o.data.release&&e.addStyle("color","#cccccc"),o=o.parent;var n=function(e,t){var a=e.get_toc();e.state.get("toc").update(a.id,{release:t})};e.on("click",function(e){n(e,a)}),e.on("keyup",function(e){if(e.eventKeyIs(["LEFT","RIGHT","ENTER"])){if(e.eventKeyIs("LEFT")?a=0:e.eventKeyIs("RIGHT")&&(a=2),a===t)return;n(e,a)}}),e.inherit("fa.glyph",{icon:i})},addMenu:function(t){delete t.xds._children,delete t.xds.fields;var a=t.nt();if(i.edsbyMap[a]){var o=i.edsbyMap[a];if(e.is_arr(o)&&(o=o[0]),o.leafNode)return void t.exitBlank()}for(var n=[t.nt()],r=t.get_toc().parent;r;)r.data.type&&n.push(r.data.type),r=r.parent;var s,d,c,l=[];for(c in i.edsbyMap){s=!1;var p=n.pop(),f=i.edsbyMap[c];for(d in e.is_arr(f)||(f=[f]),f){if(f[d].menuSuppress)s=!0;else for(;p;)f[p]&&f[p].exclude&&f[p].exclude[d]&&(s=!0),p=n.pop();!1===s&&l.push(e.extend({},f[d]))}}l.sort(function(e,t){return e.menuIndex===t.menuIndex?0:e.menuIndex<t.menuIndex?-1:1});var g=[],u=!1;for(var m in l){var v=l[m].group;u||(u=l[m].group),v!==u&&g.push({id:"sep".concat(m),section:!0,sparse:!0}),u=v,g.push(l[m])}t.addChild(g),t.inherit("dd.glyph")},registerDefs:function(t){t.arg("reset")&&(i.edsbyMap={});for(var a=t.get_children(),o=0,n=Object.values(a),r=function(){var t=n[s],a=t.nt?e.lookup("nt",t.nt).val():t.id,r={nt:t.nt,xdsEdit:t.xdsEdit,xdsView:t.xdsView,command:t.command,title:t.title,id:t.id,type:"CartridgeView.newItemMenu",icon:t.icon,fa_class:t.fa_class,leafNode:t.leafNode,exclude:{},noIcon:t.noIcon,menuIndex:o,group:t.group};t.ctypeicon&&(r.ctypeicon=t.ctypeicon),t.tooltip&&(r.tooltip=t.tooltip),t.menuSuppress&&(r.menuSuppress=!0),t.exclude&&t.exclude.map(function(t){r.exclude[e.lookup("nt",t).val()]=1}),t.showif&&(r.showif=t.showif),i.edsbyMap[a]&&(e.is_arr(i.edsbyMap[a])||(i.edsbyMap[a]=[i.edsbyMap[a]])),e.is_arr(i.edsbyMap[a])?i.edsbyMap[a].push(r):i.edsbyMap[a]=r,o+=1},s=0;s<n.length;s++)r();return!1},addNewItem:function(t){var a,o,n=e.nt.Document.Unit(),r=e.nt.Document.Section(),s=(e.nt.Container.Class(),t.get_toc()),d=function(t){return t.split(".").shift()===e.nt.Container()};if(s){a=s.id;var c=t.arg("nt");if(c){var l=e.lookup("nt",c).val();o=!(!d(s.data.type)||d(l))||((s.data.type==n||s.data.type==r)&&l!=n&&l!=r||s.data.type==n&&l==r)}}else if(i.activeObjectRef&&i.titleRendered){var p=i.activeObjectRef.resolve(),f=e.lookup("nt",t.xds.nt).val();o=(p.data.type==n||p.data.type==r)&&t.xds.nt&&f!=n&&f!=r,a=p.state.get("id")}else a="";var g={op:"create",dest:a,where:o?"sub":void 0},u={type:t.arg("nt")&&e.lookup("nt",t.arg("nt")).val(),title:e.lang("Untitled"),temp:1,id:-1,nid:-1,tocArgs:{op:"create",dest:a,where:o?"sub":void 0},args:{command:t.arg("command"),xds:t.arg("xdsEdit")}};i.utils.handleNewItem(t,u,g)},newItemSimple:function(e){e.inherit("button"),e.on("click",i.addNewItem)},newItemMenu:function(e){e.on("click",i.addNewItem)},toc:function(e){try{$(".ui-droppable").droppable("destroy"),$(".ui-draggable").draggable("destroy")}catch(e){}},navButton:function(t){0==t.dom().length&&(t.ready(function(){t.update()}),t.state.top().get("activeObjectRef")),1==t.arg("value")?e.get("CartridgeView").navNext(t,!1,!1,!0)||t.exitBlank():-1==t.arg("value")&&(e.get("CartridgeView").navPrev(t,!1,!1,!0)||t.exitBlank()),t.state.top().get("navButton")===t.arg("value")&&(t.state.top().clear("navButton"),t.ready(function(){t.dom().focus()}))},navPrev:function(e,t,a,o){if(!i.activeObjectRef)return!1;var n=i.activeObjectRef.resolve();if(!o&&e.state.set("navButton",-1),!n)return!1;var r=function e(t){var a=".xds-CartridgeView-item",i=".xds-CartridgeView-title",o=":not(.xds-CartridgeView-title-noAction)",n=t.prevAll(a+","+i).filter(o);if(n.is(a))return n.find(i).last();if(n.is(i))return n;var r=t.parent(),s=r.find(i).filter(o);return s.length?(s=s.first()).xdo.get_toc().id!=t.xdo.get_toc().id&&(s.is(i)?s:(n=s.find(i).filter(o).last()).length?n:e(n)):!!(s=r.prevAll(a+","+i).filter(o)).length&&s.xdo.get_toc().id!=t.xdo.get_toc().id&&(s.is(i)?s:(n=s.find(i).filter(o).last()).length?n:e(n))}(n.dom());if(!r||o)return r||!1;r.trigger("click")},navNext:function(e,t,a,o){if(!o&&e.state.set("navButton",1),!i.activeObjectRef)return!1;var n=i.activeObjectRef.resolve(),r=".xds-CartridgeView-item",s=".xds-CartridgeView-title",d=":not(.xds-CartridgeView-title-noAction)",c=0;if(!n)return!1;var l=!1;if(!(l=(n=n.dom()).find(r).length?n.find(r).find(s).first():function e(t){c++;var a=t.nextAll(r+","+s).filter(d);if(a.is(r))return a.find(s).filter(d).first();if(a.is(s))return a;var i=t.parent(),o=i.nextAll(r+","+s).filter(d);return o.length?o.is(s)?o:(a=o.find(s).filter(d).first()).length?a:e(a):!(i.is("body")||c>100)&&e(i)}(n))||o)return l;l.trigger("click")},completedMarker:function(e){e.state.top().get("progress-"+e.nid())||e.exitBlank()},item:function(t){if(!t.data)return!1;var a=t.state.get("release")||{},o=a.mode;void 0===o&&(o=1);var n=a.object,r=t.has_role("Moderator")||t.has_role("Class Owner");if(!1!==o&&""!==o&&!r){if(4==o&&!t.state.top().get("progress-"+n))return t.exitBlank();if(0==o)return t.exitBlank();if(5==o||6==o){var s=t.state.get("grades");if(!s||!s[n]||!s[n][5===o?"v":"e"])return t.exitBlank()}}if("False"===t.state.get("isvisible")&&!t.state.get("viewHidden"))return t.addClass("xds-CartridgeView-title-noAction"),t.exitBlank();if(r&&!1!==o&&1!=o&&""!==o&&t.state.set("showHidden",!0),t.data.data.type==e.nt.Document.IndividualAssessment()&&t.state.set("individualAssessment",t.data.data.show?e.lang("Individualized"):e.lang("Unassigned")),0==t.state.data.release&&t.addClass("invisible"),"del"==t.state.get("display")){if(!t.state.top().get("showDel"))return t.exitBlank();t.addSubClass("deleted")}if(t.state.data.temp&&t.addSubClass("temp"),t.state.data.type&&!t.state.data.nodetype){var d=(t.state.data.type+"").split(".");t.state.data.nodetype=d[0],t.state.data.nodesubtype=d[1]}t.state.data.type===e.lookup("nt","Document.Unit").val()?t.state.data.unit=t.state.data.nid:t.state.data.unit=t.get_val("unit"),t.arg("maxDepth"),t.state.peek("activeObject")||e.links.getnid()!=t.nid()||t.state.top().set("activeObject",t.state.get("id")),t.state.get("href")&&(i.resourceMap[t.state.get("href")]=t.state.data),t.state.set("apath",!0),t.state.get("id")==t.state.top().peek("activeObject")&&(t.addSubClass("activeObject"),i.activeObjectRef=t.ref(),t.state.top().set("activeObjectRef",i.activeObjectRef)),t.state.top().watch("activeObject",function(e){t.state.get("id")===e?(t.dom().addClass(t.genSubClass("activeObject")),i.activeObjectRef=t.ref(),t.state.top().set("activeObjectRef",i.activeObjectRef)):t.dom().removeClass(t.genSubClass("activeObject"))},!0),!t.rnode.href&&t.rnode.identifier&&i.rmap[t.rnode.identifier]&&(t.rnode.href=i.rmap[t.rnode.identifier].href)},itemprogress:function(e){e.sparse=!0,1!=e.state.get("enableprogress")&&e.exitBlank()},copyItem:function(t){t.on("click",function(t){t.newEvent("copier.copy",{copyextra:{toc_pathnid:e.gbl.nid,toc_id:t.get_toc().id}})})},clearSelection:function(t){e.layout.isPhone()||e.links.clearHash(),t.state.top().clear("activeObject"),t.state.top().clear("activeObjectRef")},clearSelectionAndLoad:function(t){var a={xds:t.get_arg("xds")||t.arg("xds"),nid:t.get_arg("nid")||t.nid(),target:t.get_arg("target")||t.arg("target")},o=function(){if("*frameBody"===a.target){var e=t.target("*frameBody"),i="xds-CartridgeView-frameBody-contains";if(e.length){var o=e[0].classList.entries();for(var n in o)n.indexOf(i)>=0&&e.removeClass(n);e.addClass("".concat(i,"-").concat(a.xds))}}};if(t.state.top().peek("activeObject")){var n=function(){e.layout.isPhone()?(i.clearSelection(t),t.event("loadxds")):(t.state.top().promise().then(function(){t.event("loadxds",a),o()}),i.clearSelection(t))},r=t.target(a.target).find(e.$css.dirtyForm);r.length>0?r.xdo.closeForm().then(n):n()}else t.event("loadxds");o()},cutItem:function(t){t.on("click",function(t){t.newEvent("copier.cut",{copyextra:{toc_pathnid:e.gbl.nid,toc_id:t.get_toc().id},toggleFunc:"noop"})})},pasteItem:function(t){e.get("copier").pasteAvailable(t)||t.exitBlank();var a=t.nt(),o=i.edsbyMap[a];i.edsbyMap[a]&&(e.is_arr(o)&&(o=o[0]),o.leafNode&&"sub"==t.arg("where"))?t.exitBlank():o&&("sub"==t.arg("where")||o&&o.leafNode)?t.on("click",function(e){var t=e.get_toc().id,a=e.arg("where")||"sub";e.state.get("toc").xdo.newEvent("copier.paste",{toc_destid:t,toc:e.state.get("toc"),toc_where:a})}):t.exitBlank()},removeItem:function(e){e.on("click",function(e){var t=e.state.top().peek("activeObject"),a=e.get_toc();t&&a.id==t&&i.clearSelection(e),a.del()})},restoreItem:function(e){e.on("click",function(e){e.get_toc().restore()})},dropTarget:function(t){e.lang(" Move after"),e.lang("Move before");var a="dropAfter"===t.xds.id,o="item"===t.xds.id||"noContent"==t.xds.id||"inside"==t.xds.id,n=a?"after":o?"inside":"before",r=!0;t.get_toc()&&(t.get_toc().isTreeTop&&o||o&&t.nt()!=e.nt.Container.PDGroup()&&t.nt()!=e.nt.Document.Unit()&&t.nt()!=e.nt.Document.Section()&&!t.state.data.section&&(r=!1),t.addSubClass(n),t.state.get("editMode")&&t.ready(function(t){t.dom().droppable({greedy:!0,tolerance:"intersect",hoverClass:t.genSubClass("hover"),activeClass:t.genSubClass("active"),accept:function(a){var n=a.xdo.get_toc(),s=t.get_toc();if(!r)return!1;if(i.edsbyMap[t.nt()]&&i.edsbyMap[a.xdo.nt()]){var d=i.edsbyMap[t.nt()],c=i.edsbyMap[a.xdo.nt()];if(e.is_arr(d)&&(d=d[0]),e.is_arr(c)&&(c=c[0]),o&&c&&d.exclude&&d.exclude[a.xdo.nt()])return!1;if(d.leafNode&&!c.leafNode)return!1}if(s&&n){return!function(e,t){for(var a=e.parent;a&&!a.isRoot;){if(a.id==t.id)return!0;a=a.parent}return!1}(s,n)}return!1},drop:function(a,o){if(r){var s,d=o.draggable.xdo,c=t;if(s="noContent"==c.xds.id?"*":c.state.get("id"),"copy"===d.arg("command"))e.post({url:{xds:"CopyCoursePlanEntry",command:"copy",nid:d.nid(),_new:1},data:{_dest:e.gbl.nid,_new:1},callback:function(e){var a={nid:e.nid,rid:e.rid,type:d.nt(),title:d.get_val("details-name")||d.get_val("title")||d.get_val("name")};i.utils.handleNewItem(a,s),t.update_setting("objectMode",1),t.state.top().set("objectMode",1),i.activeObject=s,t.get_xdo("*sequenceTable").update(),t.get_xdo("*frame").update(),i.utils.save()}});else if(d.arg("newItem"))t.get_xdo("*frameBody").trigger("loadNewItemForm",{dragged:d.ref(),dropped:c.ref(),dest:s});else{var l=d.state.get("id");s!=l&&t.state.get("toc").move(l,s,n)}}}}),t.on("xds-removed",function(e){e.dom().data("ui-droppable")&&e.dom().droppable("destroy")}),t.dom().addClass("xds-removed")}))},itemRow:function(a){if(a.tagNodetype(),a.has_role("Student")&&a.nt()===e.nt.Document.OnlineTest())return!1;if(a.sparse=1,a.state.get("id")==a.state.top().peek("activeObject")&&a.addSubClass("activeObject"),a.state.top().watch("activeObject",function(e){a.state.get("id")===e?a.dom().addClass(a.genSubClass("activeObject")):a.dom().removeClass(a.genSubClass("activeObject"))},!0),a.state.get("editMode")&&a.ready(function(e){e.dom().draggable({helper:"clone",snap:"true",appendTo:".CartridgeView-master-sequenceTable-wrapper-scroll-toc",handle:e.get_target("*move"),revert:"invalid",scroll:!0,start:function(t,a){$(a.helper).addClass("xds-CartridgeView-draggable-helper"),e.addClass("xds-CartridgeView-draggable-original"),e.get_parent(1).addClass("xds-CartridgeView-contains-dragItem"),e.target(".CartridgeView").addClass("xds-CartridgeView-dragActive")},stop:function(a,i){e.target(".CartridgeView").removeClass("xds-CartridgeView-dragActive"),e.get_parent(1).removeClass("xds-CartridgeView-contains-dragItem"),e.removeClass("xds-CartridgeView-draggable-original");var o=e.target(".xds-CartridgeView-scrollContainer");t.clearTimeout(o.xdo.temp.scrollTimer)},drag:function(a,i){var o=e.target(".xds-CartridgeView-scrollContainer");!function e(){var i=o.offset(),n=o.outerHeight(),r=o[0].scrollHeight,s=o[0].scrollTop,d=a.clientY-i.top;n-d<=30&&s<r-n?o[0].scrollTop=s+20:d<30&&s>0&&(o[0].scrollTop=s-20),t.clearTimeout(o.xdo.temp.scrollTimer),o.xdo.temp.scrollTimer=o.xdo.setTimeout(e,50)}()}}),e.on("xds-removed",function(e){e.dom().data("ui-draggable")&&e.dom().draggable("destroy")}),e.dom().addClass("xds-removed")}),a.get_toc()){if(!a.get_toc().data.href&&!a.nt())return a.addSubClass("section"),a.state.data.noAction=!0,a.state.data.section=!0,void a.inherit("CartridgeView.dropTarget");a.get_toc().isTreeTop&&a.addSubClass("top"),a.addChild({xds:{id:"drop",showif:"state:editMode",fields:[{id:"dropBefore",type:"CartridgeView.dropTarget",sparse:!0},{id:"inside",type:"CartridgeView.dropTarget",sparse:!0},{id:"dropAfter",type:"CartridgeView.dropTarget",sparse:!0}],sparse:!0,css:"xds-CartridgeView-item-dropTargets"}}),a.state.local("ur")&&a.addClass(e.css.unread),a.state.get("interactive")&&a.on("click",function(t){var a=function(){if(t.state.clear("ur"),t.setTimeout(function(){!e.layout.isPhone()&&e.links.getnid()!=t.nid()&&e.links.setHash(t.nid())}),t.state.top().set("activeObject",t.state.get("id")),t.trigger("xds-sco-load",{object:i.utils.getActive(t),manifest:i.manifest}),t.update_setting("objectMode",1),t.state.top().set("objectMode",1),!t.get_xdo("*frame")){var a={xds:t.xdsid(),nid:t.state.top().get("nid")};t.event("loadPage",a)}t.setTimeout(function(){t.get_xdo("*aprogress")&&t.get_xdo("*aprogress").trigger("update"),"auto"==t.state.peek("MarkComplete")&&t.state.get("toc").fetch()},100)},o=t.get_xdo("*frame");o&&o.find("form").xdo?o.find("form").xdo.closeForm().then(function(){t.setTimeout(a,1)},function(){e.log.debug("CartridgeView.itemRow[click]: navigation cancelled")}).catch(function(){e.log.debug("CartridgeView.itemRow[click]: navigation cancelled")}):a()})}else e.log.warn({message:"CartridgeView.itemRow unexpected error",body:"Item has no Toc: ".concat(a.id())})},moveHandle:function(e){e.state.get("editMode")?e.inherit("fa.glyph",{icon:"bars"}):e.exit(!0)},icon:function(t){var a="file",o={};if(t.state.data.noAction||t.get_toc().isTreeTop)return t.exitBlank(),!1;var n=t.nt();if(i.edsbyMap[n]&&i.edsbyMap[n].icon){var r=!1;if(i.edsbyMap[n].ctypeicon&&t.get_val("ctype")){var s=e.get("files").registry.get(t.get_val("ctype"),"",!0);s&&s.icon&&(r=s.icon)}r||(r=i.edsbyMap[n].icon),a=r}if(i.edsbyMap[n]&&i.edsbyMap[n].noIcon)return!1;a&&(o.icon=a,i.edsbyMap[n]&&i.edsbyMap[n].fa_class&&(o.fa_class=i.edsbyMap[n].fa_class),t.inherit("fa.glyph",o))},title:function(t){var a=(t.state.data.ctype||"").split(";")[0];"False"!==t.get_val("isvisible","rnode")||t.state.get("viewHidden")?(t.sparse=1,!1===t.get_val()&&(t.displayVal=e.lang("Untitled"),t.addSubClass("untitled")),a&&-1===e.in_array(a,i.RENDER)&&t.state.data.href&&t.state.set("download",1),t.state.data.noAction&&(t.addSubClass("noAction"),t.temp.noAction=1),t.data&&(t.data=e.mlescape(t.data)),i.titleRendered=!0):t.exitBlank()},layoutManager:function(e){if(void 0!==e.get_setting("objectMode")){var t=parseInt(e.get_setting("objectMode"));isNaN(t)||e.state.set("objectMode",t)}var a;e.state.global().watch("containsFullScreen",(a=e.ref(),function(e){var t=a.resolve();t&&t.dom().toggleClass("xds-contains-fullScreenElement")})),1===e.state.get("conditionalrelease")&&e.on("xds-lo-completed",function(e){var t=e.get_arg("docnid");t&&(e.state.get("progress-".concat(t))||e.state.get("toc").fetch())})},frame:function(t){e.lang("Course Content")},percentComplete:function(e){e.displayVal=Math.round(100*(e.data||0))+"%"},loadNewItemForm:function(t){var a=i.utils.getActive(t);t.event("loadxds",{nodetype:a.data.type,command:a.data.args.command||"new",xds:a.data.args.xds,container_nid:t.nid(),target:t.dom(),func:function(i){var o=a.data.type,n={title:e.lang("Untitled"),temp:1},r=i.target.find("."+i.xdsid).xdo;if(r.state.set("toccmds",JSON.stringify([{op:"move",path:"*",dest:a.data.tocArgs.dest,where:a.data.tocArgs.where}])),o){if(r.state.set("nodesubtype",o.split(".")[1]),e.is_str(i.s.nid)&&-1!==i.s.nid.indexOf("/")){var s=i.s.nid.split("/");n.nid=s.pop(),n.rid=s.pop()}else n.nid=i.s.nid,n.rid=i.s.rid;n.id=n.nid,n.type=o}a.updateId(n.nid),t.state.top().data.activeObject=n.nid,e.extend(a.data,n)}}),t.on("posted",function(e){var t=e.get_arg("nid");"string"==typeof t&&(t=t.split("/").pop()),e.state.top().get("toc").fetch().then(function(a){for(var i=e.state.top().get("toc").getIdFromNid(t),o=$(".xds-CartridgeView-itemRow"),n=0;n<o.length;n++)if($(o[n]).xdo.get_toc().id==i)return void $(o[n]).trigger("click")})})},esubmit:function(e){var t=e.state.get("esubmit");if(void 0===t&&(t=!1),0==t)return!1;var a={};e.build.cookData(e.xds,t,a),e.displayVal=a["_"+e.xds.id]},frameCommands:function(e){var t=e.state.get("objectMode"),a=e.state.get("activeObject");2!==t&&a||e.exitBlank()},frameBody:function(t){var o,n;if(t.removeChildren(),!e.layout.isPhone()||t.arg("render")){t.arg("render")?(o=t.caller().state,n=t.caller()):(o=t.state,n=t),t.arg("inherit")&&t.inherit(t.arg("inherit"));i.utils.dimensions();e.layout.isPhone()?(t.addStyle("height","calc(var(--viewport-height) - 44px)"),t.addStyle("overflow-y","auto")):(t.addStyle("height","calc(var(--viewport-height) - 172px)"),t.addStyle("overflow-y","auto")),t.on("loadNewItemForm",i.loadNewItemForm);var r=o.get("activeObject");if(t.on("ajax_post",function(e){var t=e.state.get("toc");e.update_setting("objectMode",1),e.state.set("objectMode",1),e.state.update("objectMode");var a=t.getIdFromNid((e.get_arg("nid")+"").split("/").pop());i.clearSelection(e),e.state.top().set("activeObject",a,!0),e.get_arg("toc")?t.refresh(e.get_arg("toc")):t.fetch()}),t.on("LOCartridgeDone",function(e){e.update_setting("objectMode",1),e.state.set("objectMode",1),e.state.update("objectMode"),e.state.get("toc").fetch()}),t.on("scorm-frame-loaded",function(){function o(a,o){var n,r,s,d=$(o.srcElement||o.target),c=d.is("a")?d:!!d.parents("a").length&&d.parents("a"),l=a.__edsby_data;if(c&&c.attr("href")){var p;r=c.attr("href"),n=e.links.queryParams(r);for(var f=a.location.pathname.split("/").splice(4),g=(r=r.split("../")).length;g--;)f.pop();if(f=f.join("/")+"/"+r.join("/"),p=n.rcode?l[n.rcode]&&l[n.rcode].href:f,i.resourceMap[n.rCode||n.rcode]||p&&i.resourceMap[p])return i.activeObject=(i.resourceMap[n.rCode||n.rcode]||i.resourceMap[p]).path,t.get_xdo("*frame").update(),void t.get_xdo("*sequenceTable").update();n.rcode&&l[n.rcode]&&(s=(r=a.location.href).split("/").splice(0,6),a.location=s.join("/")+"/"+l[n.rcode].href,o.preventDefault())}}return function(t,i,n){try{var r=t.get_arg("scormWindow"),s=r.__edsby_data={};r.__edsby_manifest.organizations.map(function e(t){s[t.resource_code]=t,t.items&&t.items.map(e)}),r.addEventListener("click",function(e){o(r,e)})}catch(t){e.log.debug("CartridgeView.frameBody[scorm-frame-loaded]: exception in iframe loader")}try{for(var d=a.getElementById("scorm_win_"+t.data_full.nid).contentWindow.document.getElementsByTagName("IMG"),c=0;c<d.length;c++)e.get("sanitizer").sanitize_image_src(d[c],!0)}catch(t){e.log.debug("CartridgeView.frameBody[scorm-frame-loaded]: Exception in iframe image fixer")}e.layout.isPhone()?t.dom().css("overflow","auto"):t.dom().css("overflow-y","hidden")}}()),r){var s=i.utils.getActive(n);if(s){var d=i.utils.getSettings(s),c=o.get("objectMode"),l=1==c?d.xdsView:2!==c&&i["xdsMode"+c]?i["xdsMode"+c]:d.xdsEdit;if(1==c&&s.data.temp)i.clearSelection(t);else{var p,f,g=!0;if(d.href&&1==c&&d.nid){if(d.href&&d.href.indexOf("://")<0&&d.nid){var u=d.href.split(".");({docx:1,doc:1,xls:1,xlsx:1,pdf:1,ppt:1,pptx:1})[u[u.length-1].toLowerCase()]&&(l=i.edsbyMap[e.nt.File.Upload()].xdsView,g=!1,!0,d.cnid=d.nid)}}if(d.href&&1==c&&g)-1===(f=-1!==d.href.indexOf("://")?d.href:"/lo/get/"+e.gbl.nid+"/"+d.href).indexOf("://")&&(f=e.gbl.server+f),t.trigger("sco-unload"),i.scormFrame=t.ref(),e.platform.native?(p='<iframe id="scorm_win_'+t.data_full.nid+'" class="xds-CartridgeView-frameBody-mobileScormFrame" scrolling="yes"></iframe>',e.ajax({xdo:t,url:f}).then(function(a){var i=$("#scorm_win_"+t.data_full.nid),o=i.contents().find("html");o.html(a);var n=i[0].contentDocument.getElementsByTagName("head");0==n.length&&(n=i[0].contentDocument.createElement("head"),o[0].appendChild(n),n=i[0].contentDocument.getElementsByTagName("head"));var r=i[0].contentDocument.createElement("base");r.setAttribute("href",f),n[0].appendChild(r),t.trigger("scorm-frame-loaded");var s=function(t,a){for(var i=o.find("".concat(t,"[").concat(a,"]")),n=0;n<i.length;n++){var r=i[n].getAttribute(a);if(r){if("/"==r.charAt(0))r=e.gbl.server+r;else if(r.indexOf("http")<0){var s=f.split("/");s.pop(),s.push(r),s.unshift(e.gbl.server),r=s.join("/")}i[n].setAttribute(a,r),r.indexOf(e.gbl.server)<0&&"A"==i[n].tagName.toUpperCase()&&i[n].setAttribute("target","_blank")}}};s("script","src"),s("style","src"),s("*","href"),i.css("height","".concat(i.contents().find("html").height(),"px"))})):p='<iframe id="scorm_win_'+t.data_full.nid+'" class="xds-CartridgeView-frameBody-scormFrame" src="'+f+'"></iframe>',t.displayVal=p,t.xds.noLinks=!0,t.ready(function(e){e.dom().find("iframe").on("load",function(){e.trigger("scorm-frame-loaded")})});else if(l&&d.nid){if(s&&s.data.temp)return void t.ready(i.loadNewItemForm);if(!t.has_read(l)&&!n.has_read(l))return;t.ready(function(){var a={xds:l,nid:d.cnid,container_nid:e.gbl.nid,noPath:!0,embedded:1,target:t.dom()};e.layout.isPhone()||t.dom().css({height:"calc(var(--viewport-height) - "+(t.dom().offset().top+24)+"px)","overflow-y":"auto"}),a.timer=t.setTimeout(function(){a.target.html(e.html.loading())},500),a.func=function(){clearTimeout(a.timer)},3!=c&&4!=c||(a.nid=t.state.get("toc").nid,a.tocid=t.state.get("activeObject")),t.xdsbuild(a)})}else t.addChild({xds:{id:"noContent",type:"noContent",title:e.lang("This item has no content."),sparse:1}})}}else t.exit()}else t.exit()}else e.get("lightbox").len()?i.lbRender.resolve().update():t.state.get("activeObject")&&t.ready("lightbox",{xds:t.arg("xdsLightbox"),bindNoPerm:!0})},lightboxRender:function(t){i.lbRender=t.ref();var a={render:!0};e.layout.isPhone()&&(a.inherit="responsive.layout.body"),t.inherit("CartridgeView.frameBody",a)},setAState:function(t){var a=i.utils.getActive(t).data.nid;e.post({url:{xds:t.get_arg("xds"),nid:a,noPath:!0},data:{astate:t.arg("value")}}).then(function(){t.state.set("astate",t.arg("value"))})},showEditTab:function(t){var a=i.utils.getActive(t),o=[e.nt.Container()];if(a&&a.data.type){var n=a.data.type.split(".")[0];return!(o.includes(n)||o.includes(a.data.type))}return!(a&&a.data.href&&!a.data.type)},showAffectedState:function(t){var a=i.utils.getActive(t),o=!1,n=t.has_role("Class Owner")||t.has_role("Moderator");if(a){var r=a.data.type;if(r){var s=[e.nt.Document(),e.nt.File()],d=r.split(".");o=s.includes(d[0])||s.includes(r)}}return!n&&o},updateDocumentAState:function(e){e.target("caller").xdo.state.set("astate",e.data),e.inherit("sys")},astate:function(t){var a=e.lookup("affectedStatesLookup");a[t.data]&&(t.displayVal=a[t.data].params.emoji,t.arg("suppressTooltip")||(t.tooltip=a[t.data].params.title)),t.data||t.exitBlank()},lookup:function(e){var t=e.state.get("toc").itemByNid(e.data);t&&(e.data=t)},isCompletable:function(t){var a=[e.nt.Document.Section(),e.nt.Document.Content(),e.nt.Document.Link(),e.nt.File.Upload(),e.nt.Document.Glossary(),e.nt.Document.Unit(),e.nt.Message.LessonSummary(),e.nt.Document.Lesson(),e.nt.Document.Discussion()],i=t;if("object"===_typeof(t)){if(t.data.href)return!0;i=t.data.type}return a.includes(i)},markComplete:function(e){if("auto"==e.state.get("MarkComplete")||e.has_role("Class Owner")||e.has_role("Supporting Teacher")||e.has_role("Moderator")||!e.has_role("Class Member")&&!e.has_role("Place Member"))return!1;var t=i.utils.getActive(e);return!(!t||!t.data.nid)&&(!e.state.get("progress-"+t.data.nid)&&(!(t.data.type&&!i.isCompletable(t))&&void e.on("click",function(e){t.data.nid&&i.utils.markDocumentComplete(e),e.stopPropagation()})))},mobileMarkComplete:function(t){if("auto"==t.state.get("MarkComplete")||t.has_role("Class Owner")||t.has_role("Supporting Teacher")||t.has_role("Moderator")||!t.has_role("Class Member")&&!t.has_role("Place Member"))return!1;var a=t.caller(),o=(a.state.top().get("activeObject",t),!1);e.get_resource("CartridgeView").utils.getActive(a)&&(o=a.state.get("progress-".concat(e.get_resource("CartridgeView").utils.getActive(a).data.nid))),o&&t.exitBlank(),t.inherit("fa.icon"),t.on("click",function(e){i.utils.markDocumentComplete(t,!0,!0)})},commandTab:function(t){t.state.top().get("activeObject")||t.exitBlank();var a=i.utils.getActive(t);if(a&&!a.data.nid&&t.exitBlank(),t.arg("xds")&&(i["xdsMode"+t.arg("mode")]=t.arg("xds")),t.arg("xdsperm")&&a.data.type){var o="xdsperm-"+t.arg("xds");t.state.get(o)||(e.get("cfnp").xdsperm(t).then(function(e){var i=e[t.arg("xds")],n=a.data.type,r=n.split("."),s=!1;if(i&&(i=i.perm).nodetypes)for(var d=0;d<i.nodetypes.length&&!s;d++)n!=i.nodetypes[d]&&r[0]!=i.nodetypes[d]||(s=!0);t.state.set(o,s,!0)}),t.exitBlank()),t.state.clear(o)}t.state.get("objectMode")==t.arg("mode")&&t.addClass(t.genSubClass("selected")),t.has_handler("click")||t.on("click",function(e){e.update_setting("objectMode",e.arg("mode")),e.state.set("objectMode",e.arg("mode"))}),t.arg("icon")&&t.inherit("fa.icon")}};return i});

/* resources: ClassCrossPostPicker */

"use strict";cf.resource("ClassCrossPostPicker",function(s,n,r,t){return{filterClassList:function(n){var r=!0,t=parseInt(s.lookup("np","Classes").val());return 3.13!=n.nt()&&(r=(n.get_val("pin")&t)===t),r&&n.nid()!=s.gbl.nid}}});

/* resources: ClassJournal */

"use strict";cf.resource("ClassJournal",function(a,e,t){var r={nClasses:-1,currentIndex:0,dateMap:{length:0},reverseDateMap:{},editXds:"CourseJournalEntryLightbox"};return a.extend.fn({journalScrollToToday:function(t){var n=t.caller();n&&n.e&&"reloadJournal"==n.e.type||e.setTimeout(function(){var e=function e(t){var n=a.dateFormat(t,"yyyy-mm-dd").split("-"),s=r.reverseDateMap[n[0]],l=!1,d=!1;return s&&(l=s[parseInt(n[1],10)])&&(d=l[parseInt(n[2],10)]),d?$(".classno-"+d):!!s&&e(new Date(t.setDate(t.getDate()-1)))}(new Date);if(e){var t=e.offset();t&&$("body, html").animate({scrollTop:t.top-50})}},100)}}),a.extend.type({journalInit:function(a){return r.currentIndex=0,r.dateMap={length:0},r.reverseDateMap={},!1},journalDateMap:function(e){if(e.data&&e.data.meetings){for(var t=0;t<e.data.meetings.length;t++){var n=e.data.meetings[t];r.dateMap[t]={date:n,parsed:a.parseDate(n,!1)},t>r.dateMap.length&&(r.dateMap.length=t+1);for(var s=n.split(" ")[0].split("-"),l=0;l<s.length;l++)s[l]=parseInt(s[l],10);for(var d=r.reverseDateMap,o=0;o<2;o++)d[s[o]]||(d[s[o]]={}),d=d[s[o]];d[s[2]]||(d[s[2]]=[]),d[s[2]].push(t),t>r.nClasses-1&&(r.nClasses=t+1)}e.global("nClasses",r.dateMap.length)}return!1},journalTable:function(a){a.arg("rowType","journalTableRow").inherit("simpleTable"),a.ready(function(){0==$(".xds-ClassJournal-fakeRow").length+$(".ClassJournal-journal-row").length&&a.id(1).hide()})},journalTableRow:function(e){var t,n,s=-1,l=!1;if(e.data.date){e.addClass("truedate-"+e.data.date),l=e.data.date.split(" ")[0].split("-");for(var d=a.parseDate(e.data.date),o=r.reverseDateMap,i=0;i<l.length&&o;i++)o=o[parseInt(l[i],10)];if(o){for(var p=!1,u=0;u<o.length&&!p;u++)r.dateMap[o[u]].parsed.getTime()==d.getTime()&&(s=o[u],p=!0);p||(s=o[o.length-1]),e.data.classno=s+1,e.addClass("classno-"+s)}else{for(var g=!1,f=Math.max(s,0);f<r.dateMap.length;f++){if(r.dateMap[f].parsed.getTime()>=d.getTime()){s=f,g=!0;break}}g||(s=r.dateMap.length),g||-1==s||!0,e.data.classno=""}}e.data.date&&(t=a.parseDate(e.data.date),n=new Date,t.getFullYear()==n.getFullYear()&&t.getMonth()==n.getMonth()&&t.getDate()==n.getDate())&&e.addClass("xds-ClassJournal-isToday"),e.inherit("simpleTableRow")}}),r});

/* resources: CourseJournalEntry */

"use strict";cf.resource("CourseJournalEntry",function(e,t,i,r){return e.extend.fn({fixLegacyFields:function(e,t){if(e.siblings.topics_legacy&&e.siblings.topics_legacy.length>0){var i=$(".CourseJournalEntry-formbox-topics_legacy textarea");e.id(1).find("textarea",1).val(e.siblings.topics_legacy),i[0].value="",(i=$(".CourseJournalEntry-formbox-topics_legacy")).xdo.set_val("")}}}),{save:function(e,t,i){e.trigger("submit")}}});

/* resources: CreatePoll */

"use strict";cf.resource("CreatePoll",function(e,n,t){return{types:{f_enum:function(e,n,t){e.inherit("f_str").on("addField",function(e,n,t){e.id(1).append(void 0)})}}}});

/* resources: CrossPoster */

"use strict";cf.resource("CrossPoster",function(e,s,d){var t={_selectedNids:{},_alreadyLinkedNids:{},_resetButtons:[],fn:{reset:function(s,d,n){if(t._selectedNids={},!n)for(var a in t._selectedNids={},t._alreadyLinkedNids)t._selectedNids[a]=!0;d=s.sibling("crosspost",1),e.get_func("CrossPoster.toggleFanout")(d.xdo,d,{onLoad:!0})},clear:function(s,d,n){t._selectedNids={},t._alreadyLinkedNids={};var a=$(".CrossPoster-crosspost");if(e.get_func("CrossPoster.toggleFanout")(a.xdo,a,{onLoad:!0}),s.args.onComplete){var r=e.get_func(s.args.onComplete);r&&r(s,d,n)}}},init:function(e){t._selectedNids={},t._alreadyLinkedNids={},t._resetButtons=[]},origin:function(e){return e.data.parent&&e.data.parent.container&&(t._selectedNids[e.data.parent.container]=!0,t._alreadyLinkedNids[e.data.parent.container]=!0),!1},siblings:function(e){return e.data.container&&(t._selectedNids[e.data.container]=!0,t._alreadyLinkedNids[e.data.container]=!0),!1},toggleFanout:function(s,d,n){var a=0,r=[],i=n&&n.onLoad,o=s.parent_xdo();if(o)if(s.nid()!=e.gbl.nid||i){if(!i&&d.closest(".xds-pickers-item").hasClass("xds-selectAll"))if(d.hasClass("xds-f_checkbox-checked")){d.parent().parent().find(".current .xds-f_checkbox").addClass("xds-f_checkbox-checked");for(var c=o.data_full.class,l=0;l<c.length;l++){var f=c[l];("13"==f.nodesubtype&&"3"==f.nodetype||1024==(1024&f.pin))&&12!=f.reltype&&15!=f.reltype&&f.nid!=e.gbl.nid&&(t._selectedNids[f.nid]=!0)}}else{d.parent().parent().find(".current .xds-f_checkbox:not(.f_crosspostCheckbox-readonly)").removeClass("xds-f_checkbox-checked");var _=t._selectedNids;t._selectedNids={};for(var h=o.data_full.class,p=0;p<h.length;p++){var u=h[p];!_[u.nid]||12!=u.reltype&&15!=u.reltype||(t._selectedNids[u.nid]=!0)}for(var k in t._alreadyLinkedNids)t._alreadyLinkedNids.hasOwnProperty(k)&&k!=e.gbl.nid&&(t._selectedNids[k]=!0)}else $(".xds-selectAll .xds-f_checkbox-checked:not(.f_crosspostCheckbox-readonly)").removeClass("xds-f_checkbox-checked"),t._selectedNids[s.nid()]&&!t._alreadyLinkedNids[s.nid()]?(delete t._selectedNids[s.nid()],s.removeClass("xds-f_checkbox-checked")):(n&&!n.onLoad||!n)&&(t._selectedNids[s.nid()]=!0,s.addClass("xds-f_checkbox-checked"));for(var x in r=[],t._selectedNids)x!=e.gbl.nid&&t._selectedNids.hasOwnProperty(x)&&x!=e.gbl.nid&&(a++,r.push(x));var b=d.closest(".xdl-picker").find(".xdl-picker-display");0==b.length&&(b=d.find(".xdl-picker-display")),0==a?b.html(e.lang("Post in this class only")):1==a?b.html(e.tpl(e.lang("Also copy to <b>{{number}} other class</b>"),{number:a})):b.html(e.tpl(e.lang("Also copy to <b>{{number}} other classes</b>"),{number:a}));for(var N={},g=0;g<r.length;g++)N[r[g]]=!0;for(var v in r=[],N)N.hasOwnProperty(v)&&!isNaN(parseInt(v))&&r.push(v);d.closest(".xdl-picker").find(".xdl-picker-value").val(r.join(",")),d.find(".xdl-picker").find(".xdl-picker-value").val(r.join(","));for(var y=0;y<t._resetButtons.length;y++){var C=t._resetButtons[y].resolve();C&&(a>0?C.dom().show():C.dom().hide())}for(var m=s.parent_xdo().data_full.class||[],L=0;L<m.length;L++){var P=0;N[m[L].nid]&&(P=1),s.state.set("selection-"+m[L].nid,P)}}else s.addClass("xds-f_checkbox-checked")},checkCurrentClass:function(s,d,t){s.nid()!=e.gbl.nid||s.addClass("xds-f_checkbox-checked")},f_crosspost:function(e){var s=[];for(var d in t._selectedNids)isNaN(parseInt(d))||s.push(d);e.data=s.join(","),e.xds.dataSet=e.data,e.inherit("f_str")},f_crosspostCheckbox:function(e){e.state.get("selection-"+e.nid());t._selectedNids[e.nid()]?e.data=1:e.data=0,e.xds.readonly=t._alreadyLinkedNids[e.nid()],e.xds.readonly&&e.addClass("f_crosspostCheckbox-readonly"),e.inherit("f_checkbox")},resetButton:function(e){if("create"==e.get_setting("command"))return!1;e.inherit("button"),t._resetButtons.push(e.ref())}};return t});

/* resources: LOPreviewModelContent */

"use strict";cf.resource("LOPreviewModelContent",function(e,n,t){return{copy:function(n){var t=n.get_setting("classnid"),c=n.nid();t&&c&&e.get("cfnp").get(n,{xds:n.arg("xds"),nid:[t,c]}).then(function(){n.newEvent("lightbox.close"),n.caller().newEvent("reload")})}}});

/* resources: Like */

"use strict";cf.resource("Like",function(e,a,t){return{like:function(a){var t=a.state.get("voted")||a.get_val("like-likes-voted"),i=a.state.get("likers");a.data||(a.data={}),a.data.likes||(a.data.likes={}),a.data.likes.voted=t,i&&(a.data||(a.data={}),a.data.likers||(a.data.likers={}),a.data.likers.likersList||(a.data.likers.likersList={}),a.data.likers.likersList.liker=i),a.data&&a.data.likers&&a.data.likers.likersList&&a.data.likers.likersList.liker&&(a.state.set("votes",a.data.likers.likersList.liker.length),a.state.set("likers",a.data.likers.likersList.liker)),t?(a.attr("aria-label",a.arg("labelUnlike")),a.addSubClass("liked"),a.tooltip=a.arg("labelUnlike")):(a.attr("aria-label",a.arg("labelLike")),a.tooltip=a.arg("labelLike")),a.on("click",function(a){var t="1";a.target("*like-like").xdo.get_val("likes-voted")&&(t=""),e.post({url:{nid:a.cnid(),xds:a.arg("xds")},data:{likes:t},success:function(){a.target("*like-like").trigger("voted",{newVal:t})}})}),a.tag("a")},likers:function(e){e.data&&e.data.likersList&&e.data.likersList.liker&&e.data.likersList.liker.length>0||e.exitBlank()}}});

/* resources: Place */

"use strict";cf.resource("Place",function(e,t,d,i){return e.extend.fn({summarizeThread:function(t,d){var i=["<div>"],r=t.rnode.thread,n={title:!1},a=d.parent().parent().parent().parent();if(t.get_redirect_parent()&&(a=t.get_redirect_parent().dom().closest(".xds-feeds-feedItem")),a.hasClass("thread"))for(;a.hasClass("thread");)a=a.prev();for(i.push("<div>"),i.push("<div>"+$(a.find(".xds-name")[0]).text()+":</div>"),i.push(a.find(".feedItemBody-body").html()),i.push(a.find(".bookMarkPreview").html()),i.push("</div>"),a=a.next();a.hasClass("thread");)i.push("<div>"),i.push("<div>"+$(a.find(".xds-name")[0]).text()+":</div>"),i.push(a.find(".feedItemBody-body").html()),i.push(a.find(".bookMarkPreview").html()),i.push("</div>"),a=a.next();n.title="",i.push("</div>"),n.body=i.join(""),t.args={xds:"knowledgeBaseCreate",command:"create",nid:e.gbl.nid,data:{name:n.title,body:{rteditor:{editor:n.body}},feedthread:r,pin:16}},e.fn.lightbox(t)}}),{_threads:{},summaryHTML:function(e){return"<div>"+e.content.sender+"("+e.content.date+"): "+e.content.body+"</div>"},initModeratorList:function(e){e.siblings.moderator=[]},parseModeratorList:function(e){e.siblings.moderator.length==i&&(e.siblings.moderator=[]),e.siblings.moderator.push({name:e.data.display,nid:e.data.value,profpic:""+e.data.value}),e.inherit("sys")}}});

/* resources: PlacesBrowse */

"use strict";cf.resource("PlacesBrowse",function(e,s,t,a){return{InitData:function(s){s.state.get("BasePlaces")||(e.get("cfnp").get(s,{xds:s.arg("xdsBase"),nid:e.gbl.user.nid}).then(function(e){if(e.slices&&e.slices.length>0&&e.slices[0].data&&e.slices[0].data.placelist&&e.slices[0].data.placelist.place){var t=e.slices[0].data.placelist.place,a={};for(var l in t)a[t[l].nid]=!0;s.state.set("BasePlaces",a)}else s.state.set("BasePlaces",{})}),s.exitBlank());var t,a=e.gbl.user.schools,l=s.state.get("placesData"),i=[],n={};if(l){var r=l.item;for(t in s.state.get("filterGlobal")&&(r=e.filter(s.state.get("filterGlobal"),r)),a)if(a.hasOwnProperty(t)){var c={items:[]};$.extend(c,a[t]),i.push(c),n[a[t].nid]=c}for(t in r)r.hasOwnProperty(t)&&n[r[t].pnid]&&n[r[t].pnid].items.push(r[t]);var o=[];for(t=0;t<i.length;t++)i[t].items.length>0&&o.push(i[t]);s.map({schools:o})}}}});

/* resources: journalOutline */

"use strict";cf.resource("journalOutline",function(t,e,a){return{outlineFilter:function(e){var a,r,i=e.arg("filterTarget");if(e.data&&e.data[i]){for(var n,o=e.data[i],l=t.sort({sortBy:"date",sortType:"date",sortDirection:"reverse"},o),g=new Date,s=[],d=0;d<l.length;d++)l[d].date&&(l[d]._date=t.parseDate(l[d].date),l[d]._date.getTime()<=g.getTime()&&3!=l[d].visibilityState&&s.push(l[d]));if(s.length>0&&(n=[s.shift()]).length>0){var u=n[0]._date;for(var f in s)a=u,r=s[f]._date,a.getFullYear()==r.getFullYear()&&a.getMonth()==r.getMonth()&&a.getDate()==r.getDate()&&n.unshift(s[f])}e.data[i]=n}e.inherit("block")}}});

/* resources: placeCommands */

"use strict";cf.resource("placeCommands",function(n,e,u,r){return{fn:{GroupGetFullNID:function(e){return[n.gbl.nid,n.gbl.user.nid].join("/")},leaveShowIf:function(e){return e.get_val()&&n.get_func("placeCommands.fn.GroupGetFullNID")(e)}}}});
});
