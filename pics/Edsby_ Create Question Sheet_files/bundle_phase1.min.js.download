/**
 * Version: baf4caef7b0dd7471dd76c3dc5db25e58fe75145ce31e12f9f3da02c27b2a1fb
 * Bundle: phase1
 **/

cf.resources.confirm('bundle_phase1', function() {

/* modules: experiments */

"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}cf.module("experiments",function(e,t,n){return{types:{countdown:function(n){var i=n.state.get("countdown");if(void 0===i&&(i=n.arg("count")),n.arg("complete")&&i<=0)n.displayVal=n.arg("complete"),n.trigger("xds-countdown-complete",{countdown:n.arg("identifier")||n.name()});else{var o=n.arg("units")||e.lang("seconds");1==i&&(o=n.arg("unit")||e.lang("second")),n.displayVal=e.tpl(n.arg("template"),{count:i,units:o})}t.setTimeout(function(){i>0&&(i-=1,n.state.set("countdown",""+i))},1e3)},interstitial:function(t){t.get_setting("interstitial-activated")?t.inherit(t.arg("interstitial-finalType")):(t.on("click",function(){t.set_setting("interstitial-activated",!0),t.update()}),t.displayVal="",t.preclosetag(e.html.loading()),t.exit())},delayedRender:function(n){if(n.get_setting("delayedRender-delayComplete"))n.arg("inherit")&&n.inherit(n.arg("inherit"));else{switch(n.arg("whileDelayed")||"loading"){case"blank":n.exitBlank();break;case"icon":n.inherit("fa.icon",{icon:n.arg("delayIcon")||"fa-file-image-o"}),n.exit(),n.addStyle(n.arg("delayStyles")||{"text-align":"center","vertical-align":"middle","font-size":"64px","line-height":"94px",color:"#ADADAD"});break;default:n.displayVal="",n.preclosetag(e.html.loading()),n.exit()}var i=function(){n.set_setting("delayedRender-delayComplete",!0,!1),n.update()};if(n.arg("delayUntil")){var o="event",a=n.arg("delayUntil");"object"==_typeof(a)&&(o=a.type,a=a.trigger),"event"==o?n.on(t,a,i):"preload"==o&&function(e){var t=function(t){var n=new Image;function i(){o(),t.reject(n)}function o(){n.onload=null,n.onerror=null,n.onabort=null}n.src=e,n.onload=function(){o(),t.resolve(n)},n.onerror=i,n.onabort=i};return $.Deferred(t).promise()}(a).done(function(e){i()}).fail(function(t){e.log.debug("experiments.delayedRender: image failed to load")})}else t.setTimeout(i,n.arg("delayByMS")||1e3)}}},fn:{doDelayRender:function(e){return!e.get_setting("delayedRender-delayComplete")}}}});

/* modules: f_ttdate */

"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}cf.module("f_ttdate",function(t,e,a,d){var i;function s(t){var e=t.arg("type").split(".");1==e.length&&i[e[0]]&&t.arg("type","f_ttdate."+t.arg("type"))}for(var n in i={f_ttdate:function(){var n,r,o={allDay:!1,allowNoDate:!1,dateFormat:d,dateOnly:!1,endDate:!1,hideDate:d,hideTime:d,maxDate:d,minDate:d,noIcons:d,toTT:d,pickercommand:"node",pickerttnid:d,pickParamOnly:d,pickPeriodOnly:d,pickScheduledOnly:d,noDatePopUp:d,noTimePopUp:d,showClass:d,textNoDate:t.lang("None"),textNoneButton:d,textToday:t.lang("Today"),textTodayButton:d,timeFormat:d,timeIncr:d,timeOnly:!1,timeSecs:!1,xdspickerdata:"DatePickerData"};function p(t){return(t<10?"0":"")+t}function l(e){var a,i,s,n=e.temp.curdate,r=e.temp.ttOptions.showTime?e.temp.curtime:d,o=e.temp.vbox.val(),p=e.temp.ttOptions.timeOnly&&e.temp.ttOptions.timeSecs,l=e.temp.ttOptions.dateOnly;if((a=r&&r.length>=3?n?new Date(n[0],n[1]-1,n[2],r[0],r[1],r[2],r.length>=4?r[3]:0):r:new Date(n[0],n[1]-1,n[2],0,0,0,0))&&(a=v(e,t.dateFormat(o||a,"u"),a)),n){for(a=t.dateFormat(a,e&&!l?"u":t.lang("yyyy-mm-dd",t.settings.constants.lang.tags.dateFormat),a),(i=t.dateFormat(a,t.lang("yyyy-mm-dd HH:MM:ss",t.settings.constants.lang.tags.dateFormat)).split(" "))[0]=i[0].split("-"),s=0;s<i[0].length;s++)n[s]=i[0][s];if(r&&!l)for(i[1]=i[1].split(":"),s=0;s<i[1].length;s++)r[s]=i[1][s]}else a=p?3600*r[0]+60*r[1]+r[2]:t.dateFormat(a,"HH:MM:ss");return a}function m(e,a){var i,s,n,r,o,p,l,m={},c=a.picker,u=a.sd,f=a.cd,y=t.dateFormat(a.focusDate||f,"yyyy-mm-dd",""),x=new Date(u.getTime()),h=u.getMonth(),v=f?t.dateFormat(f,"yyyy-mm-dd",""):null,k=t.dateFormat(new Date,"yyyy-mm-dd"),D=!1,b=!1,_=g(e,f,"minDate"),F=g(e,f,"maxDate"),M=t.dateFormat.getFirstDayOfWeek(),O=t.dateFormat.getWeekdayArray(),C=e.global("ttData"),w=e.temp.ttOptions,T=!1;for(_&&(_=t.dateFormat(_,"yyyy-mm-dd")),F&&(F=t.dateFormat(F,"yyyy-mm-dd")),x.setDate(1),x.setHours(12),x.getDay()!==M&&x.setDate(x.getDate()-(7+x.getDay()-M)%7),y||(y=t.dateFormat(x,"yyyy-mm-dd","")),c[v==k?"addClass":"removeClass"]("xds-ttdate-datepicker-istoday"),c[w.pickScheduledOnly?"addClass":"removeClass"]("xds-ttdate-datepicker-schedonly"),c[w.pickPeriodOnly?"addClass":"removeClass"]("xds-ttdate-datepicker-ttonly"),c[w.pickParamOnly?"addClass":"removeClass"]("xds-ttdate-datepicker-paramonly"),c.find(".xds-ttdate-datepicker-banner-month").text(t.dateFormat(u,"mmmm yyyy")),s=0;s<6;s++)for(n=0;n<7;n++)p=t.dateFormat(x,"yyyy-mm-dd"),r="cell"+s+"-"+n,o=c.find("."+r),l=C&&C.ttDays&&C.ttDays[p],i=C&&C.scheduleDays&&C.scheduleDays[p]?C.scheduleDays[p]:d,m[r]=[p,l&&l[0].sdate||""],_&&o[p<_?"addClass":"removeClass"]("xds-ttdate-datepicker-premindate"),_&&p<_&&(s>0||s<4)&&x.getMonth()===h&&(D=!0),F&&o[p>F?"addClass":"removeClass"]("xds-ttdate-datepicker-postmaxdate"),F&&p>F&&(s>0||s<4)&&x.getMonth()===h&&(b=!0),(0===s||s>=4)&&o[x.getMonth()===h?"removeClass":"addClass"]("xds-ttdate-datepicker-celloutofmonth"),o[p===k?"addClass":"removeClass"]("xds-ttdate-datepicker-celltoday"),p===y&&(a.focus=o),o[p===v?"addClass":"removeClass"]("xds-ttdate-datepicker-cellselected"),o.find(".xds-ttdate-datepicker-celldate").text(x.getDate()),o[i?"addClass":"removeClass"]("xds-ttdate-datepicker-haveschedday"),w.noscheddays||(i&&C.daySuffix.length&&(i=i.substr(0,i.length-C.daySuffix.length)),i&&C.dayPrefix.length&&(i=i.substr(C.dayPrefix.length)),o.find(".xds-ttdate-datepicker-cellschedday").text(i!==d?i:C&&O[x.getDay()]?"--":"")),o[l?"addClass":"removeClass"]("xds-ttdate-datepicker-havett"),w.noclassdays||o.find(".xds-ttdate-datepicker-cellttday").html(l?"&#149;":""),e.temp.renderparamcb&&e.temp.renderparamcb(e,o,curdate,f,C),x.setDate(x.getDate()+1);return _&&c[D?"addClass":"removeClass"]("xds-ttdate-datepicker-minmonth"),F&&c[b?"addClass":"removeClass"]("xds-ttdate-datepicker-maxmonth"),(o=c.find(".xds-ttdate-datepicker-footer-nodate"))[!1===w.textNoDateButton?"addClass":"removeClass"]("xds-ttdate-datepicker-nonodate"),!1!==w.textNoDateButton&&(o.text(w.textNoDateButton||w.textNoDate),w.allowNoDate&&(T=!0)),(o=c.find(".xds-ttdate-datepicker-footer-today"))[!1===w.textTodayButton?"addClass":"removeClass"]("xds-ttdate-datepicker-notoday"),!1!==w.textTodayButton&&(o.text(w.textTodayButton||w.textToday||t.lang("Today")),v!=k&&(T=!0)),c[T?"addClass":"removeClass"]("xds-ttdate-showfooter"),m}function c(e,a,i){var s,n,r,o,p,l,m,c=e.temp.timepickerdata.sd,u=t.dateFormat(c,"yyyy-mm-dd"),f=t.dateFormat(c,"HH:MM:ss","",!0),y={},x=e.global("ttData"),h=g(e,c,"minDate",x),v=g(e,c,"maxDate",x);if(h&&(a.find(".xds-ttdate-timepicker-premintime").removeClass("xds-ttdate-timepicker-premintime"),t.dateFormat(h,"yyyy-mm-dd")===t.dateFormat(c,"yyyy-mm-dd")?((l=t.dateFormat(h,"HH:MM").split(":"))[0]=parseInt(l[0],10),l[1]=parseInt(l[1],10),h=t.dateFormat(h,"HH:MM:ss","",!0)):h=d,l)){for(r=0;r<=l[0];r++)for(r<l[0]&&a.find(".xds-ttdate-timepicker-hour.cl-"+Math.floor(r/12)+".hr-"+r%12).addClass("xds-ttdate-timepicker-premintime"),o=0;o<(r===l[0]?l[1]:60);o+=15)a.find(".xds-ttdate-timepicker-minute.cl-"+Math.floor(r/12)+".hr-"+r%12+".mn-"+o).addClass("xds-ttdate-timepicker-premintime");!0===e.temp.ttOptions.allDay&&a.find(".b-0").addClass("xds-ttdate-timepicker-premintime")}if(v&&(a.find(".xds-ttdate-timepicker-postmaxtime").removeClass("xds-ttdate-timepicker-postmaxtime"),t.dateFormat(v,"yyyy-mm-dd")===t.dateFormat(c,"yyyy-mm-dd")?((p=t.dateFormat(v,"HH:MM").split(":"))[0]=parseInt(p[0],10),p[1]=parseInt(p[1],10),v=t.dateFormat(v,"HH:MM:ss","",!0)):v=d,p)){for(r=p[0];r<24;r++)for(a.find(".xds-ttdate-timepicker-hour.cl-"+Math.floor(r/12)+".hr-"+r%12).addClass("xds-ttdate-timepicker-postmaxtime"),o=r===p[0]?p[1]:0;o<60;o+=15)a.find(".xds-ttdate-timepicker-minute.cl-"+Math.floor(r/12)+".hr-"+r%12+".mn-"+o).addClass("xds-ttdate-timepicker-postmaxtime");!0===e.temp.ttOptions.allDay&&a.find(".b-1").addClass("xds-ttdate-timepicker-postmaxtime")}return m=e.temp.ttOptions.noTT||e.temp.ttOptions.hideDate||e.temp.ttOptions.timeOnly,a.find(".xds-ttdate-timepicker-selectedrow").removeClass("xds-ttdate-timepicker-selectedrow"),a.find(".xds-ttdate-timepicker-selectedminute").removeClass("xds-ttdate-timepicker-selectedminute"),a.find(".xds-ttdate-timepicker-title").text(t.dateFormat(c,i)),(s=a.find(".xds-ttdate-timepicker-row.cl-"+t.dateFormat(c,"p")+".hr-"+t.dateFormat(c,"h")%12)).addClass("xds-ttdate-timepicker-selectedrow"),parseInt(t.dateFormat(c,"M"),10)%15==0&&((n=s.find(".mn-"+t.dateFormat(c,"M"))).addClass("xds-ttdate-timepicker-selectedminute"),e.temp.timepickerdata.focus||(e.temp.timepickerdata.focus=n)),!m&&x&&x.ttDays&&x.ttDays[u]&&0!==x.ttDays[u].length?(a.removeClass("xds-ttdate-timepicker-noschedule"),a.find(".xds-ttdate-timepicker-col.cl-2.col-data").html(function(e,a,d,i){var s,n,r,o="",p=e.global("ttData"),l=p&&p.ttDays[a],m=g(e,e.temp.timepickerdata.sd,"minDate"),c=g(e,e.temp.timepickerdata.sd,"maxDate"),u=e.temp.ttOptions.timeFormatInput;for(n=0;n<l.length;n++)s=t.dateFormat(e.temp.ttOptions.endDate?p.ttDays[a][n].edate:p.ttDays[a][n].sdate,"obj"),r=["xds-ttdate-classpicker class-"+n],(d>=l[n].stime&&d<l[n].etime||e.temp.ttOptions.endDate&&d==l[n].etime)&&r.push("active"),i["class-"+n]=t.dateFormat(s,"HH:MM:ss"),m&&s<m&&r.push("pre-min"),c&&s>c&&r.push("post-max"),o+='<a tabindex="0" class="'+r.join(" ")+'">'+(s?'<span class="xds-f_ttdate-class-stime">'+t.dateFormat(s,u):"")+"</span>"+(p.ttDays[a][n].period?'<span class="xds-f_ttdate-class-period">'+p.ttDays[a][n].period+":</span>":"")+'<span class="xds-f_ttdate-class-name">'+p.ttDays[a][n].name+"</span></a>";return o}(e,u,f,y))):a.addClass("xds-ttdate-timepicker-noschedule"),y}function u(t,e){var a;if(t===d)t=e;else if(t.length>0){for(a=0;a<t.length&&e.charAt(a)===t.charAt(a);a++);a<t.length&&(t=t.substr(0,a))}return t}function f(e,a,i){var s,n,r,o,p,l=d,m=e.global("ttData");if(i.scheduleDays)for(s in i.scheduleDays)o=i.scheduleDays[s].name,m.scheduleDays[i.scheduleDays[s].date]=o,o&&o.length&&(m.dayPrefix=u(m.dayPrefix,o),m.daySuffix=u(m.daySuffix,o.split("").reverse().join("")));if(i.ttDays)for(s in i.ttDays)(n=i.ttDays[s].date.split(/[\sT]/))[0]=t.dateFormat(i.ttDays[s].date,"yyyy-mm-dd"),i.ttDays[s].end?(r=i.ttDays[s].end.split(/[\sT]/))[0]=t.dateFormat(i.ttDays[s].end,"yyyy-mm-dd"):r=d,n[0]!==l&&(m.ttDays[n[0]]=[],l=n[0]),(p=$.extend(!0,{},i.ttDays[s])).date=l,p.stime=n[1],p.etime=r?r[1]:d,p.sdate=i.ttDays[s].date,p.edate=i.ttDays[s].end?i.ttDays[s].end:d,m.ttDays[l].push(p);e.global("ttDataReqs")[a]=!0}function y(e,a,d,i){var s=a.getFullYear()+p(a.getMonth()+1),n=e.temp.ttOptions;e.global("ttDataReqs")[s]||!n.pickerttnid||isNaN(parseInt(n.pickerttnid,10))?d&&d(e,i):t.get_func("get_data")({command:n.pickercommand,nid:n.pickerttnid,xds:n.xdspickerdata,targetDate:s+p(a.getDate())},function(t){f(e,s,t),d&&d(e,i)})}function x(e,a,d,i){var s=e&&t.isSameDate(e),n=t.dateFormat(e,a,i);return s&&!1!==d&&("append"===(d=d.split(":"))[0]?(d=d.slice(1)).push(n):"prepend"===d[0]&&(d[0]=n),n=d.join(" ")),n}function h(e,a,d){var i,s,n=t.dateFormat(e,"yyyy-mm-dd"),r=t.dateFormat(e,"HH:MM:ss","",!0);if(i=a&&a.ttDays[n])for(s=0;s<i.length;s++)if(i[s].stime&&!(r<i[s].stime)&&(i[s].etime<i[s].etime||r<i[s].etime||d&&r==i[s].etime))return i[s];return null}function g(e,a,i,s){var n,r,o,p,l;if("minDate"===i?i=e.temp.ttOptions.minDate:"maxDate"===i&&(i=e.temp.ttOptions.maxDate),"now"===i)return new Date;if("string"!=typeof i);else if("periodStart"===i.substr(0,11)||"periodEnd"===i)p=!("periodEnd"===i),(l=i.split("+").slice(1)).length?(l=parseInt(l[0],10),l=isNaN(l)?0:6e4*l):(l=i.split("-").slice(1)).length?(l=parseInt(l[0],10),l=isNaN(l)?0:-6e4*l):l=0,s||(s=e.global("ttData")),n=h(a,s),"object"===_typeof(a)&&(a=t.dateFormat(a,"yyyy-mm-dd HH:MM:ss")),(i=n?a.split(" ")[0]+" "+n[p?"sdate":"edate"]:d)&&l&&(i=new Date(t.dateFormat(i,"obj").valueOf()+l));else if("field:"===i.substr(0,6)||"target:"===i.substr(0,7)){if("field:"===i.substr(0,6))for((i=i.substr(6).split(":")).reverse(),o=e;r=i.pop();)"parent"===r?(r=i.pop(),o=o.parents(r)):o=o.find(r);else o=e.get_target(i.substr(7));o.xdo?""===(i=o.xdo.val())&&(i=o.xdo.get_val()):i=d}else"value:"===i.substr(0,6)?i=(i=i.substr(6).split(":")).length>1?e.get_val(i.slice(1).join(":"),i[0]):e.get_val(i[0]):"state:"===i.substr(0,6)&&(i=(i=i.substr(6).split(":")).length>1?e.state.scope(i.slice(1).join(":")).get(i[0]):e.state.get(i[0]));return i=i?t.dateFormat(i,"obj"):d}function v(t,e,a){var d=g(t,e,"minDate"),i=g(t,e,"maxDate");return d&&(isNaN(a)||a<d)&&(a=new Date(d.valueOf())),i&&(isNaN(a)||a>=i)&&(a=new Date(i.valueOf()-1)),a}function k(t,e,a){var d=h(t,e,a);return d&&(d.period||d.name)||"--"}function D(e,a){var d,i,s,n=e.global("ttData");a.bSnapToPeriod&&((d=h(s=t.dateFormat(a.tgtDate,"iso"),n))?(d.sdate&&Dt(e,t.dateFormat(s,"yyyy-mm-dd")+"T"+d.sdate),i=d.period||d.name||"--"):i="--"),a.value&&(i=i||k(a.value,n,e.temp.ttOptions.endDate),e.find(".xds-ttdate-class").val(i)),e.temp.init_tt_loaded||(e.temp.init_tt_loaded=!0,e.trigger("xds-init-tt-loaded"))}function b(e,a){var d=t.dateFormat(a||new Date,"obj");a&&!0!==a||(a=e.data),y(e,d,D,{bSnapToPeriod:!0===a,tgtDate:d,value:a})}function _(t,e){var a=this,d=a.temp.ttOptions;a.temp.ready||w(a),t!==d.pickerttnid&&(a.temp.ttpickerdata&&delete a.temp.ttpickerdata,a.global("ttData",{scheduleDays:{},ttDays:{}}),a.global("ttDataReqs",{}),a.temp.curclass=null,d.pickerttnid=t,(d.showClass||"periodStart"===d.minDate||"periodEnd"===d.minDate||"periodStart"===d.maxDate||"periodEnd"===d.maxDate||e)&&b(a,e))}function F(t){t.temp.active_picker_data&&C(t,t.temp.active_picker_data)}function M(t,a){var d,i,s,n,r,o;a.open=a.opening,a.opening&&((d=a.picker).removeClass("position-bottom"),d.show(),null!==(i=d.offset())&&(n=$(e),s=d.outerHeight(),o=i.top-n.scrollTop(),(r=n.height()-(o+s))<0&&o-a.box.outerHeight()-s-37>r&&d.addClass("position-bottom")),a.icon.addClass("xds-ttdate-picker-active"),a.focus&&a.focus.focus())}function O(e,a){e.temp.active_picker_data&&C(e,e.temp.active_picker_data),t.window.trigger("xds-refocus-picker"),e.temp.active_picker_data=a,a.opening=1,a.input[0].attr("readonly",!0),a.fillFunc(e,a,M)}function C(t,e,a){e.opening=0,e.open>=0&&(e.open=0),delete e.focus,delete t.temp.active_picker_data,e.picker.hide(),e.icon.removeClass("xds-ttdate-picker-active"),e.input[0].attr("readonly",!1),a&&e.input[0].focus()}function w(t){var e=t.temp.ttOptions;t.temp.ready||(t.temp.vbox=$(t.id(0)+"__f__"),t.temp.vbox.length&&(t.temp.datepickerdata={box:t.find(".xds-ttdate-datebox"),input:[t.find(".xds-ttdate-date")],form:t.parents(".xds-form"),picker:t.find(".xds-ttdate-datepicker"),icon:t.find(".xds-ttdate-date-iconbox"),noPopUp:e.noDatePopUp,open:0,map:{},sd:null,cd:null,fillFunc:E,validateInputFunc:B,navKeyHandler:z},t.temp.timepickerdata={box:t.find(".xds-ttdate-timebox"),input:[t.find(".xds-ttdate-time")],form:t.parents(".xds-form"),picker:t.find(".xds-ttdate-timepicker"),icon:t.find(".xds-ttdate-time-iconbox"),noPopUp:e.noTimePopUp,open:0,map:{},sd:null,fillFunc:it,validateInputFunc:ut,navKeyHandler:mt,events:{mousedown:ct}},e.showClass&&t.temp.timepickerdata.input.push(t.find(".xds-ttdate-class")),L(t,"datepickerdata"),e.noDatePopUp||(q(t.temp.datepickerdata.picker,".xds-ttdate-datepicker-cal",function(t){t.stopPropagation()}),q(t.temp.datepickerdata.picker,".xds-ttdate-datepicker-banner-prevyear",function(t){G(t,-12)}),q(t.temp.datepickerdata.picker,".xds-ttdate-datepicker-banner-prevmonth",function(t){G(t,-1)}),q(t.temp.datepickerdata.picker,".xds-ttdate-datepicker-banner-nextmonth",function(t){G(t,1)}),q(t.temp.datepickerdata.picker,".xds-ttdate-datepicker-banner-nextyear",function(t){G(t,12)}),q(t.temp.datepickerdata.picker,".xds-ttdate-datepicker-cell",Q),q(t.temp.datepickerdata.picker,".xds-ttdate-datepicker-footer-today",tt),q(t.temp.datepickerdata.picker,".xds-ttdate-datepicker-footer-nodate",et)),L(t,"timepickerdata"),e.noTimePopUp||(q(t.temp.timepickerdata.picker,".xds-ttdate-timepicker-picker",function(t){t.stopPropagation()}),q(t.temp.timepickerdata.picker,".xds-ttdate-timepicker-hour",xt),q(t.temp.timepickerdata.picker,".xds-ttdate-timepicker-minute",xt),q(t.temp.timepickerdata.picker,".xds-ttdate-timepicker-daybound",xt)),e.timeIncr&&(q(t.temp.timepickerdata.box,".xds-ttdate-time-incr-up",function(t){yt(t,1)}),q(t.temp.timepickerdata.box,".xds-ttdate-time-incr-dn",function(t){yt(t,-1)})),e.showClass&&b(t),t.picker={close:gt},t.temp.ready=!0))}function T(t){var e={h:0,v:0};switch(t.keyCode){case 37:e.h=-1;break;case 38:e.v=-1;break;case 39:e.h=1;break;case 40:e.v=1;break;case 33:e.h=1,e.v=-1;break;case 34:e.h=1,e.v=1;break;case 36:e.h=-1,e.v=-1;break;case 35:e.h=-1,e.v=1}return e}function I(t){var e=$(t.currentTarget),a=$(e.parents(".xds-f_ttdate-f_ttdate")).xdo,d=e[0]._pickerType;a&&(t.stopPropagation(),t.stopImmediatePropagation(),t.preventDefault(),a.temp[d].validateInputFunc(a))}function P(t){var e=$(t.currentTarget),a=$(e.parents(".xds-f_ttdate-f_ttdate")).xdo,d=e[0]._pickerType;a&&(a.temp[d].open&&C(a,a.temp[d]),e.trigger("xds-activate"))}function H(t){var e=$(t.currentTarget);$(e.parents(".xds-f_ttdate-f_ttdate")).xdo,e[0]._pickerType;t.stopPropagation()}function N(t){var e=$(t.currentTarget);$(e.parents(".xds-f_ttdate-f_ttdate")).xdo.trigger("xds-activate")}function S(t){var e=$(t.currentTarget),a=$(e.parents(".xds-f_ttdate-f_ttdate")).xdo,d=e[0]._pickerType;a&&a.temp[d].open&&27===t.keyCode&&(C(a,a.temp[d]),t.stopPropagation(),t.stopImmediatePropagation(),t.preventDefault())}function U(t){var e=$(t.currentTarget),a=$(e.parents(".xds-f_ttdate-f_ttdate")).xdo,d=e[0]._pickerType;if(a){if(t.isDefaultPrevented())return;10===t.keyCode||13===t.keyCode?(a.temp[d].open?C(a,a.temp[d]):O(a,a.temp[d]),t.stopPropagation(),t.preventDefault()):9===t.keyCode?a.temp[d].open&&C(a,a.temp[d]):27===t.keyCode?t.stopPropagation():40===t.keyCode&&(a.temp[d].open||(O(a,a.temp[d]),t.preventDefault()))}}function j(t){var e=$(t.currentTarget),a=$(e.parents(".xds-f_ttdate-f_ttdate")).xdo,d=e[0]._pickerType;t.stopPropagation(),t.stopImmediatePropagation(),t.preventDefault(),a&&(a.temp[d].open?C(a,a.temp[d]):O(a,a.temp[d])),a.trigger("xds-activate")}function L(t,e){var a,d,i=t.temp[e];for(d=0;d<i.input.length;d++)i.input[d]&&i.input[d].length&&(i.input[d][0]._pickerType=e,i.input[d].bind({change:I}),i.noPopUp||(a={mousedown:P,mouseup:H,focus:N,keyup:S,keydown:U},i.events&&(a=$.extend(!1,a,i.events)),i.input[d].bind(a)));!i.noPopUp&&i.icon&&i.icon.length&&(i.icon[0]._pickerType=e,i.icon.bind({click:j}))}function K(t,e){e.pickerData.map=m(t,e.pickerData),e.fillcb&&e.fillcb(t,e.pickerData)}function E(e,a,d){a.cd=t.dateFormat(e.temp.curdate.join("-"),"obj",null),a.sd=new Date,a.cd&&a.sd.setTime(a.cd.getTime()),y(e,a.sd,K,{pickerData:a,fillcb:d})}function B(e){var a,i,s=e.temp.ttOptions.dateFormatInput,n=s.indexOf("d")<s.indexOf("m"),r=t.sanityCheckDateParams(e.temp.datepickerdata.input[0].val().trim().split(/[\-\/\s]/),n),o=e.temp.vbox.val();r?(e.temp.curdate=r,a=l(e)):e.temp.ttOptions.allowNoDate&&(a="",e.temp.timepickerdata.input[0].val("")),a!==d&&a!==o&&(i={value:a,previous:o},e.temp.vbox.val(a),e.temp.vbox.trigger("changeDate",i),e.temp.vbox.trigger("change",i)),e.temp.datepickerdata.input[0][t.isSameDate(e.temp.vbox.val())?"addClass":"removeClass"]("xds-f_ttdate-date-today"),e.temp.datepickerdata.input[0].val(x(e.temp.vbox.val(),e.temp.ttOptions.dateFormatInput,e.temp.ttOptions.textToday,!!e.temp.ttOptions.allowNoDate&&e.temp.ttOptions.textNoDate))}function V(t){t.stopPropagation(),t.preventDefault()}function Y(t){var e=t.currentTarget,a=$(e),d=$(a.parents(".xds-f_ttdate-f_ttdate")).xdo;10===t.keyCode||13===t.keyCode?(t.stopPropagation(),t.preventDefault(),a.trigger("click")):27===t.keyCode?(t.stopPropagation(),t.preventDefault(),C(d,d.temp.active_picker_data,!0)):-1!==[9,33,34,35,36,37,38,39,40].indexOf(t.keyCode)&&d.temp.active_picker_data.navKeyHandler(d.temp.active_picker_data,t)}function q(t,e,a){t.find(e).bind({click:a,mousedown:V,keydown:Y})}r=function(){var e,a,d="";for(d+='<div class="xds-ttdate-datepicker-cal"><div class="xds-ttdate-datepicker-banner"><a tabindex="0" class="xds-ttdate-datepicker-banner-prevyear" title="'+t.lang("Previous Year")+'"><div class="e_fa far fa-angle-double-left"></div></a><a tabindex="0" class="xds-ttdate-datepicker-banner-prevmonth" title="'+t.lang("Previous Month")+'"><div class="e_fa far fa-angle-left"></div></a><div class="xds-ttdate-datepicker-banner-month"></div><a tabindex="0" class="xds-ttdate-datepicker-banner-nextmonth" title="'+t.lang("Next Month")+'"><div class="e_fa far fa-angle-right"></div></a><a tabindex="0" class="xds-ttdate-datepicker-banner-nextyear" title="'+t.lang("Next Year")+'"><div class="e_fa far fa-angle-double-right"></div></a></div><div class="xds-ttdate-datepicker-banner-weekdays">',a=0;a<7;a++)d+='<div class="xds-ttdate-datepicker-banner-weekday-'+a+'">'+t.dateFormat.getWeekdays(!0)[(a+t.dateFormat.getFirstDayOfWeek())%7]+"</div>";for(d+="</div>",e=0;e<6;e++){for(d+='<div class="xds-ttdate-datepicker-week week'+e+'">',a=0;a<7;a++)d+='<a tabindex="0" class="xds-ttdate-datepicker-cell cell'+e+"-"+a+'"><div class="xds-ttdate-datepicker-cellschedday"></div><div class="xds-ttdate-datepicker-celldate"></div><div class="xds-ttdate-datepicker-cellttday"></div></a>';d+="</div>"}return d+='<div class="xds-ttdate-datepicker-footer"><a tabindex="0" class="xds-button xds-ttdate-datepicker-footer-nodate"></a><a tabindex="0" class="xds-button xds-ttdate-datepicker-footer-today"></a></div></div>'}();var A=["xds-ttdate-datepicker-banner-prevyear","xds-ttdate-datepicker-banner-prevmonth","xds-ttdate-datepicker-banner-nextmonth","xds-ttdate-datepicker-banner-nextyear"],R=["xds-ttdate-datepicker-footer-nodate","xds-ttdate-datepicker-footer-today"];function W(t){var e,a,d,i,s={};for(e=t.attr("class").split(/\s+/),d=0;d<e.length;d++){if("cell"===e[d].substr(0,4)){a=e[d].substr(4).split("-"),s.week=parseInt(a[0],10),s.day=parseInt(a[1],10);break}if(-1!==(i=A.indexOf(e[d]))){s.week=-1,s.day=i;break}if(-1!==(i=R.indexOf(e[d]))){s.week=6,s.day=i;break}}return s}function z(t,e){var a,d,i,s,n,r=$(e.currentTarget),o=r.parents(".xds-ttdate-datepicker-cal"),p=o.parents(".xds-ttdate-datepicker-minmonth").length?2:0,l=o.parents(".xds-ttdate-datepicker-maxmonth").length?1:3,m=o.parents(".xds-ttdate-datepicker.allownodate").length?0:1,c=o.parents(".xds-ttdate-datepicker.xds-ttdate-datepicker-istoday").length?0:1,u=o.find(".xds-ttdate-datepicker-premindate"),f=o.find(".xds-ttdate-datepicker-postmaxdate"),y=0,x=0;if(u.length&&(y=(i=W(u.last())).week,(x=i.day+1)>6&&(x=0,y+=1)),f.length&&(y=(i=W(f.first())).week,(x=i.day-1)<0&&(x=6,y-=1)),l<p&&(p=l=-1),(c<m||0===o.parents(".xds-ttdate-showfooter").length)&&(m=c=-1),a=(i=W(r)).week,d=i.day,9===e.keyCode)if(e.shiftKey&&(-1===a&&d===p||-1===p&&a===y&&d===x))c>=0?(a=6,d=c):(a=5,d=6);else if(e.shiftKey&&a===y&&d===x)a=-1,d=l;else if(e.shiftKey&&6===a&&d===m)a=5,d=6;else if(!e.shiftKey&&(6===a&&d===c||-1===m&&5===a&&6===d))p>=0?(a=-1,d=p):(a=y,d=x);else if(e.shiftKey||5!==a||6!==d){if(e.shiftKey||-1!==a||d!==l)return;a=y,d=x}else a=6,d=m;else{if((s=T(e)).h===s.v&&0===s.h)return;-1===a?s.v>0?(a=y,d=Math.max(2*d,x),d=Math.min(6,Math.max(x,d+s.h))):d=Math.min(l,Math.max(p,d+s.h)):6===a?s.v<0?(a=5,d=Math.min(3*d,6),d=Math.min(6,Math.max(5===y?x:0,d+s.h))):d=Math.min(c,Math.max(m,d+s.h)):a===y&&s.v<=0?s.v<0&&-1!==l?(a=-1,d=Math.min(l,Math.max(p,Math.floor(d/2))),d=Math.min(l,Math.max(p,d+s.h))):d=Math.min(6,Math.max(x,d+s.h)):5===a&&s.v>=0?s.v>0&&-1!==m?(a=6,d=Math.min(c,Math.max(m,Math.floor(d/3))),d=Math.min(c,Math.max(m,d+s.h))):d=Math.min(6,Math.max(5===y?x:0,d+s.h)):(a+=s.v,d=Math.min(6,Math.max(a===y?x:0,d+s.h)))}return n=-1===a?"."+A[d]:6===a?"."+R[d]:".cell"+a+"-"+d,t.focus=o.find(n),t.focus.focus(),e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault(),!1}function Z(t){t.temp.datepickerdata.map=m(t,t.temp.datepickerdata)}function G(t,e){var a=$($(t.currentTarget).parents(".xds-f_ttdate-f_ttdate")).xdo,d=a.temp.datepickerdata,i=d.sd.getDate(),s=d.sd.getMonth()+e,n=d.sd.getFullYear(),r=new Date(d.sd.valueOf());a.temp.ttOptions.minDate,a.temp.ttOptions.maxDate;switch((s<0||s>11)&&(n+=Math.floor(s/12),(s%=12)<0&&(s+=12)),s){case 1:i<29||(i=n%4!=0||n%400!=0&&n%100==0?28:29);break;case 3:case 5:case 8:case 10:31===i&&(i=30)}i&&r.setDate(i),r.setMonth(s),n&&r.setFullYear(n),r=v(a,d.cd,r),d.sd=r,y(a,d.sd,Z),t.stopImmediatePropagation()}function J(e,a){var i,s=e.temp.ttOptions,n=e.temp.datepickerdata,r=e.temp.timepickerdata;n.input[0].val(a[0]),(i=a[1].split(" ")[1])===d&&(i=""),""!==i||""!==r.input[0].val()||s.dateOnly||(i=t.dateFormat(a[0],"obj"),i=t.dateFormat(i,"HH:MM:ss",d,!0)),""!==i&&r.input[0].val(t.dateFormat(a[0]+" "+i,"HH:MM:ss")),n.input[0].trigger("change"),""!==i&&r.input[0].trigger("change")}function Q(t){var e=t.currentTarget,a=$(e),d=$(a.parents(".xds-f_ttdate-f_ttdate")).xdo,i=d.temp.ttOptions,s=d.temp.datepickerdata;if(i.pickScheduledOnly&&!a.hasClass("xds-ttdate-datepicker-haveschedday")||i.pickPeriodOnly&&!a.hasClass("xds-ttdate-datepicker-havett")||i.pickParamOnly&&!a.hasClass("xds-ttdate-selectable"))return!1;!e.classList&&e.className&&(e.classList=e.className.split(" ")),C(d,s,!0),J(d,s.map[e.classList[1]])}function X(e){var a,d,i=t.dateFormat(new Date,"yyyy-mm-dd");for(d in a=e.temp.datepickerdata.map=m(e,e.temp.datepickerdata))if(a[d][0]===i)return void J(e,a[d])}function tt(t){var e=$($(t.currentTarget).parents(".xds-f_ttdate-f_ttdate")).xdo,a=e.temp.datepickerdata;C(e,a,!0),a.sd=new Date,y(e,a.sd,X)}function et(t){var e=$($(t.currentTarget).parents(".xds-f_ttdate-f_ttdate")).xdo,a=e.temp.datepickerdata,d=e.temp.timepickerdata;C(e,a,!0),a.input[0].val(""),a.input[0].trigger("change"),d.input[0].trigger("change"),e.temp.ttOptions.showClass&&e.find(".xds-ttdate-class").val(""),t.stopPropagation(),t.stopImmediatePropagation()}function at(t,e,a){e.map=c(t,e.picker,e.sd,t.temp.ttOptions.timeFormatInput),q(e.picker,".xds-ttdate-classpicker",ht),a&&a(t,e)}function dt(t,e){at(t,e.pickerData,e.fillcb)}function it(e,a,d){var i;e.temp.ttOptions.timeOnly&&e.temp.ttOptions.timeSecs?(i=new Date(1970,1,1,0,0,0),a.sd=new Date(i.valueOf()+1e3*(e.temp.vbox.val()||0))):a.sd=t.dateFormat(e.temp.vbox.val(),"obj",null),a.sd=a.sd||new Date,e.temp.ttOptions.timeOnly?at(e,a,d):y(e,a.sd,dt,{pickerData:a,fillcb:d})}function st(t){var e,a,d={},i=t.attr("class").split(/\s+/);for(a=0;a<i.length;a++)2===(e=i[a].split("-")).length&&("b"===e[0]?(d.boundary=parseInt(e[1],10),0===d.boundary?d.hour=d.minute=d.second=0:(d.hour=23,d.minute=d.second=59),d.all_day_change=!0):"cl"===e[0]?(d.col=parseInt(e[1],10),d.col&&(d.hour=(d.hour||0)+12,d.all_day_change=!1)):"hr"===e[0]?(d.hour12=parseInt(e[1],10),d.hour=(d.hour||0)+d.hour12,d.all_day_change=!1):"mn"===e[0]?(d.minute=parseInt(e[1],10),d.all_day_change=!1):"sc"===e[0]?(d.second=parseInt(e[1],10),d.all_day_change=!1):"class"===e[0]&&(d.classndx=parseInt(e[1],10)));return d}function nt(t,e,a,d){e&&(delete t.hour,delete t.hour12,delete t.minute,delete t.second,delete t.col),a&&delete t.boundary,d&&delete t.classndx}function rt(t,e,a,d){nt(t,!1,!0,!0),t.col=e,t.hour12=a,t.hour=12*t.col+t.hour12,t.minute=d}function ot(t,e){nt(t,!0,!1,!0),t.boundary=e}function pt(t,e){nt(t,!0,!0,!1),t.classndx=e}function lt(t,e,a,d){return t.col===e&&t.hour12===a&&t.minute===d}function mt(t,e){var a,i,s,n,r,o,p,l,m,c,u,f,y,x,h,g,v,k=T(e);if(9===e.keyCode||k.h||k.v){if((v=(i=(a=$(e.currentTarget)).parents(".xds-ttdate-timepicker-picker")).find(".xds-ttdate-timepicker-premintime")).length?((v=st(v.last())).minute+=15,v.hour12+=Math.floor(v.minute/60),s=Math.floor(v.hour12/12),n=v.hour12%12,r=v.minute%60):(s=0,n=0,r=0),(v=i.find(".xds-ttdate-timepicker-postmaxtime")).length?((v=st(v.first())).minute-=15,v.hour12+=Math.floor(v.minute/60),o=Math.floor(v.hour12/12),p=v.hour12%60,l=(v.minute+60)%60):(o=1,p=11,l=45),m=a.parents(".xds-f_ttdate-allday-sdate").length?1:0,c=a.parents(".xds-f_ttdate-allday-edate").length?1:0,(v=i.find(".xds-ttdate-classpicker")).length?(u=i.find(".xds-ttdate-classpicker.pre-min").length,f=v.length-i.find(".xds-ttdate-classpicker.post-max").length-1,(u>v.length||f<0)&&(u=f=-1)):u=f=-1,h=lt(y=st(a),s,n,r),x=lt(y,o,p,l),9===e.keyCode)if(e.shiftKey&&(0===y.boundary||h||y.classndx===u))m&&h?ot(y,0):f>=0&&(0===y.boundary||h)?pt(y,f):c?ot(y,1):rt(y,o,p,loastminute);else if(e.shiftKey||0!==y.boundary)if(e.shiftKey&&1===y.boundary)rt(y,o,p,l);else if(e.shiftKey||45!==y.minute||x)if(e.shiftKey&&0===y.minute&&!h)v=y.hour-1,rt(y,Math.floor(v/12),v%12,45);else{if(e.shiftKey||!x&&1!==y.boundary&&y.classndx!==f)return;c&&x?ot(y,1):u>=0&&(1===y.boundary||x)?pt(y,u):m?ot(y,0):rt(y,s,n,r)}else v=y.hour+1,rt(y,Math.floor(v/12),v%12,0);else rt(y,s,n,r);else for(;k.h||k.v;)y.classndx!==d?k.h<0?(0===y.classndx&&m?ot(y,0):y.classndx>=11+m&&c?ot(y,1):rt(y,o,v=Math.min(p,y.classndx-m),v===p?l:45),k.h=0):(y.classndx=Math.min(f,Math.max(u,y.classndx+k.v)),k.h=k.v=0):(y.col===o&&(y.hour12===p&&y.minute===l||45===y.minute)||y.boundary!==d)&&k.h>0?(u>=0&&(1===y.boundary?y.classndx=f:0===y.boundary?y.classndx=u:y.classndx=Math.min(f,Math.max(u,y.hour12+m)),pt(y,y.classndx)),k.h=0):0===y.boundary?k.v>0?(rt(y,s,n,r),k.v=0):k.h=k.v=0:1===y.boundary?k.v<0?(rt(y,o,p,l),k.v=0):k.h=k.v=0:k.v<0&&m&&(y.col===s&&y.hour12===n||y.col!==d&&0===y.hour12)?(ot(y,0),k.v=0):k.v>0&&c&&(y.col===o&&y.hour12===p||y.col!==d&&11===y.hour12)?(ot(y,1),k.v=0):k.v&&y.hour12!==d&&y.minute!==d?(y.hour12=Math.min(y.col===o?p:11,Math.max(y.col===s?n:0,y.hour12+k.v)),y.hour=12*y.col+y.hour12,y.col===o&&y.hour12===p?(v=y.minute,y.minute=Math.min(l,y.minute),k.h<0&&y.minute<v&&(k.h=0)):y.col===s&&y.hour12===n&&(y.minute=Math.max(r,y.minute),k.h>0&&y.minute>v&&(k.h=0)),k.v=0):k.h<0&&1===y.col&&0===y.minute?(s<y.col&&(y.col=0,y.hour12=Math.max(y.hour12,n),y.minute=45),k.h=0):k.h>0&&0===y.col&&45===y.minute?(o>y.col&&(y.col=1,y.hour12=Math.min(y.hour12,p),y.minute=0),k.h=0):k.h&&y.minute!==d&&y.col!==d&&y.hour12!==d?(y.minute=Math.min(y.col===o&&y.hour12===p?l:45,Math.max(y.col===s&&y.hour12===n?r:0,y.minute+15*k.h)),k.h=0):k.h=k.v=0;(g=i.find(".xds-ttdate-focushour"))&&g.removeClass("xds-ttdate-focushour"),y.boundary!==d?a=i.find(".b-"+y.boundary):y.classndx!==d?a=i.find(".class-"+y.classndx):(i.find(".xds-ttdate-timepicker-row.cl-"+y.col+".hr-"+y.hour12).addClass("xds-ttdate-focushour"),a=i.find(".cl-"+y.col+".hr-"+y.hour12+".mn-"+y.minute)),t.focus=a,t.focus.focus(),e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault()}}function ct(t){$($(t.currentTarget).parents(".xds-f_ttdate-f_ttdate")).xdo.temp.timepickerdata.noPopUp||P(t)}function ut(e){var a,i,s=function(e){var a,d,i=0,s=["a","am",t.dateFormat.getMeridian(!0)[0],t.dateFormat.getMeridian()[0]],n=["p","pm",t.dateFormat.getMeridian(!0)[1],t.dateFormat.getMeridian()[1]],r=[],o=e.trim().split(/[:\s]/);if(o.length<1||o.length>4)return!1;if(null!==(a=o[0].match(/^([0-2]?[0-9][0-5][0-9])([a-zA-Z]*)$/))?(d=parseInt(a[1],10),o[0]=""+Math.floor(d/100),o.splice(1,0,""+Math.floor(d%100)),a[2]&&o.splice(2,0,a[2]),d=parseInt(o[0],10)):d=parseInt(o[0],10),isNaN(d)||d<0||d>23)return!1;for(r.push(d),a=1;a<3;a++)if(o.length>a)if(d=parseInt(o[a],10),isNaN(d))r.push(0);else{if(d<0||d>59)return!1;r.push(d),++i}else r.push(0);if((d=o[i].match(/[0-9]*([a-zA-Z]+)/))?d=d[1]:++i<o.length&&(d=o[i]),d){for(d=d.toLowerCase(),a=0;a<n.length;a++){if(d===n[a]){if(r[0]>12)return!1;r[0]<12&&(r[0]+=12);break}if(d===s[a]){if(r[0]>12)return!1;12===r[0]&&(r[0]-=12);break}}if(a===n.length)return!1}return++i,!(o.length>i)&&r}(e.temp.timepickerdata.input[0].val()),n=e.temp.vbox.val();s?(e.temp.curtime=s,a=l(e)):e.temp.ttOptions.allowNoDate&&(a="",e.temp.datepickerdata.input[0].val(e.temp.ttOptions.textNoDate)),a!==d&&e.temp.vbox.val()!==a&&(i={value:a,previous:n},e.temp.vbox.val(a),e.temp.vbox.trigger("changeTime",i),""===a&&e.temp.vbox.trigger("changeDate",i),e.temp.vbox.trigger("change",i)),e.temp.timepickerdata.input[0].val(t.dateFormat(e.temp.vbox.val(),e.temp.ttOptions.timeFormatInput,"")),e.temp.ttOptions.showClass&&b(e,a)}function ft(e,a,d,i){var s,n,r,o=e.temp.vbox.val(),p=e.temp.datepickerdata,m=e.temp.timepickerdata;(s=e.temp.curtime)||(s=e.temp.curtime=[]),s[0]=a,s[1]=d,s[2]=i,e.temp.curdate&&e.temp.curdate.length&&""!==e.temp.curdate[0]||(p.input[0].val(t.dateFormat(new Date,"yyyy-mm-dd")),p.input[0].trigger("change")),(o!==(n=l(e))||e.temp._dirty)&&(r={value:n,previous:o},""===o&&(p.input[0].val(t.dateFormat(n,"yyyy-mm-dd")),p.input[0].trigger("change")),e.temp.vbox.val(n),e.temp.vbox.trigger("changeTime",r),e.temp.vbox.trigger("change",r),delete e.temp._dirty),e.temp.ttOptions.timeOnly&&e.temp.ttOptions.timeSecs?(r=new Date(1970,1,1,0,0,0),r=new Date(r.valueOf()+1e3*n)):r=n,m.input[0].val(t.dateFormat(r,e.temp.ttOptions.timeFormatInput,"")),e.temp.ttOptions.showClass&&b(e,n)}function yt(t,e){var a=$($(t.currentTarget).parents(".xds-f_ttdate-f_ttdate")).xdo,d=[parseInt(a.temp.curtime[0],10),parseInt(a.temp.curtime[1],10),parseInt(a.temp.curtime[2],10)];d[1]+=e,(d[1]>59||d[1]<0)&&(d[0]+=Math.floor(d[1]/60),d[0]>23?(d[0]=23,d[1]=59,d[2]=59):d[0]<0?d[0]=d[1]=d[2]=0:(d[1]%=60,d[1]<0&&(d[1]+=60))),ft(a,d[0],d[1],d[2])}function xt(e){var a=$($(e.currentTarget).parents(".xds-f_ttdate-f_ttdate")).xdo;C(a,a.temp.timepickerdata,!0),function(e,a){var i,s,n=0,r=0,o=0,p=d,l=e.temp.ttOptions.allDay;for(!a.classList&&a.className&&(a.classList=a.className.split(" ")),i=0;i<a.classList.length;i++)"b-"===a.classList[i].substr(0,2)?("0"===a.classList[i].substr(2)?n=r=o=0:(n=23,r=o=59),p=!0):"cl-"===a.classList[i].substr(0,3)?parseInt(a.classList[i].substr(3),10)&&(n+=12,p=!1):"hr-"===a.classList[i].substr(0,3)?(n+=parseInt(a.classList[i].substr(3),10),p=!1):"mn-"===a.classList[i].substr(0,3)?(r=parseInt(a.classList[i].substr(3),10),p=!1):"sc-"===a.classList[i].substr(0,3)&&(o=parseInt(a.classList[i].substr(3),10),p=!1);p!==d&&l&&!0!==l&&e.state.get(l)!==p&&(s=t.state.inEvent,t.state.inEvent=!0,e.state.set(l,p),t.state.inEvent=s),ft(e,n,r,o)}(a,e.currentTarget)}function ht(e){var a,d,i=e.currentTarget,s=$($(i).parents(".xds-f_ttdate-f_ttdate")).xdo,n=s.temp.ttOptions.allDay;!i.classList&&i.className&&(i.classList=i.className.split(" ")),d=s.temp.timepickerdata.map[i.classList[1]].split(":"),C(s,s.temp.timepickerdata,!0),n&&!0!==n&&s.state.get(n)&&(a=t.state.inEvent,t.state.inEvent=!0,s.state.set(n,!1),t.state.inEvent=a),ft(s,d[0],d[1],d[2])}function gt(e){C(e,e.temp.datepickerdata),C(e,e.temp.timepickerdata),t.browser.ie&&(e.temp.datepickerdata.open=-1)}function vt(t,e,a){b(t)}function kt(t,e,a){t.temp.init_tt_loaded=!0,t.trigger("xds-init-tt-loaded")}function Dt(e,a){var i,s,n,r,o,p=this;p.temp.ready||w(p),r=p.temp.vbox.val(),p.temp.ttOptions.timeOnly||((s=t.dateFormat(e,"yyyy-mm-dd"))&&s!==p.temp.curdate.join("-")?(p.temp.datepickerdata.input[0].val(s),p.temp.datepickerdata.input[0].trigger("change"),p.temp.curdate=s.split("-")):p.temp.allowNoDate&&""!==r&&(p.temp.datepickerdata.input[0].val(p.temp.ttOptions.textNoDate),p.temp.datepickerdata.input[0].trigger("change"))),p.temp.ttOptions.dateOnly||((n=t.dateFormat(e,"HH:MM:ss","",!0))&&n!==p.temp.curtime.join(":")?(p.temp.timepickerdata.input[0].val(t.dateFormat(s+" "+n,p.temp.ttOptions.timeFormatInput)),p.temp.timepickerdata.input[0].trigger("change"),p.temp.curtime=t.dateFormat(s+" "+n,"HH:MM:ss").split(":")):p.temp.allowNoDate&&""!==r&&(p.temp.timepickerdata.input[0].val(""),p.temp.timepickerdata.input[0].trigger("change"))),(i=e?l(p):"")!==d&&r!==i&&(o={value:i,previous:r},p.temp.vbox.val(i),a||(p.temp.vbox.trigger("changeTime",o),""===i&&p.temp.vbox.trigger("changeDate",o),p.temp.vbox.trigger("change",o)))}function bt(){var e,a=this;return a.temp.ready||w(a),a.temp.vbox.val()!==(e=l(a))&&(a.temp.ttOptions.timeOnly||a.temp.datepickerdata.input[0].val(a.temp.curdate.join("-")),a.temp.ttOptions.dateOnly||a.temp.timepickerdata.input[0].val(t.dateFormat(t.parseDate(a.temp.curdate.join("-")+" "+a.temp.curtime.join("-"),!0),a.temp.ttOptions.timeFormatInput)),a.temp.vbox.val(e),a.temp.datepickerdata.input[0].trigger("change"),a.temp.timepickerdata.input[0].trigger("change"),a.temp.vbox.trigger("change"),!0)}function _t(){var e=this;return t.get("forms").is_read_only(e)?e.data:(e.temp.ready||w(e),e.temp.vbox.val())}function Ft(){var t=this,e=t.global("ttData");return h(t.getDate(),e,t.temp.ttOptions.endDate)}function Mt(t,e,a){var i=t[e];return i===d&&(i=t.arg(e))===d&&(i=a),i!==d&&(t.temp.ttOptions[e]=i),i}return(n=function(n){n.attr("tabindex",-1);var l,m,c,u,y,h,g=t.get("forms").is_read_only(n),D=["xds-ttdate-datepicker"],b=n.temp.ttOptions={};for(l in s(n),t.get_module("fa").load_fa(),n.sparse===d&&(n.sparse=n.arg("sparse")||!1),n.global("ttData")||n.global("ttData",{scheduleDays:{},ttDays:{}}),n.global("ttDataReqs")||n.global("ttDataReqs",{}),o)Mt(n,l,o[l]);b.timeOnly&&(b.noDatePopUp=!0,delete b.textToday,delete b.showClass),b.dateOnly&&(b.noTimePopUp=!0,delete b.showClass),b.dateFormatInput===d&&(b.dateFormatInput=Mt(n,"dateFormatInput",t.lang("yyyy-mm-dd",t.settings.constants.lang.tags.dateFormat))),b.timeFormatInput===d&&(b.timeFormatInput=Mt(n,"timeFormatInput",t.lang("h:MM TT",t.settings.constants.lang.tags.dateFormat))),b.showTime=!b.dateOnly&&!b.hideTime,b.showDate=!b.timeOnly&&!b.hideDate,b.pickerttnid&&(b.pickerttnid=n.tpl(b.pickerttnid)),b.pickerttnid||!1===b.pickerttnid||(b.pickerttnid=i.utils.get_parent_nid(n)),b.allowNoDate&&D.push("allownodate"),b.noIcons&&n.addClass("xds-ttdate-noicons"),b.dateOnly&&n.addClass("xds-ttdate-dateonly"),b.timeOnly&&n.addClass("xds-ttdate-timeonly"),n.data.ttpickerdata!==d&&(n.data.ttpickerdata&&(n.temp.ttpickerdata=n.data.ttpickerdata),n.data=n.data.value||!1),!1!==n.data?b.timeOnly&&b.timeSecs||(c=t.dateFormat(n.data,"obj"))&&(c=v(n,c,c),b.dateOnly?n.data=t.dateFormat(c,"yyyy-mm-dd","",!1):n.data=t.dateFormat(c,"yyyy-mm-dd HH:MM:ss","",!0)):b.allowNoDate||g&&!n.sparse||(n.defaultData=!0,b.timeOnly&&b.timeSecs?m=n.arg("defaultValue")||0:("now"===(n.arg("defaultValue")||"").substr(0,3)?(m=new Date,"+"===n.arg("defaultValue").substr(3,1)?m.setSeconds(m.getSeconds()+parseInt(n.arg("defaultValue").substr(4))):"-"===n.arg("defaultValue").substr(3,1)&&m.setSeconds(m.getSeconds()-parseInt(n.arg("defaultValue").substr(4)))):m=t.dateFormat(n.arg("defaultValue"),"obj")||new Date,c=v(n,m,m),m=b.dateOnly?c===m?t.dateFormat(new Date(c.getFullYear(),c.getMonth(),c.getDate()),"yyyy-mm-dd"):t.dateFormat(new Date(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate(),c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),"yyyy-mm-dd"):t.dateFormat(new Date(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate(),c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),"yyyy-mm-dd HH:MM:ss")),n.set(m),n.arg("disableSetState")||n.state.set(n.arg("cdid")||n.arg("id"),m)),n.temp.ttpickerdata&&(f(n,t.dateFormat(n.data,"yyyymm"),n.temp.ttpickerdata),n.ready(kt)),!1===n.data?(n.temp.curdate=[],n.temp.curtime=[],n.temp.curclass=null,y=""):(b.timeOnly||(n.temp.curdate=t.dateFormat(n.data,"yyyy-mm-dd","").split("-")),b.dateOnly||(b.timeOnly&&b.timeSecs?(u=new Date(1970,1,1,0,0,0),u=new Date(u.valueOf()+1e3*(n.data||0))):u=n.data,!0===b.allDay&&"00:00:00"===t.dateFormat(u,"HH:MM:ss")?y=t.lang("Beginning of Day"):!0===b.allDay&&"23:59:59"===t.dateFormat(u,"HH:MM:ss")?y=t.lang("End of Day"):b.allDay&&!0!==b.allDay&&n.state.get(b.allDay)?(y=t.lang(b.endDate?"End of Day":"Beginning of Day"),t.dateFormat(u,"HH:MM:ss")!==(b.endDate?"23:59:59":"00:00:00")&&(u=t.dateFormat(u,"yyyy-mm-dd")+" "+(b.endDate?"23:59:59":"00:00:00"),u=t.parseDate(u,!0),n.set(t.dateFormat(u,"yyyy-mm-dd HH:MM:ss","",!0)),n.arg("disableSetState")||n.state.set(n.arg("cdid")||n.arg("id"),n.get_val()))):y=t.dateFormat(u,b.timeFormatInput,""),u=t.dateFormat(u,"H:MM:ss"),n.temp.curtime=u?u.split(":"):t.parseTime(n.data)),b.timeOnly||b.dateOnly||(n.temp.curclass=n.temp.ttpickerdata?k(n.data,n.global("ttData")):null)),!g||n.sparse?(h=function(e){var a,d,i,s,n="";for(n+='<div class="xds-ttdate-timepicker-picker"><div class="xds-ttdate-timepicker-title"></div><div class="xds-ttdate-timepicker-subheading">',n+=e?'<div class="xds-ttdate-timepicker-col cl-0-1">'+t.lang("Time")+"</div>":'<div class="xds-ttdate-timepicker-col cl-0">'+t.dateFormat.getMeridian()[0]+'</div><div class="xds-ttdate-timepicker-col cl-1">'+t.dateFormat.getMeridian()[1]+"</div>",n+='<div class="xds-ttdate-timepicker-col cl-2">'+t.lang("Period")+'</div></div><div class="xds-ttdate-timepicker-col cl-0-1"><a tabindex="0" class="xds-ttdate-timepicker-daybound b-0">'+t.lang("Beginning of Day")+"</a>",a=0;a<2;a++){for(n+='<div class="xds-ttdate-timepicker-col cl-'+a+' col-data">',d=0;d<12;d++){for(e?(s=12*a+d,e>1&&(s=p(s))):s=0===d?12:d,n+='<div class="xds-ttdate-timepicker-row cl-'+a+" hr-"+d+'"><div class="xds-ttdate-timepicker-hour cl-'+a+" hr-"+d+'">'+s+"</div>",i=0;i<60;i+=15)n+='<a tabindex="0" class="xds-ttdate-timepicker-minute cl-'+a+" hr-"+d+" mn-"+i+'">:'+p(i)+"</a>";n+="</div>"}n+="</div>"}return n+='<a tabindex="0" class="xds-ttdate-timepicker-daybound b-1">'+t.lang("End of Day")+'</a></div><div class="xds-ttdate-timepicker-col cl-2 col-data"></div></div>'}(-1!==b.timeFormatInput.indexOf("HH")?2:-1!==b.timeFormatInput.indexOf("H")?1:0),n.inputExtend=t.html.div((b.timeOnly?"":t.html.div('<input type="text" tabindex="0" aria-label="'+t.lang("Date Input")+'" class="xds-ttdate-date '+t.css.formInput+(t.isSameDate(n.get_val())?" xds-f_ttdate-date-today":"")+'"'+(g?' readonly="readonly"':"")+' spellcheck="false" value="'+x(n.data,b.dateFormatInput,b.textToday,!!b.allowNoDate&&b.textNoDate)+'"/>'+t.html.div(t.html.div("",["xds-ttdate-date-icon","fa","far","fa-calendar-alt"]),["xds-ttdate-date-iconbox"])+(g||b.noDatePopUp?"":t.html.div(r,D)),["xds-ttdate-datebox",b.showDate?"xds-ttdate-showdate":"xds-ttdate-hidedate",b.noDatePopUp?"xds-ttdate-nodatepicker":"xds-ttdate-hasdatepicker"]))+(b.dateOnly?"":t.html.div('<input type="text" tabindex="0" aria-label="'+t.lang("Time Input")+'"class="xds-ttdate-time '+t.css.formInput+'"'+(g?' readonly="readonly"':"")+' spellcheck="false" value="'+y+'"/>'+(!g&&b.timeIncr?t.html.div(t.html.div("",["fa","fas","fa-caret-up","xds-ttdate-time-incr-up"])+t.html.div("",["fa","fas","fa-caret-down","xds-ttdate-time-incr-dn"]),["xds-ttdate-time-incr"]):"")+t.html.div(t.html.div("",["xds-ttdate-time-icon","fa","far","fa-clock"]),["xds-ttdate-time-iconbox"])+(g||b.showClass||b.noTimePopUp?"":t.html.div(h,["xds-ttdate-timepicker"])),["xds-ttdate-timebox",b.showTime?"xds-ttdate-showtime":"xds-ttdate-hidetime",!g&&b.timeIncr?"xds-ttdate-hasincr":"xds-ttdate-noincr",b.showClass?"xds-ttdate-hasclasspicker":"xds-ttdate-noclasspicker",b.noTimePopUp?"xds-ttdate-notimepicker":"xds-ttdate-hastimepicker"]))+(b.showClass?t.html.div('<input type="text" class="xds-ttdate-class '+t.css.formInput+'" readonly="readonly" tabindex="-1" value="'+(n.temp.curclass?n.temp.curclass:"")+'"/>'+(g||b.noTimePopUp?"":t.html.div(h,["xds-ttdate-timepicker"])),["xds-ttdate-classbox"]):""),["xds-f_ttdate_field",b.showClass?"xds-f_ttdate-showclass":"xds-f_ttdate-hideclass"]),t.get("forms").is_read_only(n)&&n.addClass("xds-field-readonly"),!0===b.allDay?n.addClass("xds-f_ttdate-showallday"):b.allDay&&n.addClass(b.endDate?"xds-f_ttdate-allday-edate":"xds-f_ttdate-allday-sdate")):n.showTitle=!1,t.browser.ie&&this.addClass("xds-no-ttpicker-invisibility"),g?(n.readonly=g,b.showClass&&!n.temp.ttpickerdata&&n.on("onload",vt),n.addClass("xds-f_ttdate-readonly"),n.sparse||(n.displayVal=(b.showDate?x(n.data,b.dateFormatInput,b.textToday,!!b.allowNoDate&&b.textNoDate):"")+(b.showDate&&b.showTime?" ":"")+(b.showTime?y:""))):(n.on("onload",w),n.resetDate=Dt,n.resetTTPickerNid=_,n.checkDateBounds=bt,n.on("xds-check-bounds",function(t,e,a){t.checkDateBounds()})),n.getDate=_t,n.getPeriod=Ft,n.xds.suppressInitialFocus===d&&(n.xds.suppressInitialFocus=!0),g&&!n.sparse||t.get_type("f_default").call(n,n,"hidden","xds-f_ttdate-f_ttdate-input"),g||(n.on(a,"keydown",F,{keyCode:27,priority:1e6}),n.on(e,"click xds-refocus-picker",F))}).pad2=p,n}(),ttdatejumper:function(t){s(t),t.inherit("f_ttdate.f_ttdate")},utils:{get_parent_nid:function(t){var e,a=t.data_full.pnid;return a||("string"==typeof t.get_setting("nid")&&-1!==t.get_setting("nid").indexOf("/")?a=t.get_setting("nid").split("/")[0]:"create"===t.get_setting("command")&&"number"==typeof t.get_setting("nid")&&(a=t.get_setting("nid"))),a||((e=t.caller())&&e.codecaller&&(e=e.codecaller),e&&e.get_val&&(a=e.get_val("nid","data_full")),a||(a=t.get_val("nid"))),a}}})-1===["events","utils"].indexOf(n)&&(t.types[n]=i[n]);return i});

/* modules: help */

"use strict";cf.module("help",function(o,e,t,i){var s,n,l,r=[],d={},a=0;_$(o.gbl.page).on("xds-page-load",function(){r=[],d={},f.tour.exit(),_$(".xds-help-navCont").remove()});var c=$("body"),u=$("html,body"),f={title:function(){},subTitle:function(){},nav:function(o){},navCont:function(o){s=o.ref()},exit:function(o){o.on("click",f.tour.exit)},prev:function(o){o.on("click",f.tour.prev),l=o.ref()},next:function(o){o.on("click",f.tour.next),n=o.ref()},init:function(e){e.inherit("fa.icon",{icon:" fa-question-circle",fa_class:"fas"});e.arg("field");if(e.on("click",f.tour.start),e.ready(function(){var t=e.find(".xds-help-section",1).length;t||e.xds.link?1===t&&(n.resolve().dom().hide(),l.resolve().dom().hide()):(e.xds.link="https://www.edsby.com/support/",e.xds.linktitle=e.arg("linktitle")||o.lang("Help"),e.xds.target="_blank",e.update())}),e.arg("pbit")&&o.lookup("pbits",e.arg("pbit")).val()&o.user.pbits){var t=e.arg("trigger")||"onload";e.on(t,function(e,t){f.tour.start(),e.args={xds:e.arg("xds"),pbit:e.arg("pbit")},o.get_func("clearpbit")(e,t)})}},tour:{blur:function(e){o.get_obj(r[e])&&o.get_obj(r[e]).trigger("help-blur")},focus:function(e){o.get_obj(r[e])&&o.get_obj(r[e]).trigger("help-focus"),e>r.length-2?n.resolve().dom().css("visibility","hidden"):n.resolve().dom().css("visibility","visible"),e>0?l.resolve().dom().css("visibility","visible"):0===e&&l.resolve().dom().css("visibility","hidden")},start:function(e,t){if(!e||!e.xds.link){c.addClass("xds-help xds-help-play");var i=s.resolve().dom(),n=i.clone(!0).appendTo(c);i.remove(),n.find(".xds-help-navCont").show(),o.document.on("xds-esc",function(){f.tour.exit()}),f.tour.lb=o.get("lightbox").addNewLegacy(),f.tour.focus(0)}},next:function(){f.tour.blur(a),a++,f.tour.focus(a)},prev:function(){f.tour.blur(a),a--,f.tour.focus(a)},exit:function(o){c.removeClass("xds-help"),c.removeClass("xds-hasLightbox"),f.tour.blur(a),c.removeClass("xds-help-play"),a=0,f.tour.lb&&f.tour.lb.closest(".xds-lightbox-wrap").remove()}},video:function(o){o.showTitle=!1,o.sparse=!0;var e=o.xds.embed;if(e&&e.indexOf("vimeo.com")>=0){var t=e.split("//player.vimeo.com/video/"),i=parseInt(t[1]);isNaN(i)||o.arg("videoid",i)}o.arg("videoid")?(o.arg("autoembed",!1),o.inherit("extvideo.vimeo"),o.on("help-focus",function(o){o.trigger("extvideo-do-embed")})):(o.on("help-focus",function(o,e){e.html(o.xds.embed||o.xds.title)}),o.on("help-blur",function(o,e){e.html("")}))},intro:function(o){o.xds.gdl,o.xds.noParent=!0,o.inherit("help.section"),o.on("help-focus",function(){c.removeClass("xds-help-play")}),o.on("help-blur",function(){c.addClass("xds-help-play")})},section:function(e){d[e.path]=r.length,r.push(e.path),e.on("help-focus",function(e,t){t.addClass("xds-help-focus-section"),t.find(".xds-help-video").triggerHandler("help-focus");var i=e.arg("noParent")?t:t.parent();i.offset().top+i.height()>o.window.height()+o.window.scrollTop()||i.offset().top<o.window.scrollTop()?u.animate({scrollTop:i.offset().top-50},300,function(){i.addClass("xds-help-focus")}):i.addClass("xds-help-focus")}),e.ready(function(){e.arg("target")&&e.get_target(e.arg("target"),1).css("position","relative")}),e.on("help-blur",function(o,e){e.removeClass("xds-help-focus-section"),e.find(".xds-help-video").triggerHandler("help-blur"),(e=e.hasClass("xds-help-focus")?e:e.parents(".xds-help-focus")).removeClass("xds-help-focus")})},icon:function(o){o.on("click",function(){var e=d[o.parent_xdo().path];f.tour.blur(a),f.tour.focus(e),a=e})},body:function(o){"right"==o.xds.position?o.addClass("help-body-right"):"left"==o.xds.position?o.addClass("help-body-left"):o.addClass("help-body-bottom")},link:function(o){o.addChild({xds:{id:"icon",type:"fa.glyph",icon:"arrow-circle-right",fa_class:"fas",sparse:!0}})}};return f});

/* modules: integrations */

"use strict";function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){var r=[],i=!0,n=!1,o=void 0;try{for(var a,l=e[Symbol.iterator]();!(i=(a=l.next()).done)&&(r.push(a.value),!t||r.length!==t);i=!0);}catch(e){n=!0,o=e}finally{try{i||null==l.return||l.return()}finally{if(n)throw o}}return r}function _arrayWithHoles(e){if(Array.isArray(e))return e}cf.module("integrations",function(e,t,r,i){var n,o={google:"google",office365:"windows"},a={google:e.lang("Google Drive"),office365:e.lang("Microsoft OneDrive")},l={99:"google",100:"office365"},s=Object.keys(l).reduce(function(e,t){return e[l[t]]=t,e},{});function d(t){var r,o,a,l=t,s=e.storage(l.temp.storekey,!1,"localStorage");l.temp.pickerid=r=encodeURIComponent([l.temp.storekey,(new Date).getTime(),Math.floor(65535*Math.random())].join("|")),s?(s.pickerid=r,l.temp.pickerversion=s.version):s={pickerid:r,version:l.temp.pickerversion||1,list:[]},t.arg("shared_objids")&&(s.shared_objids=t.arg("shared_objids")),s.integration=l.get_arg("integration")||l.arg("integration")||l.get_val("integration"),s.uploader_id=t.get_val("uploaderID"),o=["Integration="+s.integration,"StoreKey="+l.temp.storekey,"PickerID="+r];for(var d=Object.entries(t.arg("picker_params")||{}),p=0;p<d.length;p++){var g=_slicedToArray(d[p],2),c=g[0],u=g[1];o.push(encodeURIComponent(c)+"="+encodeURIComponent(u))}return t.arg("single")&&o.push("single=1"),t.arg("share")!==i&&o.push("share="+t.arg("share")),t.arg("embed")!==i&&o.push("embed="+t.arg("embed")),t.arg("folder")!==i?o.push("folder="+encodeURIComponent(t.arg("folder"))):t.arg("query")!==i?o.push("query="+encodeURIComponent(t.arg("query"))):t.arg("path")!==i&&(a=n.decodePath(t,t.arg("path"),s)).length&&o.push(a),e.settings.dev&&o.push("_dev=1"),e.storage(l.temp.storekey,s,"localStorage"),e.tpl(e.gbl.loadPageParam,{nid:e.gbl.user.nid,xds:l.arg("xds")||"IntegrationPickerWindow",params:o.join("&")})}function p(e){e.temp.pickerpoller=t.setInterval(function(){e.event("integrations.pollFileWindow")},500)}function g(t){var r=t.target("*integrationfiles"),n=r.val().trim().split(","),o={},a=[];if(t.temp.fileMap||(t.temp.fileMap={}),!t.temp.fileMap[t.get_arg("id")]){if(-1!==t.get_arg("ndx")){for(var l=Object.values(n),s=0;s<l.length;s++){o[l[s]]=!0}t.get_arg("id")===i||o[t.get_arg("id")]||(o[t.get_arg("id")]=!0);for(var d=Object.keys(o),p=0;p<d.length;p++){var g=d[p];"undefined"!==g&&""!==g&&a.push(g)}r.val(a.join(","))}var c={id:t.get_arg("fileid")||e.get("guid").rfc4122(),name:t.get_arg("name"),internal:{objid:t.get_arg("id")},type:"File",uploader:t.get_val("uploaderID")};t.temp.fileMap[t.get_arg("id")]=c,t.trigger("filesSelected",{files:[c],from:t.get_val("uploaderID")}),t.temp.files||(t.temp.files=[]),t.temp.files.push(c)}}function c(e){var t;e.temp.fileMap&&(t=e.temp.fileMap[e.get_arg("objid")])&&e.trigger("xds-addresources-upload-progress",{uploader:e.get_val("uploaderID"),id:t.id,percentage:e.get_arg("percentage")})}function u(e){var r,i=!0;if(e.temp.fileMap){(r=e.temp.fileMap[e.get_arg("objid")])&&(e.trigger("xds-addresources-upload-complete",{uploader:e.get_val("uploaderID"),id:r.id}),r.complete=!0);for(var n=Object.entries(e.temp.fileMap||{}),o=0;o<n.length;o++){n[o].complete||(i=!1)}i&&t.setTimeout(function(){t.clearTimeout(e.temp.uploadpoller),delete e.temp.uploadpoller},10)}}return n={_registrations:{},_utils:{registerIntegration:function(){function r(e,t){var r=e.target("*integrationfiles"),i=t.internal.objid,n=r.val().trim().split(",").filter(function(e){return e!==i});r.val(n.join(","))}return function(i){if(t.cfNative||t.EdsbyReactBridge)return!1;if(!n._registrations[i.id]){var o=i.title||a[i.id]||i.id;e.settings.dev,n._registrations[i.id]=e.get("addresources").fn.register({name:i.id,title:o,tooltip:e.tpl(e.lang("Choose from {{name}}"),{name:o}),"content-types":"*",share:i.hasShare,glyph:i.icon,start:function(t){return function(t,r){t.temp.storekey=e.get("guid").rfc4122(),t.event("integrations.openFileWindow",{integration:r.id,xds:"IntegrationPickerWindow"}),t.off("xds-integrations-poller-fileAdded"),t.off("xds-integrations-progress"),t.off("xds-integrations-fileBackendComplete"),t.on("xds-integrations-poller-fileAdded",g),t.on("xds-integrations-progress",c),t.on("xds-integrations-fileBackendComplete",u)}(t,i)},commit:function(){},remove:r})}}}()},decodePath:function(e,t,r){var n,o=(t||"").split(":"),a=i;if("folder"===o[0]){o=o.slice(1).join(":").split("/"),r.paths||(r.paths={});for(var l=Object.values(o),s=0;s<l.length;s++){var d=l[s];d=d.split("="),n=a,a=decodeURI(d[0]),d.length>1&&!r.paths[a]&&(r.paths[a]={parent:n,title:decodeURI(d[1])})}return"folder="+encodeURIComponent(a)}return"query"===o[0]?"query="+encodeURIComponent(o.slice(1).join(":")):""},get:function(t,r,i){var o,a=[t,r||"default"].join(":");return n._registrations[a]&&(o=n._registrations[a]),o||(o=n._registrations[t]),i&&o?e.get("addresources.fn.get")(o):o},register:function(t){var r,i,a=t.get_val("integrations-available");if(a&&a.length>0)for(var l=Object.values(a),s=0;s<l.length;s++){var d=l[s];r=e.lookup("integrationTitles",d),t.arg("share")&&!r.params.hasShare||(i={},Object.assign(i,r.params),i.id=d,i.icon=o[d],n._utils.registerIntegration(i))}t.exitBlank()},fn:{deleteFile:function(t,r,n){if(t.get_arg("fromServer")===i||t.get_arg("fromServer")){var o,a=t.get_arg("objid")||t.get_arg("uploaderID"),l=t,s=e.storage(l.temp.storekey,!1,"localStorage");if(s&&s.list&&s.list.length){for(o=s.list.length;--o>=0;)if(s.list[o].id===a){s.list.splice(o,1);break}0===s.list.length&&(t.temp.pickerwin&&!t.temp.pickerwin.closed||(s=-1)),e.storage(l.temp.storekey,s,"localStorage")}e.post({url:{xds:t.get_arg("deletexds")||t.arg("deletexds"),nid:e.gbl.user.nid},data:{integration:l.get_val("integration"),cancel:a}}),t.trigger("xds-integrations-fileRemoved",{source:["integration",s.integration].join("-"),id:a})}},live_doc_integration_type:function(e){return l[""+e]},openFileWindow:function(e,r,i){var n;if(e.e.stopPropagation(),e.temp.pickerid&&(e.event("integrations.pollFileWindow"),e.temp.pickerid))return!1;n=d(e),e.temp.pickerwin=t.open(n,"integrationfilewin","width=760,height=600"),p(e)},pollFileWindow:function(r,i,n){var o=!1,a=!1,l=e.storage(r.temp.storekey,!1,"localStorage");if(r.temp.pickerwin&&r.temp.pickerwin.closed?o=!0:l&&l.pickerid||(o=!0),l&&(r.temp.pickerversion||1)!==(l.version||1)&&(r.temp.pickerversion=l.version,a=!0),r.temp.picker_ready!==l.picker_ready&&(r.temp.picker_ready=l.picker_ready,r.trigger("xds-integration-picker-ready",{value:l.picker_ready})),a){if(r.temp.pickerpoller&&t.clearInterval(r.temp.pickerpoller),delete r.temp.pickerpoller,l)if(l.list&&l.list.length){for(var s,d=[],p=l.list,g=p.length;--g>=0;)((s=p[g]).inprogress||0)<0||(s.ndx=g,d.push({objid:s.id,ndx:g}),r.trigger("xds-integrations-poller-fileAdded",{source:"integration-"+l.integration,id:s.id,objid:s.id,ndx:g,name:s.title,uploaderInternal:s}));d.length?r.temp.inprogress=d:delete r.temp.inprogress,l.pickerid&&(r.temp.pickerid=l.pickerid),l.pickerversion&&(r.temp.pickerversion=l.pickerversion)}else if(l.shared_objects)for(var c=l.shared_objects,u=Object.values(c),f=0;f<u.length;f++){var m=u[f],v=$.extend(!0,{},m);v.source="integration-"+l.integration,v.uploader_id=l.uploader_id,v.source_obj=r.id(),v._count=Object.values(c).length,r.trigger("xds-integrations-poller-sharedFileAdded",v)}r.event("integrations.startUploadPoller")}o&&(r.temp.pickerwin&&delete r.temp.pickerwin,r.temp.pickerpoller&&(t.clearInterval(r.temp.pickerpoller),delete r.temp.pickerpoller),l&&(delete l.pickerid,delete r.temp.pickerid,(l.list||[]).length||(l.shared_objects||[]).length||(l=-1),e.storage(r.temp.storekey,l,"localStorage")),r.trigger("xds-integration-picker-ready",{value:"closed"}))},pollUploads:function(){return function(r,n,o){var a=[],l=!0,s=!1,d=i;try{for(var p,g=(r.temp.files||[]).values()[Symbol.iterator]();!(l=(p=g.next()).done);l=!0){var c=p.value;c.complete||a.push(c.internal.objid)}}catch(e){s=!0,d=e}finally{try{l||null==g.return||g.return()}finally{if(s)throw d}}delete r.temp.uploadpoller,a.length>0&&e.get_data({url:"".concat(e.gbl.node).concat(e.gbl.user.nid,"?xds=").concat(r.arg("xdsProgress")||"integrationfileprogress","&objids=").concat(a.join(","),"&ts=").concat((new Date).getTime())},function(i){return function(r,i){var n,o=r,a=r.temp.files,l={};if(a)for(var s=0;s<a.length;s++)l[a[s].internal.objid]=a[s];var d={};if(i.list){for(var p=Object.values(i.list),g=0;g<p.length;g++){var c=p[g];if(n=c.objid,d[c.objid]=!0,c&&l[n]){var u={source:"integration-"+o.get_val("integration"),id:n,objid:n};if(-1===c.bytesavail)o.trigger("xds-integrations-error",u);else if(c.inprogress){if(u.message=c.bytesdone,l[c.objid]&&l[c.objid].uploaderInternal&&l[c.objid].uploaderInternal.size){var f=l[c.objid].uploaderInternal.size;u.message=[c.bytesdone,e.lang("of"),f].join(" "),u.percentage=Math.round(100*c.bytesdone/f)}else u.percentage=50;o.global("integrationFilesDataInput")&&o.target("*integrationfiledata").val(o.global("integrationFilesDataInput")),o.trigger("xds-integrations-progress",u)}else u.complete=1,u.percentage=100,u.message=e.lang("Upload Complete"),o.global("integrationFilesDataInput")&&o.target("*integrationfiledata").val(o.global("integrationFilesDataInput")),o.trigger("xds-integrations-progress",u),o.trigger("xds-integrations-fileBackendComplete",u)}else if(!c){var m={source:"integration-"+o.get_val("integration"),id:n,objid:n};o.global("integrationFilesDataInput")&&o.target("*integrationfiledata").val(o.global("integrationFilesDataInput")),o.trigger("xds-integrations-fileAdded",m)}}o.temp.uploadpoller=t.setTimeout(function(){o.event("integrations.pollUploads")},250)}}(r,i)})}}(),shareFile:function(){return function(t,r,n){var o={},a=$(n.source_obj).xdo;n.uploader_id&&(t.temp.uploader_id=n.uploader_id,delete n.uploader_id),o.nodetype="6."+(s[(n.source||"").split("-").pop()]||"98"),t.temp.source=n.source,delete n.source,n.mimeType&&(o.fileType=n.mimeType,delete n.mimeType),n.open_url&&(o.openurl=n.open_url,delete n.open_url),n.url&&(o.embedurl=n.url,delete n.url),n.icon&&(o.fileicon=n.icon,delete n.icon),n.name&&(o.filename=n.name,delete n.name),a.temp.share_count=n._count||1,delete n._count,a.temp.share_complete===i&&(a.temp.share_complete=0),o=Object.assign(o,n),e.post({url:{command:"create",nid:"tmp",xds:"LiveDocCreate",nodetype:o.nodetype,noCommit:!0,temp:1},data:o,callback:function(r){!function(t,r,i,n,o){var a=e.get("guid").rfc4122();o.temp=o.rich=o.shared=!0,t.trigger("xds-integrations-poller-fileAdded",{source:"integration-"+r,fileid:a,id:o.nid,objid:n.objid,ndx:-1,name:n.filename}),t.trigger("xds-addresources-upload-complete",{uploader:i,id:a,response:o,allcomplete:++t.temp.share_complete>=(t.temp.share_count||1)})}(a,t.temp.source,t.temp.uploader_id,o,r)}})}}(),startUploadPoller:function(e,r,i){e.temp.uploadpoller||(e.temp.uploadpoller=t.setTimeout(function(){e.event("integrations.pollUploads")},250))}},types:{embedFileIFrame:function(){function t(t,r){var i;t.temp.storekey=e.get("guid").rfc4122(),t.on("xds-integrations-poller-fileAdded",g),t.on("xds-integrations-progress",c),t.on("xds-integrations-fileBackendComplete",u),i=d(t),r.attr("src",i),p(t)}function r(e,t,r){var i=e.parents(e.arg("parent_class")||".xds-cont"),n=e.dom().position(),o=i.width()-2*n.left,a=i.height()-n.top-n.left;t&&t.length&&(e.off("onload"),e.temp.container=i,t.attr("width",o).attr("height",a),e.trigger("xds-iframe-ready"))}return function(e){e.data=!1,e.arg("sparse",!0),e.tag("iframe").addAttr("width",0).addAttr("height",0).addAttr("frameborder",0),e.on("onload",r),e.on("xds-iframe-ready",t)}}()}}});

/* modules: scormrte */

"use strict";cf.module("scormrte",function(e,t,n,r){var i=function(){var t,n,i={0:"",101:e.lang("General Exception"),102:e.lang("General Initialization Failure"),103:e.lang("Already Initialized"),104:e.lang("Content Instance Terminated"),111:e.lang("General Termination Failure"),112:e.lang("Termination Before Initialization"),113:e.lang("Termination After Termination"),122:e.lang("Retrieve Data Before Initialization"),123:e.lang("Retrieve Data After Termination"),132:e.lang("Store Data Before Initialization"),133:e.lang("Store Data After Termination"),142:e.lang("Commit Before Initialization"),143:e.lang("Commit After Termination"),201:e.lang("General Argument Error"),301:e.lang("General Get Failure"),351:e.lang("General Set Failure"),391:e.lang("General Commit Failure"),401:e.lang("Undefined Data Model Element"),402:e.lang("Unimplemented Data Model Element"),403:e.lang("Data Model Element Value Not Initialized"),404:e.lang("Data Model Element Is Read Only"),405:e.lang("Data Model Element Is Write Only"),406:e.lang("Data Model Element Type Mismatch"),407:e.lang("Data Model Element Value Out Of Range"),408:e.lang("Data Model Dependency Not Established")};function a(e,t,n,r){e.lasterror={code:""+(t||0),text:n||i[t]||"",diagnostic:r||""}}function o(e,t){return 1===e.state||(a(e,t+2+e.state/2),!1)}function l(n,i,o){var l,u,c,s,m=t,d=!1,_=!1,f=[];for(c=0;c<i.length;c++)if(s=i[c],d){if("_children"===s||"_count"==s){if(2&o)return a(n,404),r;if(c<i.length-1)return a(n,401,r,e.lang("_children/_count must be the last element of a field name")),r;m=r,"_children"===s?f.push([s,[0,1,-1]]):f.push([s,[0,1,5]])}if(u=parseInt(s,10),isNaN(u))return a(n,301,r,e.lang("Invalid index")),r;_=!0,d=!1,f.push(["_index",[3,u]])}else{if(!m||!(l=m[s]))return a(n,401),r;if(0===l[0]){if(0==(l[1]&o))return a(n,406-o),r;m=r}else 1!==l[0]&&2!==l[0]||(m=l[1],d=2===l[0]);f.push([s,l])}return!s||m?(a(n,401),r):{element:s,definition:f,have_lists:_}}function u(t){e.ajax({method:"GET",url:e.gen_url({nid:t.sco.nid,xds:"SCORMData"}),synchronous:!0,callback:function(e){t.server_data=e.slices[0].data}}),(cur_data=t.server_data.cmi)||(cur_data=t.server_data.cmi={}),cur_data._version="1.0"}function c(t,n,i){e.post({url:e.gen_url({nid:t.sco.nid,xds:"SCORMData"}).replace(".json",""),synchronous:n,data:t.update_data,success:function(e){t.update_data=r},error:i||r})}function s(e){var t=!0;return e.cur_rte?e.cur_rte.Commit():(a(e,0),e.commit_timer&&(clearTimeout(e.commit_timer),e.commit_timer=r),!!o(e,140)&&(e.update_data&&c(e,!0,function(n){a(e,391),t=!1}),t))}return t={adl:[1,{data:[2,{id:[0,1,3],store:[0,3,0]}]}],cmi:[1,{_version:[0,1,0],comments_from_learner:[2,{comment:[0,3,1],location:[0,3,0],timestamp:[0,3,7]}],comments_from_lms:[2,{comment:[0,1,1],location:[0,1,0],timestamp:[0,1,7]}],completion_status:[0,3,9,["completed","incomplete","not_attempted","unknown"]],completion_threshold:[0,1,6],credit:[0,1,9,["credit","no_credit"]],entry:[0,1,9,["ab_initio","resume",""]],exit:[0,2,9,["timeout","suspend","logout","normal",""]],interactions:[2,{id:[0,3,3],type:[9,3,9,["true_false","multiple_choice","fill_in","long_fill_in","matching","performance","sequencing","likert","numeric","other"]],objectives:[2,{id:[0,3,3]}],timestamp:[0,3,7],correct_responses:[2,{pattern:[0,3,function(e,t,n,r){return!0}]}],weighting:[0,3,6],learner_response:[0,3,function(e,t,n,r){return!0}],result:[0,3,9,function(e,t,r,i){return-1!==["correct","incorrect","unanticipated","neutral"].indexOf(r)||n[6](e,definition_list,r,i)}],latency:[0,3,8],description:[0,3,1]}],launch_data:[0,1,0],learner_id:[0,1,3],leaner_name:[0,1,1],learner_preference:[2,{audio_level:[0,3,6],language:[0,3,2],delivery_speed:[0,3,6],audio_captioning:[0,3,9,["off","no_change","on"]]}],location:[0,3,0],maximum_time_allowed:[0,1,8],mode:[0,1,9,["browser","normal","review"]],objectives:[2,{id:[0,3,3],score:[2,{scaled:[0,3,6],raw:[0,3,6],max:[0,3,6],min:[0,3,6]}],success_status:[0,3,9,["passed","failed","unknown"]],completion_status:[0,3,9,["completed","incomplete","not_attempted","unknown"]],progress_measure:[0,3,6],description:[0,3,1]}],progress_measure:[0,3,6],scaled_passing_score:[0,1,6],score:[2,{scaled:[0,3,6],raw:[0,3,6],max:[0,3,6],min:[0,3,6]}],session_time:[0,2,8],success_status:[0,3,9,["passed","failed","unknown"]],suspend_data:[0,3,0],time_limit_action:[0,1,9,["exit_message","continue_message","exit_no_message","continue_no_message"]],total_time:[0,1,8]}]},n={0:function(e,t,n,r){return"string"==typeof n},1:function(e,t,n,r){return"string"==typeof n},2:function(e,t,n,r){var i;return"string"==typeof n&&(!((i=n.split("-")).length>2)&&(!(i[0].length>2)&&(2!==i.length||!(i[1].length<1||i[1].length>3))))},3:function(e,t,n,r){return!0},4:function(e,t,n,r){return!0},5:function(e,t,n,r){return!isNaN(parseInt(n,10))},6:function(e,t,n,r){return!isNaN(parseFloat(n))},7:function(e,t,n,r){return!0},8:function(e,t,n,r){return!0},9:function(e,t,n,r){var i=t[t.length-1];return!(i.length<4)&&-1!==i[3].indexOf(n)}},function(e,t){var i={state:0,lasterror:{code:0,text:"",Diagnostic:""},sco:t.object,manifest:t.manifest,server_data:r,update_data:r,commit_timer:r};return{Initialize:function(e){return 0===(t=i).state?(t.state=1,t.cur_rte=r,a(t,0),!0):(a(t,102+t.state),!1);var t},Terminate:function(e){return function(e,t){return e.cur_rte?e.cur_rte.Terminate(t):!!o(e,110)&&(s(e),e.state=2,a(e,0),!0)}(i,e)},GetValue:function(e){return function(e,t){var n,i,c,s,m=t.split(".");if(e.cur_rte)return e.cur_rte.GetValue(t);if(!o(e,120))return"";if((i=l(e,m,1))===r)return"";if(e.server_data||u(e),i.have_lists&&!validate_list_indices(e,i,0))return"";for(s=e.server_data,c=0;c<i.definition.length;c++)s=(s||{})[i.definition[c][0]];return n=s,a(e,0),n}(i,e)},SetValue:function(e,t){return function(e,t,i){var s,m,d,_,f,g,p=t.split(".");if(e.cur_rte)return e.cur_rte.SetValue(t,i);if(!o(e,130))return!1;if((s=l(e,p,2))===r)return!1;if(e.server_data||u(e),s.have_lists&&!validate_list_indices(e,s,1))return!1;if("function"!=typeof(m=s.definition[s.definition.length-1][1][2])&&(m=n[m]),!m(e,s.definition[1],i,e.server_data))return!1;for(e.update_data||(e.update_data={}),_=[],f=e.server_data,g=r,d=0;d<s.definition.length;d++){if(2===s.definition[d][1][0])return _=r,a(e,402),!1;!f&&d>0&&(f=g[s.definition[d-1][0]]={}),g=f,f=f[s.definition[d][0]],_.push(s.definition[d][0])}return _&&f!=i&&(e.commit_timer&&(clearTimeout(e.commit_timer),e.commit_timer=r),f=g[_[_.length-1]]=i,e.update_data[_.join("-")]=i,e.commit_timer=setTimeout(function(){e.commit_timer=r,c(e,!1)},2e3)),a(e,0),!0}(i,e,t)},Commit:function(){return s(i)},GetLastError:function(){return(e=i).cur_rte?e.cur_rte.Commit():e.lasterror.code;var e},GetLastErrorString:function(){return(e=i).cur_rte?e.cur_rte.GetLastErrorString():e.lasterror.text;var e},GetDiagnostic:function(){return(e=i).cur_rte?e.cur_rte.GetDiagnostic():""===t?e.lasterror.diagnostic:"";var e,t}}}}();return{load_sco:function(e,n,r){t.API_1484_11=e.data_full.active_scorm_rte=i(t.API_1484_11,r)},unload_sco:function(e,n,r){var i;(i=e.data_full.active_scorm_rte)&&(i.Terminate(),delete e.data_full.active_scorm_rte,delete t.API_1481_11)}}});

/* modules: sketchpad */

"use strict";cf.module("sketchpad",function(e,t,a){return e.get("addresources")&&e.gbl&&e.gbl.user&&e.gbl.user.features&&e.gbl.user.features.experimental&&e.get("addresources").fn.register({name:"sketchpad",tooltip:e.lang("Sketch"),"content-types":"image/*",glyph:"paint-brush",start:function(t,a){var i={xds:"SketchpadLB",uploaderTarget:t.id(),nid:e.gbl.user.nid};a&&(i.nid=a,i.seeded=!0),t.newEvent("lightbox.open",i)},bindEvents:{"xds-sketchpad-pad-blobValue":function(t){var a=t.get_arg("blob"),i=t.get_val("uploaderID");a.name="BlobUpload";var n=[{id:e.get("guid").rfc4122(),uploader:i,internal:a,type:"File",name:"sketch-"+(new Date).getTime()+".png"}];t.trigger("filesSelected",{files:n,from:i}),t.trigger("filesReady",{files:n,from:i})}},commit:"upload"}),{pad:function(t){var a=t.get_setting("seeded")&&t.siblings&&t.siblings.existingFile,i=a&&a.MaxSize&&a.MaxSize[1]||600,n=a&&a.MaxSize&&a.MaxSize[0]||600,d=n/i;i>1024&&(n=(i=1024)*d),e.get("resourceutils").xdoReady(t.tag("canvas"),"sketchpad").then(function(d){t.temp.sketchpad=new Sketchpad({element:t.id(),width:i,height:n});var l=t.dom()[0],r=l.getContext("2d");if(a){var s=new Image;s.onload=function(){r.drawImage(s,0,0)},s.src=e.tpl("{{dl}}/{{nid}}?xds=fileThumbnail&field=file&size=1024",{dl:e.gbl.dl,nid:t.nid()})}else r.fillStyle="white",r.fillRect(0,0,l.width,l.height)}),t.attr("width",i).attr("height",n),t.on("xds-sketchpad-change",function(e){var t=e.get_arg("tool"),a=e.get_arg("value");"penSize"==t?e.temp.sketchpad.penSize=a:"penColour"==t&&(e.temp.sketchpad.color=a)}).on("xds-sketchpad-reset",function(e){e.temp.sketchpad.clear()}).on("xds-sketchpad-getBlob",function(e){var t=e.dom()[0];if(t.toBlob)t.toBlob(function(t){e.trigger("xds-sketchpad-pad-blobValue",{blob:t})});else if(t.msToBlob){var a=t.msToBlob();e.trigger("xds-sketchpad-pad-blobValue",{blob:a})}})},f_rangePicker:function(e){e.inherit("f_default","range").attr("min",e.arg("minValue")||1).attr("max",e.arg("maxValue")||50)}}});

/* resources: AssignmentSubmissionButton */

"use strict";cf.resource("AssignmentSubmissionButton",function(t,n,e,a){var i={showButton:function(t){return!0},_utils:{paramExitCheck:function(n,e){var a="Student";return n.nt("node")==t.nt.Container.PDGroup()&&(a="Place Member"),e&&e.role&&(a=e.role),!e||e.exit||!n.has_role(a)}},button:function(n){var e=t.lookup("AssignmentButtonType",n.data).params;i._utils.paramExitCheck(n,e)?n.exit(!0):(n.xds._xds=[e.xds],e.event&&(n.inherit("button",{mode:e.mode}),"loadPage"===e.event?(n.inherit("loadPage",{xds:e.xds}),n.on("click",function(){t.links.handleClick(n.dom())},{stopPropagation:!0,preventDefault:!0})):"launchApp"===e.event?(n.set(n.get_val("ltiapp","siblings")),n.on("click","files.open_file",{stopPropagation:!0})):(n.on("click","lightbox",{xds:e.xds,nidSource:"rnode",stopPropagation:!0}),n.on("esubmitted",function(t){t.update(2)}))))},panel:function(n){if(n.data_this&&n.data_this.calc){var e=t.lookup("AssignmentButtonType",n.data_this.calc.button).params;if(i._utils.paramExitCheck(n,e)&&!n.data_this.calc.attempts)return void n.exit(!0);0!=n.data_this.calc.button||n.data_this.calc.attempts||n.exit(!0)}else n.exit(!0)},submitted:function(n){var e=t.lookup("AssignmentButtonType",n.data_this.calc.button).params,a=t.lookup("AssignmentButtonType",3).params;i._utils.paramExitCheck(n,e)&&n.get_val()?(n.inherit("loadPage",{xds:a.xds}),n.inherit("button"),n.on("click",function(){t.links.handleClick(n.dom())},{stopPropagation:!0,preventDefault:!0})):n.exit(!0)}};return i});

/* resources: BaseActivity */

"use strict";cf.resource("BaseActivity",function(e,t,i,s){return e.extend.fn({toggleVisibility:function(t,i){t.id(1).hasClass("collapsed")?(t.id(1).removeClass("collapsed"),e.storage("ActivityFeed-state","visible")):(t.id(1).addClass("collapsed"),e.storage("ActivityFeed-state","hidden")),t.state.set("visibility",e.storage("ActivityFeed-state"))}}),{}});

/* resources: BaseChild */

"use strict";cf.resource("BaseChild",function(s,e,i,t){return{collapse:function(e){var i=e.get_target("this:BaseChild-cols",1);i.slideToggle(300,function(){e.id(1).toggleClass("BaseChild-collapsed"),s.storage("BaseChild-status-"+e.nid(),!i.is(":visible")||-1)})},cols:function(e){s.storage("BaseChild-status-"+e.nid())&&e.addStyle("display","none")}}});

/* resources: BaseGeneric */

"use strict";function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(r,e){var t=[],n=!0,i=!1,o=void 0;try{for(var a,l=r[Symbol.iterator]();!(n=(a=l.next()).done)&&(t.push(a.value),!e||t.length!==e);n=!0);}catch(r){i=!0,o=r}finally{try{n||null==l.return||l.return()}finally{if(i)throw o}}return t}function _arrayWithHoles(r){if(Array.isArray(r))return r}cf.resource("BaseGeneric",function(r){var e={};function t(r,e){for(var t=[r.get_val("nid","node")],n=Object.entries(r.nids),i=0;i<n.length;i++){var o=_slicedToArray(n[i],2),a=o[0],l=o[1];e.includes(l.nodetype+"."+l.nodesubtype)&&t.push(a.split("/").pop())}return t.join(".")}return e.GetClasses=function(e){return t(e,[r.nt.Container.Class()])},e.GetSchools=function(e){return t(e,r.lookup("MetaTypes","Organizations").val())},e});

/* resources: BaseStudentViewGrades */

"use strict";cf.resource("BaseStudentViewGrades",function(t,e,s,a){return{init:function(e){var s=t.get("gradebook")[e.nid()].assessmentList;s=t.sort({sortBy:"date",sortType:"date"},s),e.siblings.assessments=s},output:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){var e=t.get_val("cols","siblings"),s=t.get_val("result","siblings"),r=t.get_val("gs","siblings"),i=(t.get_val("sum","siblings"),t.get_val("total","siblings"));output={columns:[],total:""};try{e=JSON.parse(e),s=JSON.parse(s),r=JSON.parse(r)}catch(t){e=!1,s=!1}if(r[0]===a&&e&&s)for(var n in r)parseFloat(e[n])>0&&output.columns.push(r[n]+": "+s[n]+"/"+e[n]);else i||e||(i=s[0]);output.columns=output.columns.join(", "),output.total=i,t.rnode.grade=output}),list:function(e){var s=e.get_val().grade,a=e.get_setting("caller").get_val("nid"),r=[];for(var i in s)a==s[i].classNid&&r.push(s[i]);r=t.sort({sort:"sort.feed",groupDirection:1},r,e);for(var n,o,d,l=r.length,u=0;u<l;)(o=r[u].thread)===n?(r[u].historical=!0,d.hasChildren=!0):d=r[u],n=o,u++;e.data.grade=r},item:function(t){t.get_val("historical")&&t.addStyle("display","none")&&t.addClass("BaseStudentViewGrades-historical"),t.get_val("hasChildren")&&t.addClass("BaseStudentViewGrades-hasChildren")},showHistory:function(t,e){var s=t.get_val("thread");e.hide(),t.get_target("sibling:hide").show(),function t(e){var a=$(e.next());return a.xds&&a.xds.get_val("thread")===s&&a.show()&&t(a),a}(e.parents(".xds-BaseStudentViewGrades-item"))},hideHistory:function(t,e){var s=t.get_val("thread");e.hide(),t.get_target("sibling:history").show(),function t(e){var a=$(e.next());return a.xds&&a.xds.get_val("thread")===s&&a.hide()&&t(a),a}(e.parents(".xds-BaseStudentViewGrades-item"))}}});

/* resources: BaseStudentViewGradesMobile */

"use strict";cf.resource("BaseStudentViewGradesMobile",function(e,r,t,s){return{}});

/* resources: BreadCrumbs */

"use strict";cf.resource("BreadCrumbs",function(t,e,o){return{breadcrumbs:function(e){var o,a,n={},r=!1;if(e.data&&e.data.crumbs&&(r=e.data.crumbs),r&&r.length>0&&(n.root=r.shift(),n.root.nid=n.root.id,"PersonalFolder"==n.root.name&&[n.root.nodetype,n.root.nodesubtype].join(".")==t.nt.Container.PersonalFolder()&&(n.root.name=t.lang("Personal Folder")),n.root.name=t.mlescape(n.root.name)),e.data.anchor&&(delete n.root,n.anchor=e.data.anchor),r&&r.length>0){for(o=0;o<r.length;o+=1)r[o].name=t.mlescape(r[o].name);n.tail=[];var d=3;for(t.layout.isPhone()&&(d=1),o=0;o<d&&r.length>0;o+=1)(a=r.pop()).nid=a.id,n.tail.unshift(a)}"subpage"!=e.arg("mode")||!e.state.top().get("tabbedform-tabTitle")||void 0!==this.state.top().get("tabbedform-mode")&&"hidden"!==this.state.top().get("tabbedform-mode")||(n.tail=[{id:e.nid(),nid:e.nid(),name:e.state.top().get("tabbedform-tabTitle")}]),e.data=n,e.set(n)},documentName:function(t){var e=t.get_val("name");t.set_val(e)}}});

/* resources: Calendar */

"use strict";function _slicedToArray(e,a){return _arrayWithHoles(e)||_iterableToArrayLimit(e,a)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,a){var t=[],n=!0,d=!1,s=void 0;try{for(var l,r=e[Symbol.iterator]();!(n=(l=r.next()).done)&&(t.push(l.value),!a||t.length!==a);n=!0);}catch(e){d=!0,s=e}finally{try{n||null==r.return||r.return()}finally{if(d)throw s}}return t}function _arrayWithHoles(e){if(Array.isArray(e))return e}cf.resource("Calendar",function(e,a,n,d){var s={events:[!0,m],due:[!0,y],completed:[!0,h],overdue:[!1,v],active:[!1,x]},l=0;function r(e,a,t){var n,s,l,r=e.t,i=e.extPerms,o=e.extCXDII,u=r.get_perm_ext("cxdii")||{};if(t)for(s=0;s<t.length;s++)if(o[l=t[s]]!==d||u[l]!==d)return n=u[l]!==d&&null!==u[l]?u[l][a]:0,o[l]!==d&&null!==o[l]&&(o[l][a]||0)>n&&(n=o[l][a]),n;return(!(n=r.get_perm(a))||i[a]&&i[a]>n)&&(n=i[a]),n}function i(a,t,n,s,l,r){var i={xds:t,nid:a.targetnid,command:"create",nodetype:"createTaskLightbox"===t||r.istask?"6.10":"6.2",data:{pnid:l&&l.nid?l.nid:a.targetnid},noCache:!0,date:e.dateFormat(s,"iso")};try{i.data.pname=l.data.title.name,i.data.pnodetype=l.data.nodetype,i.data.pnodesubtype=l.data.nodesubtype}catch(e){}r.istask!==d&&delete r.istask,r&&$.extend(!0,i,r),a.t.args=i,e.get_func("lightbox")(a.t)}function o(e){return e}function u(a,n){var d,s={slice:{data:{indent:"",title:"",hover:n}}},i=s.slice,u=i.data;return u.nodetype=n.nodetype,u.nodesubtype=n.nodesubtype,u.nid=n.nid,u.rid=n.rid,u.allday=n.allday,u.title=n.name,u.type=n.type,u.subtype=n.subtype,u.pnodetype=n.pnodetype,u.pnodesubtype=n.pnodesubtype,u.indent="00"===e.dateFormat(n.sdate,"MM")?e.dateFormat(n.sdate,"ht-"):e.dateFormat(n.sdate,"h:MMt-"),i.xds=a.t.xds_full.fields.hoverTemplate,i.xds._resources="CalendarPanel",i.perm=a.extCXDII[n.pnid]?{rights:t.get_perm(a,e.getCalendarItemXDS(a.t,n),[n.pnid]),xdii:a.extCXDII[n.pnid]}:a.t._perm,d="TitleBlock-"+l++,s.cook=o,s.callback=function(e){var a=$("#"+d),t=$('<div class="xds-Calendar-title-wrap">'+e+"</div>");a.replaceWith(t),this.bind(t)},a.drawEvents.push(e.utils.xdsbuild({url:a.t.get_setting("url"),noTarget:!0},s)),u._caldata=a,u._obj=n,2&r(a,"SetTaskStatus",[n.pnid])&&[n.type,n.subtype].join(".")===e.nt.Document.Task()&&-1!==[-1,1,2].indexOf(n.taskstatus||0)?'<div class="xds-f_checkbox'+(2===n.taskstatus?" xds-f_checkbox-checked":"")+" itemid-"+[n.pnid,n.rid,n.nid].join("/")+'"><div class="xds-f_checkbox-ui '+e.css.formSprite+'"></div></div><p class="xds-Calendar-taskttitle"><span id="'+d+'">'+n.name+"</span></p>":'<span id="'+d+'">'+u.indent+n.name+"</span>"}function c(e,a){return new Date(e.getTime()+1e3*a)}function p(a,t,n){if(a){var s,l,r=a.schedules[n.scheduleID];n.name&&(r||(r=a.schedules[n.scheduleID]={ndx:++a.ndx,items:[],map:{}}),n.ndx=s=r.ndx,n.className=["xds-Calendar-event","xds-schoolCalendar-schedule-"+s],s>5&&n.className.push("xds-schoolCalendar-schedule-n"),n.start=e.dateFormat(n.date,"object"),n.allDay=!0,n.title=n.name,n.schedndx=s,l=e.dateFormat(n.date,"yyyymmdd"),r.map[l]!==d||(r.map[l]=r.items.length,r.items.push(n)))}}function f(a,t,n){n.titleText=n.title||"",n.title=a.renderItemTitleCB,function(a,t){var n=e.getCalendarItemXDS(a.t,t);n&&1&r(a,n,[a.t.nid,a.t.pnid])&&(t.openXDS=n)}(a,n),!n.openXDS&&n.className.push("xds-CalendarItem-unopenable"),t.push(n)}function m(a,t,n){var s,l;n.sdate!==d&&(n.className=["xds-Calendar-event","xds-events-type-"+n.type+(n.subtype?"_"+n.subtype:"")],n.start=e.dateFormat(n.sdate,"object"),n.allDay=n.allday||!1,n.allDay&&n.className.push("xds-Calendar-allday"),"duration"in n?n.allDay?n.end=(s=n.start,l=n.duration,(s=new Date(s.getTime())).setDate(s.getDate()+(l-1)),s):n.end=c(n.start,n.duration):"edate"in n&&(n.end=e.dateFormat(n.end,"object")||!1),!n.allDay&&!e.utils.isSameDate(n.start,n.end)&&n.className.push("xds-Calendar-multiday"),f(a,t,n))}function y(a,t,n){n.duedate!==d&&(n.className=["xds-Calendar-task","xds-Calendar-duetask","xds-events-type-"+n.type+(n.subtype?"_"+n.subtype:"")],n.start=e.dateFormat(n.duedate,"object"),n.end=c(n.start,3600),n.allDay=!1,f(a,t,n))}function h(a,t,n){n.completeddate!==d&&(n.start=e.dateFormat(n.completeddate,"object"),n.end=c(n.start,3600),n.className=["xds-Calendar-task","xds-events-type-"+n.type+(n.subtype?"_"+n.subtype:"")],(6===n.taskstatus||2===n.taskstatus&&n.duedate&&n.start>e.dateFormat(n.duedate,"object"))&&n.className.push("xds-Calendar-overduetask"),n.className.push("xds-Calendar-completedtask"),n.allDay=!1,f(a,t,n))}function v(e,a,t){t.duedate!==d&&(t.className=["xds-Calendar-task","xds-Calendar-overduetask","xds-events-type-"+t.type+(t.subtype?"_"+t.subtype:"")],t.start=new Date,t.end=t.start,t.allDay=!0,f(e,a,t))}function x(e,a,t){t.duedate!==d&&(t.className=["xds-Calendar-task","xds-Calendar-activetask","xds-events-type-"+t.type+(t.subtype?"_"+t.subtype:"")],t.start=new Date,t.end=t.start,t.allDay=!0,f(e,a,t))}function C(e,a){var t,n,d,s,l,r,i,o=e[a],u=e._common;if(!u&&e.common){u=e._common={};for(var c=Object.values(e.common),p=0;p<c.length;p++){var f=c[p];u[d=f.nid]||(u[d]=[]),u[d].push(f)}}if(o&&u)for(var m=Object.entries(o),y=0;y<m.length;y++){var h=_slicedToArray(m[y],2);if(t=h[0],r=u[d=(i=h[1]).nid])for("string"==typeof(s=i.rid)?(l=2===(s=s.split(".")).length?parseInt(s[1],10):0,s=parseInt(s[0])):l=i.ndx||0,n=r.length;--n>=0;)if(r[n].rid===s&&(r[n].ndx||0)===l){o[t]=i=r[n];break}}return o}function g(a,t,n,l){var r,i,o,u,c=[],p=C(t,"schedules"),f=new Date,m=n<=f&&f<=l;for(i in p&&(r=a.schedDays,$.each(p,function(a,t){!function(a,t){var n,s=t.date,l=t.name;s!==d&&l&&(n=t.scheduleID,a[s=e.dateFormat(s,"yyyymmdd")]===d&&(a[s]={dirty:!0}),a[s][n]===d&&(a[s][n]=[]),a[s][n].dirty=!0,a[s][n].push(l))}(r,t)}),a.t.trigger("newScheduleDataAvailable")),s)(u=C(t,i))&&(o=s[i][1],(m||s[i][0])&&$.each(u,function(t,n){e.memory.deletedNodes&&e.memory.deletedNodes[n.nid]||e.memory.deletedRefs&&e.memory.deletedRefs[parseInt((""+n.rid).split(".")[0],10)]||o(a,c,n)}));return c}function _(a,t,n,d,s){var l;a.baseData?(d(s(a,a.baseData,t,n)),delete a.baseData):(l=new Date((t.getTime()+n.getTime())/2),e.get_func("get_data")({nid:a.targetnid,xds:a.dataXDS,targetDate:e.dateFormat(l,"yyyymmdd")},function(e){d(s(a,e,t,n))}))}function b(a,t,n){t.openXDS&&($(n.target).hasClass("xds-f_checkbox-ui")||e.get_func("CalendarPanel.utils.open_item")(a.t,t,n))}function D(a,t){var n=t.CalendarObj=$(a),s={events:function(e,a,n){return _(t,e,a,n,g)},header:{left:"today prev,next title",right:"ixLB newTask,newEvent month,agendaWeek,agendaDay"},eventClick:function(e,a){return b(t,e,a)},renderEvents:function(){for(;t.drawEvents.length;)t.drawEvents.pop().bind()},auxDateContentCB:function(a){return function(a,t){var n,s,l,r=e.dateFormat(t,"yyyymmdd"),i=[],o=[],u=a.schedDays,c=(a.t.build.schedules||{})[a.t.data_full.nid];if(u[r]!==d){if(!1===u[r].dirty)n=u[r].days;else{for(var p=Object.entries(u[r]),f=0;f<p.length;f++){var m=_slicedToArray(p[f],2),y=m[0],h=m[1];if("dirty"!==y&&"days"!==y){if(h.dirty){for(h.sort(),s=0;s<h.length-1;)h[s]===h[s+1]?h.splice(s,1):++s;h.days=h.join(", "),h.dirty=!1}i.push(y),o.push(h)}}for(l=0;l<i.length;l++)i[l]='<span class="xds-Calendar-daylabel xds-schoolCalendar-schedule-'+((c.schedules[i[l]]||{}).ndx||"n")+'">'+o[l].days+"</span>";n=u[r].days=i.join(" "),u[r].dirty=!1}return n}return""}(t,a)},buttonText:{today:e.lang("Today"),month:e.lang("Month"),week:e.lang("Week"),day:e.lang("Day"),newTask:e.lang("New Task"),newEvent:e.lang("New Event"),ixLB:e.lang("Sync")}};t.CreateXDS?(s.dayClick=function(e,a,n){return function(e,a,t){var n={slipDate:0},d=e.CreateXDS,s=e.CalendarObj;d!==(e.t.xds_full.xds_calform_general||"CalendarEventTaskLB")&&d!==(e.t.xds_full.calform_event||"CalendarEventLB")||t&&(s.fullCalendar("getView").allDayRow().length?$.extend(!0,n,{allDay:1,data:{form:{when:{allday:1}}}}):$.extend(!0,n,{noTime:1})),i(e,d,e.datefield,new Date(a),e.t.data_full,n)}(t,e,a)},$(a).removeClass("xds-Calendar-noCreate")):$(a).addClass("xds-Calendar-noCreate"),t.t.xds_full.xds_ix&&t.t.has_read(t.t.xds_full.xds_ix)&&"0"!==t.t.state.get("calsyncenable")&&(s.ixLB=function(){t.t.newEvent("lightbox",{xds:t.t.xds_full.xds_ix})}),t.createevent&&(s.newEvent=function(){i(t,t.t.xds_full.xds_calform_event||"CalendarEventLB",0,function(e,a,t){var n,d,s,l=new Date;if(a.valueOf()<=l.valueOf()&&t.valueOf()>=l.valueOf())n=l;else if(t.valueOf()-a.valueOf()>6084e5)if(d=e.getFullYear(),s=e.getMonth(),e.valueOf()>l.valueOf())n=new Date(d,s,1);else{switch(s){case 3:case 5:case 8:case 10:e=30;break;case 1:e=d%4!=0||d%100==0&&d%400!=0?28:29;break;default:e=31}n=new Date(d,s,e)}else n=a.valueOf()>l.valueOf()?a:new Date(t.valueOf()-864e5);return n.setHours(9),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0),n}(n.fullCalendar("getDate"),n.fullCalendar("getView").start,n.fullCalendar("getView").end),t.t.data_full,{noTime:1,slipDate:1})}),t.calparams&&$.extend(!0,s,t.calparams),n.empty(),n.delegate(".xds-f_checkbox","click",function(a){!function(a,t){var n,d,s,l,r,i=a.t,o=t.currentTarget.classList||t.currentTarget.className.split(/\s+/),u=!1,c=-1;for(t.stopPropagation();++c<o.length;)2===(r=o[c].split("-")).length&&"itemid"===r[0]?n=r[1].split("/"):"xds-f_checkbox-checked"===o[c]&&(u=!0);n&&(i.newEvent("post",{xds:"SetTaskStatus",nid:n[1],action:e.gbl.p+"core/node/"+n.join("/")+"?xds=SetTaskStatus",data:{taskstatus:u?1:2}}),s=(d=$(t.currentTarget)).parents(".xds-Calendar-task"),d[l=u?"removeClass":"addClass"]("xds-f_checkbox-checked"),s[l]("xds-Calendar-completedtask"))}(t,a)}),t.drawEvents=[],n.fullCalendar(s)}return{types:{calendar:function(){var a;function t(e,a,t){e.e.stopPropagation(),e.id(1).fullCalendar("refetchEvents")}function n(e,a){e.on("rebuild_calendar",t),D(e.id(1),e.temp.mycaldata)}return(a=function(a){var t,s,l=(a.arg("data_source")||"siblings:caldata").split(":").reverse();(s=a.temp.mycaldata={t:a,schedDays:{},events:[],extPerms:{},extCXDII:{},targetnid:a.get_setting("nid"),baseData:a.get_val(l[0],l.length>1?l[1]:d),dataXDS:a.xds_full.xds_data||"CalendarData"}).calparams={firstDay:s.baseData.firstday,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"].map(e.lang),monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map(e.lang),dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].map(e.lang),dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e.lang)},s.renderItemTitleCB=function(e){return u(s,e)},s.createevent=2&r(s,a.xds_full.xds_calform_event||"CalendarEventLB"),s.createevent&&(s.CreateXDS=a.xds_full.xds_calform_event||"CalendarEventLB",s.datefield="start"),(t=e.get_func("CalendarPanel.utils.get_date")(a))&&(s.calparams.display_date=t),a.ready(n)}).drawFullCalendar=D,a.getCalItems=_,a.receiveCalItem=f,a.receiveCalEvent=m,a.receiveCalDueTask=y,a.receiveCalCompletedTask=h,a.receiveCalOverdueTask=v,a.receiveCalActiveTask=x,a.receiveSchoolSchedule=p,a}(),hover:function(){function e(){$(this).remove()}function a(a){a.dom().parents(".fc-event").fadeOut(e)}return function(e){e.removehook=a,e.inherit("hoverIntent")}}(),hoverbox:function(e){e.addClass("xds-events-type-"+e.get_val("type")+"_"+e.get_val("subtype")),e.addClass("CalendarItem"),e[e.get_val("openXDS")?"removeClass":"addClass"]("xds-CalendarItem-unopenable"),e[e.get_val("editXDS")?"removeClass":"addClass"]("xds-CalendarItem-readonly"),e[e.get_val("editXDS")?"addClass":"removeClass"]("xds-CalendarItem-editable"),e.inherit("CalendarPanel.types.hover")},hovertitle:function(a){var t=""+a.get_val("pnodetype","node"),n=[t,a.get_val("nodesubtype","node")].join(".");t===e.nt.Group()?a.addClass("xds-Calendar-source-group"):n===e.nt.Container.Class()?a.addClass("xds-Calendar-source-class"):t===e.nt.Container()?a.addClass("xds-Calendar-source-place"):t===e.nt.User()&&a.addClass("xds-Calendar-source-local")},load_schedule:function(a){var t,n=e.get_type("Calendar.types.calendar").receiveSchoolSchedule,d=a.build.schedules;d||(d=a.build.schedules={}),(t=d[a.data_full.nid])||(t=d[a.data_full.nid]={schedules:{},ndx:0}),n(t,[],a.rnode)},map_schedules:function(e){for(var a=[],t=(e.build.schedules||{})[e.data_full.nid]||{},n=Object.values(t.schedules||{}),d=0;d<n.length;d++){var s=n[d];a.push(s.items[0])}e.map({schedules:a}),e.inherit(e.arg("ttag")||"div")},scheduleVisibleCheckbox:function(e){e.set(!0),e.inherit("f_checkbox")},schoolSchedule:function(e){e.addClass("xds-schoolCalendar-schedule-"+e.data.ndx),e.data.ndx>5&&e.addClass("xds-schoolCalendar-schedule-n")}},events:{hoverOpenEvent:function(e,a,t){b(e.data_full._caldata,e.data_full._obj,e.e)},loadPunchThru:function(e,a,t){var n=e.xds_full.xds_pthru||"CalendarPunchThru";e.get_perm(n)&&e.event("loadxds",{xds:n})},showHideSchedule:function(e,a,t){e.gebi(e.xds_full.id).toggleClass("xds-schoolCalendar-schedule-"+e.data.ndx+"-hidden")}}}});

/* resources: CalendarEvent */

"use strict";cf.resource("CalendarEvent",function(e,t,a,r){function p(e,t,a){var p,n;if(!e.get_val()){if((n=e.state.top().get(t))===r)for(p=e.caller();n===r&&p;)(n=p.state.get(t))===r&&p.rnode&&(n=p.state.top().get(t)),n===r&&a&&(n=p.state.get(a))===r&&p.rnode&&(n=p.state.top().get(a)),p=p.caller();return n!==r&&(e.set(n),e.state.set(e.arg("state")||e.arg("id"),n)),n}}return{types:{deleteone:function(t){var a,r,p=t.state.get("occurrence"),n={occurrence_date:e.dateFormat(p,t.arg("dateFormatOccDate")||"mmmm d"),occurrence_time:e.dateFormat(p,t.arg("dateFormatOccDate")||"h:MM tt")};(a=t.arg("_confirm"))||t.arg("_confirm",a=t.arg("confirm")),(r=t.arg("_title"))||t.arg("_title",r=t.arg("title")),t.arg("confirm",e.tpl(a,n)),""+t.state.get("rtype")=="1"&&(t.state.get("rinterval")||900)%86400&&(r=t.arg("titleTimed")),t.arg("title",e.tpl(r,n)),t.inherit("confirmDelete")},f_runtil:function(t){var a=parseInt(t.state.get("rtype")||0,10);if(isNaN(a)||0===a)return t.exitBlank();t.sparse=t.hideTime=t.allowNoDate=!0,t.textNoDate||t.arg("textNoDate")||(t.textNoDate=e.lang("Forever")),t.inherit("f_ttdate.f_ttdate")},occurrence:function(e){p(e,"occurrence"),e.inherit("sys")},parentid:function(e){p(e,"pnid","nid"),e.inherit("sys")},parentname:function(e){e.sparse=!1,p(e,"pname"),!e.data&&(e.showTitle=!1),e.inherit("block")},parentnodesubtype:function(e){p(e,"pnodesubtype","nodesubtype"),e.inherit("sys")},parentnodetype:function(e){p(e,"pnodetype","nodetype"),e.inherit("sys")},rtype:function(){function t(e,t,a){var r=e.parents(".xds-CalendarEvent-types-rtype").xdo,p=a.xdo.arg("params"),n=a.value,s=p.rtype,i=p.multiplier,m=p.rcustom,l=p.rtypecustom,d=r.temp.component_fields;r.readonly?(e.set(r.temp.rtype_selected),e.update()):r.temp.rtype_selected!==n&&(e.state.set(r.arg("id")+"_rtype_selected",n),e.state.set(d.rtype,s),e.state.set(d.rinterval,i),e.state.set(d.rparam,m),e.state.set(d.rtypecustom,l))}function a(e,t){var a=e.params,r=t.params,p=(a.sortval||0)-(r.sortval||0);return 0===p&&(p=a.rtype-r.rtype),0===p&&(p=a.multiplier-r.multiplier),0===p&&(p=(""+e.val()).localeCompare(""+t.val())),p}function p(r){var p,n="rtype_"+r.temp.el_ndx,s=r.temp.rtype_choices,i=[];for(s.sort(a),p=0;p<s.length;p++)i.push({id:"rtype_"+p,title:s[p].str(),"data-value":s[p].val(),params:s[p].params});r.addChild({id:n,type:"dd.select",fields:i,css:"xds-CalendarEvent-types-rtype-picker","aria-label":e.lang("Select repeat type"),events:[{trigger:"xds-picker-picked",func:t}]}),r.data[n]=r.temp.rtype_selected}function n(e,t,a){var r=e.parents(".xds-CalendarEvent-types-rtype").xdo,p=parseInt(e.val(),10)*r.temp.curintervalmult;p<r.temp.mininterval?e.val(Math.ceil(r.temp.mininterval/r.temp.curintervalmult)):p!==r.temp.rinterval&&e.state.set(r.temp.component_fields.rinterval,p)}function s(e){var t="rinterval_"+e.temp.el_ndx;e.addChild({id:t,type:"f_int",css:"xds-CalendarEvent-types-rtype-rinterval",min:Math.ceil(e.temp.mininterval/(e.temp.curintervalmult||1)),events:[{trigger:"change",func:n}]}),e.data[t]=Math.ceil(e.temp.rinterval/(e.temp.curintervalmult||1))}function i(e,t,a){var r=e.parents(".xds-CalendarEvent-types-rtype").xdo;e.val()!==r.temp.rparam&&e.state.set(r.temp.component_fields.rparam,e.val())}function m(e){var t="rparam_text_"+e.temp.el_ndx;e.addChild({id:t,type:"f_str",css:"xds-CalendarEvent-types-rtype-rparam-text",events:[{trigger:"change",func:i}]}),e.data[t]=e.temp.rparam}function l(t,a,r){var p=t.parents(".xds-CalendarEvent-types-rtype").xdo,n=parseInt(t.val(),10);isNaN(n)||n<t.arg("min")||n>t.arg("max")?n=parseInt(p.temp.rparam,10)||1:n!==p.temp.rtype&&t.state.set(p.temp.component_fields.rparam,n),t.val(n+e.numsuffix(n))}function d(e,t,a){38===e.e.which||40===e.e.which?(e.val(parseInt(e.val(),10)+(39-e.e.which)),e.trigger("change")):!e.e.charCode||e.e.charCode>=48&&e.e.charCode<=57||e.e.preventDefault()}function c(t){var a="rparam_numerith_"+t.temp.el_ndx,r=parseInt(t.temp.rparam||e.dateFormat(t.state.get(t.temp.sdatefld),"d"),10)||1;t.addChild({id:a,type:"f_str",css:"xds-CalendarEvent-types-rtype-rparam-numerith",min:1,max:31,events:[{trigger:"change",func:l},{trigger:"keydown keypress",func:d}]}),t.data[a]=r+e.numsuffix(r)}function o(e,t,a){var r=e.parents(".xds-CalendarEvent-types-rtype").xdo,p=parseInt(e.val(),10)*Math.abs(parseInt(r.temp.rparam,10)||0);p!==r.temp.rparam&&e.state.set(r.temp.component_fields.rparam,p)}function u(e,t,a){var r=e.parents(".xds-CalendarEvent-types-rtype").xdo,p=t.siblings(".xds-CalendarEvent-types-rtype-rparam-numeric-sign"),n=parseInt(e.val(),10);p.length?n*=parseInt(p.xdo.val(),10):r.temp.rparam&&(n*=(parseInt(r.temp.rparam,10)||1)<0?-1:1),n!==r.temp.rparam&&e.state.set(r.temp.component_fields.rparam,n)}function y(t,a){a.length&&"signpicker"===a[0]?function(t){var a="rparam_numeric_sign_"+t.temp.el_ndx;t.addChild({id:a,type:"dd.select",css:"xds-CalendarEvent-types-rtype-rparam-numeric-sign","aria-label":e.lang("Select repeat offset direction"),fields:[{id:a+"_negative",title:e.lookup("repeatTypeNumericSignPickerOptions",-1).str(),"data-value":-1},{id:a+"_positive",title:e.lookup("repeatTypeNumericSignPickerOptions",1).str(),"data-value":1}],events:[{trigger:"xds-picker-picked",func:o}]}),t.data[a]=(parseInt(t.temp.rparam,10)||0)<0?-1:1}(t,a.slice(1)):function(e,t){var a="rparam_numeric"+e.temp.el_ndx,r={id:a,type:"f_int",css:"xds-CalendarEvent-types-rtype-rparam-numeric",min:0,events:[{trigger:"change",func:u}]};t.length&&(r.max=parseInt(t[0])),e.addChild(r),e.data[a]=Math.abs(e.temp.rparam||0)}(t,a)}function v(e,t,a){var r=e.parents(".xds-CalendarEvent-types-rtype").xdo,p=r.temp.rparam_list,n=!1,s=""+e.arg("weekday"),i=p.indexOf(s);e.val()&&-1===i?(p.push(s),p.sort(),n=!0):e.val()||-1===i||(p.splice(i,1),n=!0),n&&e.state.set(r.temp.component_fields.rparam,"["+p.join(",")+"]")}function f(t){var a,p,n="rparam_weekday_matrix_"+t.temp.el_ndx,s={id:n,css:"xds-CalendarEvent-types-rtype-rparam-weekday_matrix",fields:[]},i=e.dateFormat.getWeekdays().slice(0);for(i.push(i.splice(0,1)[0]),t.temp.rparam!==r&&("string"==typeof t.temp.rparam?(a=(t.temp.rparam||"").match(/\s*\[([^\]]*)\]\s*/))&&a[1].length&&(t.temp.rparam_list=a[1].split(",")):"number"==typeof t.temp.rparam?t.temp.rparam_list=[(t.temp.rparam+6)%7]:e.is_arr(t.temp.rparam)&&(t.temp.rparam_list=t.temp.rparam.map(function(e){return""+e}))),t.temp.rparam_list||(t.temp.rparam_list=[""+(parseInt(e.dateFormat(t.state.get(t.temp.sdatefld),"w"),10)+6)%7],t.state.set(t.temp.component_fields.rparam,"["+t.temp.rparam_list.join(",")+"]")),t.data[n]={},p=0;p<7;p++)s.fields.push({id:n+"_wd_"+p,type:"f_checkbox",title:i[p],css:"xds-CalendarEvent-types-rtype-rparam-weekday_matrix-wd",weekday:p,events:[{trigger:"click",func:v}]}),-1!==t.temp.rparam_list.indexOf(""+p)&&(t.data[n][n+"_wd_"+p]=1);t.addChild(s)}function _(e,t){var a="sdate_"+e.temp.el_ndx;e.addChild({id:a,type:"nowrap",dateFormat:t.join("-")}),e.data[a]=e.state.get(e.temp.sdatefld)}function g(e,t){e.addChild({id:"text_"+e.temp.el_ndx,type:"span",title:t,sparse:!0,noSpaceTitle:!0})}var h=["rtype","rtypecustom","rinterval","rparam"];return function(t){var a,n,i,l,d,o,u,v,x,C,k,w,b,E,I,O=t.get_children(),D=t.arg("allowed_rtypes")?t.arg("allowed_rtypes").split(","):r;for(t.sparse=!0,!1===t.data&&t.set({}),t.temp.component_fields={},u=O.length;--u>=0;)n=(a=O[u]).rtype_component||a.cdid||a.dbid,-1===h.indexOf(n)?"rcustom"===n?t.temp.component_fields.rparam=a.id:t.removeChild(a.id):t.temp.component_fields[n]=a.id;for(v in t.readonly=e.get("forms").is_read_only(t),t.temp.rtype_selected=t.state.get(t.arg("id")+"_rtype_selected"),t.temp.rtype=t.state.get(t.temp.component_fields.rtype||"rtype"),t.temp.rtype=parseInt(t.temp.rtype!==r?t.temp.rtype:t.arg("defaultValue"),10)||t.arg("defaultValue")||0,t.temp.rtypecustom=t.state.get(t.temp.component_fields.rtypecustom||"rtypecustom"),t.temp.rinterval=t.state.get(t.temp.component_fields.rinterval||"rinterval"),t.temp.rinterval=parseInt(t.temp.rinterval||"1",10)||1,t.temp.rparam=t.state.get(t.temp.component_fields.rparam||"rcustom"),t.temp.sdatefld=t.arg("sdate")||"sdate",setTimeout(function(){t.trigger("xds-f_rtype-set")},1),t.temp.rtype_choices=[],i=e.constant.constants.repeatTypes)"_reverse"!==v&&-1!=v&&(x=i[v],D&&x.params.rtype>0&&-1===D.indexOf(""+x.val())||(t.temp.rtype_choices.push(x),x.val()===t.temp.rtype_selected?C=x:(x.params.rtype||0)==t.temp.rtype&&(k=x.params.multiplier,(!C||k&&k>C.params.multiplier&&t.temp.rinterval%k==0)&&(C=x))));if(l=t.get_val("customrtypes")?JSON.parse(t.get_val("customrtypes")):r,d=e.constant.constants.repeatTypesCustom,l&&d){for(v in I={},l)I[(x=l[v]).func]=x.title;for(v in l=I,d)"_reverse"!==v&&-1!=v&&(999===(x=d[v]).params.rtype&&!l[x.params.rtypecustom]||D&&-1===D.indexOf("999."+v)||(t.temp.rtype_choices.push(x),t.temp.rtype===x.params.rtype&&t.temp.rtypecustom==x.params.rtypecustom&&(k=x.params.multiplier||1,(!C||k&&k>t.temp.curintervalmult&&t.temp.rinterval%k==0&&C.val()!=t.temp.rtype_selected)&&(C=x))))}for(C||(C=i[-1]),t.temp.curintervalmult=C.params.multiplier||1,t.temp.mininterval=C.params["min-interval"]||1,o=C.params.titleSetup,C.str(),t.temp.rtype_selected!=C.val()&&(t.temp.rtype_selected=C.val(),t.state.set(t.arg("id")+"_rtype_selected",t.temp.rtype_selected)),t.temp.rinterval<(t.temp.mininterval||1)&&(t.temp.rinterval=t.temp.mininterval||1,t.state.set(t.temp.component_fields.rinterval||"rinterval",t.temp.rinterval)),w=o.split(/({[^}]+})/).reverse(),t.temp.el_ndx=-1;w.length;)if(b=w.pop(),++t.temp.el_ndx,E=b.match(/{([^}]+)}/)){if((E=E[1].split("-")).length<2)continue;switch(E[0]){case"rtype":p(t,E.slice(1));break;case"rinterval":s(t,E.slice(1));break;case"sdate":_(t,E.slice(1));break;case"rcustom":switch(E[1]){case"text":m(t,E.slice(2));break;case"numerith":c(t,E.slice(2));break;case"numeric":y(t,E.slice(2));break;case"weekday_matrix":f(t)}}}else b.length&&g(t,b)}}()},events:{doDelete:function(e,t,a){var r=e.get_setting("nid");-1===r.indexOf("/")&&e.caller().rnode&&(r=[e.caller().data_full.nid,e.caller().rnode.rid,e.state.get("nid")].join("/")),e.event("post",{nid:r,xds:"CalendarItemDelete",command:"delete"})},doDeleteOne:function(t,a,r){t.event("post",{data:{delete_occurrence:e.dateFormat(t.state.get("occurrence"),"iso")}})}}}});

/* resources: CalendarPanel */

"use strict";function _slicedToArray(e,a){return _arrayWithHoles(e)||_iterableToArrayLimit(e,a)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,a){var t=[],n=!0,d=!1,r=void 0;try{for(var s,l=e[Symbol.iterator]();!(n=(s=l.next()).done)&&(t.push(s.value),!a||t.length!==a);n=!0);}catch(e){d=!0,r=e}finally{try{n||null==l.return||l.return()}finally{if(d)throw r}}return t}function _arrayWithHoles(e){if(Array.isArray(e))return e}cf.resource("CalendarPanel",function(e,a,t,n){var d;function r(e){var a,t,n,d,r;if(e.build.cal_date)return e.build.cal_date;if(null!==(a=(e.get_setting("url")||"").match(/[?&]targetDate=([^&]+)/))){if(3===(a=a[1].split("-")).length)n=parseInt(a[0],10),d=parseInt(a[1],10)-1,r=parseInt(a[2],10);else{a=a[0];try{n=parseInt(a.substr(0,4),10),d=parseInt(a.substr(4,2),10)-1,r=parseInt(a.substr(6,2),10)}catch(e){}}isNaN(n)||isNaN(d)||isNaN(r)||(t=new Date(n,d,r))}return t||(t=new Date).setHours(0,0,0,0),t}function s(e){var a;return e.t&&e.t.xds&&e.t.xds.cssPath?"CalendarPanel"===(a=e.t.xds.path_include||e.t.xds.cssPath)&&e.t.xds.t&&e.t.xds.t.xds&&(a=e.t.xds.t.xds.path_include||e.t.xds.t.xds.cssPath):a="xds-cont",{path:a}}function l(e,a,t){var d,r,s=e.get_perm_ext("cxdii");if(s)for(d=0;d<a.length;d++)if((r=a[d])>=0&&s[r]!==n)return s[r]?s[r][t]:0;return e.get_perm(t)}function i(a){var t,d=a.rnode.render||a.rnode,r=a.data.taskstatus;if(!a.data)return!1;if(13===a.data.nodesubtype||11===a.data.nodesubtype);else if(r){switch(a.addClass("xds-CalendarPanel-task"),r){case-1:case 4:a.addClass("xds-CalendarPanel-overdue");break;case 6:case 7:a.addClass("xds-CalendarPanel-overdue");case 2:case 5:case 8:a.addClass("xds-CalendarPanel-completed")}2===r&&a.data.completeddate&&a.data.duedate&&a.data.completeddate>a.data.duedate&&a.addClass("xds-CalendarPanel-overdue"),a.addClass("xds-CalendarPanel-tstatus-"+r)}else a.addClass("xds-CalendarPanel-event"),a.data.allday&&a.addClass("xds-CalendarPanel-allday");a.data.type&&a.addClass("xds-CalendarPanel-type-"+a.data.type+(a.data.subtype?"_"+a.data.subtype:"")),d.openXDS===n&&d.nid>0&&d.nid!==a.node.nid&&13!==d.reltype&&(d.openXDS=d.editXDS=e.getCalendarItemXDS(a,d),null!==d.openXDS&&(0==(3&(t=l(a,[d.nid,d.pnid],d.openXDS)))?d.openXDS=d.editXDS=null:(0==(2&t)||d.openPath)&&(d.editXDS=null))),a[d.openXDS?"removeClass":"addClass"]("xds-CalendarItem-unopenable"),a[d.editXDS?"removeClass":"addClass"]("xds-CalendarItem-readonly"),a[d.editXDS?"addClass":"removeClass"]("xds-CalendarItem-editable"),d.attendance_code?(l(a,[d.nid],d.nid<0?"attendanceLB":"StaffAttendance")&&a.addClass("xds-CalendarPanel-cantakeattendance"),function(e){var a=e.rnode.render||e.rnode||{},t=o(a),n=a.attendance_code||!1;!0===t?e.addClass("attstate_active"):-1===t&&e.addClass("attstate_complete");!1!==n?e.addClass("attstate_"+(n||0)):e.addClass("attstate_nil")}(a)):d.take_attendance&&(l(a,[d.pnid],"ExcuseFormAttendance")&&a.addClass("xds-CalendarPanel-cantakeattendance"),2&d.take_attendance&&a.addClass("attstate_active"),4&d.take_attendance&&a.addClass("attstate_complete")),d.assessmentESubmit&&""+d.assessmentESubmit.button!="0"&&a.addClass("xds-CalendarPanel-hasesubmit"),64&(d.approved||0)&&a.addClass("xds-CalendarPanel-unapproved"),a.data.pnid===a.node.nid&&delete a.data.pname,a.data.nid===a.node.nid&&(delete a.data.name,a.data.location=a.data.roomName,a.data.period=a.data.periodName)}function o(a){var t=new Date,n=e.dateFormat(a.sdate,"obj"),d=e.dateFormat(a.edate,"obj");if(n&&d){if(t<n)return 1;if(n<=t&&t<d)return!0;if(d<=t)return-1}return!1}function u(a,t,d){var r,s,l=a.rnode?"rnode":"node",i=a.get_val("allday",l),o=a[l]["_dateFormat_"+(a.arg("formatType")||t)];return!1===o||(a.arg("dateFormatAllDay")&&i?((r=a[l]["_dateFormat_"+(a.arg("formatType")||t)+"_allday"])===n&&(r=a.arg("dateFormatAllDay")),r&&!1!==r&&(o=r)):a.arg("dateFormatMultiDay")&&((s=a[l]["_dateFormat_"+(a.arg("formatType")||t)+"_multiday_offset"])===n&&(s=a.arg("dateFormatMultiDayOffset")),s&&(s=parseInt(s,10)),s&&(d=new Date(d.getTime())).setDate(d.getDate()+s),e.isSameYear(a.get_val(),d)&&e.isSameYear(a.get_val())||(r=a[l]["_dateFormat_"+(a.arg("formatType")||t)+"_multiday"])===n&&(r=o=a.arg("dateFormatMultiYear")),r||e.isSameDate(a.get_val(),d)||((r=a[l]["_dateFormat_"+(a.arg("formatType")||t)+"_multiday"])===n&&(o=a.arg("dateFormatMultiDay")),r&&!1!==r&&(o=r)))),!1!==o&&(o?a.dateFormat=o:a.arg("dateFormatDefault")&&(a.dateFormat=a.arg("dateFormatDefault")),!0)}function p(e,a){return e&&a?"number"==typeof e?e-a:e.localeCompare(a):e||a?e?-1:1:0}function c(e,a){return p(e.duedate,a.duedate)||p(e.sdate,a.sdate)||p(e.duration,a.duration)||p(e.name,a.name)||p(e.nid,a.nid)||p(e.rid,a.rid)}function f(e){for(var a={},t=0,d=Object.entries(e.xds),r=0;r<d.length;r++){var s=_slicedToArray(d[r],2),l=s[0],i=s[1];"string"==typeof l&&"dateFormat_"===l.substr(0,11)&&(++t,a["_"+l]=i)}return t?a:n}return{types:{attendance_button:function(a){var t=a.rnode.render||a.rnode,n=t.type+"."+t.subtype===e.nt.Document.ExcuseSlip(),d=t.nid<0?"attendanceLB":n?"ExcuseFormAttendance":"StaffAttendance";return!a.rnode.noAttendance&&("StaffAttendance"===d?a.has_read(d)?a.temp.att_nid=a.get_val("nid","data_full"):(d="attendanceLB",a.temp.att_nid=t.nid):a.temp.att_nid=t.nid<0?a.get_val("nid","data_full"):t.nid,!!("attendanceLB"!==d||1&l(a,[a.temp.att_nid],d))&&(!!(2&l(a,[n&&t.pnid?t.pnid:a.temp.att_nid],a.arg("xds")))&&(a.temp.att_xds=d,void a.inherit("button"))))},bubble:function(a){var t=a.rnode.render?"render-":"",n=""+a.get_val(t+"pnodetype","rnode"),d=[n,a.get_val(t+"pnodesubtype","rnode")].join("."),r=o(a.rnode.render?a.rnode.render:a.rnode);[a.get_val(t+"type","rnode"),a.get_val(t+"subtype","rnode")].join(".")===e.nt.Container.Duty()?a.addClass("xds-CalendarPanel-types-bubble-duty"):[a.get_val("nodetype","rnode"),a.get_val("nodesubtype","rnode")].join(".")===e.nt.Document.TimeTableEntry()?a.addClass("xds-CalendarPanel-types-bubble-schedule"):n===e.nt.Group()?a.addClass("xds-CalendarPanel-types-bubble-school"):d===e.nt.Container.Class()?a.addClass("xds-CalendarPanel-types-bubble-class"):n===e.nt.Container()?a.addClass("xds-CalendarPanel-types-bubble-place"):n===e.nt.User()&&a.addClass("xds-CalendarPanel-types-bubble-personal"),!0===r?(a.arg("icon","play"),a.arg("fa_class","fas"),a.addClass("xds-CalendarPanel-types-bubble-in_session")):(a.arg("icon","circle"),a.arg("fa_class","fas")),a.inherit("fa.icon")},caldata:function(e){return e.build.calendar_items||(e.build.calendar_items={}),e.runOnce(function(){var a,t,n,d,r=e.path.split("-").slice(1,-1).reverse(),s=e.build.calendar_items,l=e.data;if(l){for(l=e.data_full;r.length;)l=l[d=r.pop()];for(var i=Object.entries(l),o=0;o<i.length;o++){var u=_slicedToArray(i[o],2),p=u[0],c=u[1];if(a=c.nid,n=0,"string"==typeof(t=c.rid)&&(2===(t=t.split(".")).length&&(n=parseInt(t[1],10)),t=parseInt(t[0],10)),d=s[a])for(var f=Object.values(d),y=0;y<f.length;y++){var g=f[y];if(g.rid===t&&(g.ndx||0)===n){l[p]=g;break}}}}}),!1},caldate:function(e){e.data||(e.data=r(e))},calendar_panel:function(e){e.build.calendar_items={},e.inherit("container")},calitem:function(e){i(e),e.tag("div")},callist:function(){function a(e,a){return{nodetype:6,nodesubtype:11,btype:e,btime:a}}return function(t){var d,r,s,l,i,o,u,p,f,y,g,m=0,_=0,h=-1,b=0,v=null,x=null,C=null,D=t.arg("noAttendance")||!1,P=!1,S=[];for(t.tag("ul"),i=["timetable","events","due"],s=[[[],0],[[],0],[[],0],[[],0]],d=0;d<i.length;d++)if((o=t.arg("data"+i[d]))?u=t.data_full[o]:t.data.data&&(u=t.data.data[i[d]]),u){for(r in P=!0,i[d]=u,i[d])i[d].hasOwnProperty(r)&&(s[d][0].push(i[d][r]),++m);u&&!o&&delete t.data.data[i[d]],s[d][0].sort(c)}if(!P)return!1;for(t.data||(t.data={}),t.data.entry=[],t.data.data&&delete t.data.data,t.arg("includedaybounds")&&(p=t.data_full.daystart,f=t.data_full.dayend),l=["sdate","sdate","duedate"];b<m;)if(null===v){for(C=null,_=!1,d=0;d<s.length;d++)s[d][1]>=s[d][0].length||(g=(y=s[d][0][s[d][1]])[l[d]],(null===C||g<C||1===d&&g===C&&(1===y.freebusy||3===y.freebusy||4===y.freebusy))&&((v={render:s[d][0][s[d][1]]}).nodetype=v.render.nodetype,v.nodesubtype=v.render.nodesubtype,v.nid=v.render.nid,v.rid=v.render.rid,v.pnid=v.render.pnid,h=d,C=v.render.periodIndex&&p?p:v.render[l[d]]));p&&C&&e.dateFormat(C,"HH:MM:ss")>=p&&(t.data.entry.push(a(-1,p)),p=n),f&&C&&e.dateFormat(C,"HH:MM:ss")>=f&&(t.data.entry.push(a(1,f)),f=n),0===h?_=1:1===h&&(v.render.freebusy=v.render.freebusy||1),++s[h][1],++b,_?(v.subentry={render:[]},S=[]):(D&&(v.render.noAttendance=!0),t.data.entry.push(v),v=null)}else{for(x=null,C=null,d=2===_?0:1;d<s.length;d++)s[d][1]<s[d][0].length&&s[d][0][s[d][1]][l[d]]<v.render.edate&&(null===C||s[d][0][s[d][1]][l[d]]<C)&&(h=d,C=(x=s[d][0][s[d][1]])[l[d]]);if(null===x){for(0===v.subentry.render.length&&delete v.subentry,t.data.entry.push(v),S.reverse();S.length;)t.data.entry.push(S.pop());v=S=null}else{if(++s[h][1],++b,0===d){if(x.render.edate<v.render.edate)continue;s[0][0][--s[0][1]].sdate=s[0][0][--s[0][1]].sdate=v.render.edate}else{if(x.pnid!==v.render.nid){(x={render:x,nodetype:x.nodetype,nodesubtype:x.nodesubtype,nid:x.nid,rid:x.rid,pnid:x.pnid}).render.noAttendance=!0,2===h?t.data.entry.push(x):S.push(x),x=null;continue}x.subitem=1}v.subentry.render.push(x)}}if(null!==v){for(0===v.subentry.render.length&&delete v.subentry,D&&(v.render.noAttendance=!0),t.data.entry.push(v),S.reverse();S.length;)t.data.entry.push(S.pop());v=S=x=null}f&&t.data.entry.push(a(1,f)),t.data.entry.length?t.hasData=!0:delete t.data.entry}}(),callistentry:function(e){var a,t,n=e.arg("render");n&&(a=(e.build.calendar_renderers||{})[n]),a&&((t=e.ctag||e.xds.ctag)&&((a=$.extend(!1,{},a)).ttag=t),e.addChild(a,e.arg("insertIndex"))),e.tag(e.ttag||e.xds.ttag||"nowrap")},date:function(e){var a=e.arg("formatType");if(a&&!u(e,a,r(e)))return!1;e.inherit(e.arg("ttag")||"text")},date_jumper:function(){function a(a,t,d){var r={target_date:e.dateFormat(a.getDate(),"obj")};a.arg("month")!==n&&(r.month=a.arg("month")),a.event("CalendarPanel.events.navigate",r)}return function(t){var n=r(t);t.data=e.dateFormat(n,"yyyy-mm-dd"),e.isSameYear(n)||(t.dateFormatInput=t.arg("dateFormatOtherYear")||"ddd, mmm d, yyyy",t.addClass("xds-datepicker-otheryear")),t.on("changeDate",a),t.inherit("f_ttdate.ttdatejumper")}}(),edate:function(e){if(!u(e,"end",e.get_val("start","siblings")))return!1;e.inherit(e.arg("ttag")||"nowrap")},entry:function(a){var t=a.rnode.render||a.rnode;[""+t.type,""+t.subtype].join(".")===e.nt.Container.Class()?t.label=t.class:t.title?t.label=t.title:t.label=t.name,a.map({label:t.label}),t.openXDS?(a.on("click","CalendarPanel.events.open"),a.attr("aria-label",a.arg("titleOpenLabel"))):a.attr("aria-label",a.arg("titleViewLabel")),a.inherit("hoverIntent")},eventlist:function(e){var a,t,n;if((n=e.arg("data"))?t=e.data_full[n]:e.data&&(t=e.data.data),!t)return!1;if(e.hasData=!0,t.sort(c),e.data||(e.data={}),a=f(e))for(var d=Object.entries(t),r=0;r<d.length;r++){var s=_slicedToArray(d[r],2),l=s[0],i=s[1];t[l]=$.extend(!1,i,a)}e.data.render=t,n||delete e.data.data,e.inherit("CalendarPanel.types.callistentry")},eventOpenLink:function(a){var t=0,d=a.rnode.render||a.rnode;d.openXDS===n&&(d.openXDS=e.getCalendarItemXDS(a,d)),d.openXDS&&(t=a.get_perm(d.openXDS)),2&t&&!d.openPath?(a.xds.title=a.arg("lang_editText"),a.showTitle=!0):1&t?(a.xds.title=a.arg("lang_viewText"),a.showTitle=!0):(a.data=!1,a.sparse=!1,a.showTitle=!1,d.openXDS=null),a.inherit(a.arg("ttype")||"link")},hover:(d=function(e){e.map(e.data),e.inherit("hoverbox")},d.buildEventHoverData=function(e){return e},d.showEndDate=function(a){var t=a.get_val("start","siblings"),n=a.data,d=a.rnode.render?a.rnode.render.nodetype:a.rnode.nodetype,r=a.rnode.render?a.rnode.render.nodesubtype:a.rnode.nodesubtype;return!(!n||6!==d||2!==r&&13!==r||a.get_val("allday","rnode")&&e.isSameDate(n,t))},d),render:function(e){var a,t=e.data;e.rnode&&e.rnode.ndx&&(e.path+="."+e.rnode.ndx),(a=t["objtype_"+e.data.nodesubtype])&&(t=$.extend(!0,t,a)),(a=t["origobjtype_"+e.data.subtype])&&(t=$.extend(!0,t,a)),e.map(t),i(e),e.tag(e.arg("ttag")||"li")},registercaldata:function(e){var a=e.build.calendar_items,t=e.data;return a||(a=e.build.calendar_items={}),t&&(a[t.nid]||(a[t.nid]=[]),a[t.nid].push(t)),!1},registerscheddata:function(e){var a=e.data;return a&&(a.daystart&&(!e.data_full.daystart||a.daystart<e.data_full.daystart)&&(e.data_full.daystart=a.daystart),a.dayend&&(!e.data_full.dayend||a.dayend>e.data_full.dayend)&&(e.data_full.dayend=a.dayend)),!1},registerrenderer:function(e){return e.build.calendar_renderers||(e.build.calendar_renderers={}),e.build.calendar_renderers[e.arg("renderdefine")]=e.xds._children[0],!1},scheduleList:function(e){var a,t,d,r=0,s={},l=[];if((d=e.arg("data"))?t=e.data_full[d]:e.data&&(t=e.data.data),!t)return!1;e.hasData=!0;for(var i=Object.values(t),o=0;o<i.length;o++){var u=i[o];if(u.schedule)if(u.primary||a&&u.schedule===a)if(a){if(u.schedule!==a)return!1}else a=u.schedule,r=1,l=[];else{if(a)continue;if(s[u.schedule]===n&&(s[u.schedule]=!0,++r>1))continue}u.name&&l.push(u.name)}if(r>1)return!1;e.set(l.join(", ")),e.inherit("div")},sdate:function(e){var a=e.rnode||e.node;if(a.render&&(a.render.periodIndex||0)>0){if(e.data=a.render.periodName,e.addClass("xds-indexed-period"),!e.data)return!1}else if(!u(e,"start",r(e)))return!1;e.inherit(e.arg("ttag")||"nowrap")},sublist:function(e){var a,t;if(e.xds.ttag="ul",e.ctag="li",e.data&&(t=e.data.render)&&(a=f(e)))for(var n=Object.entries(t),d=0;d<n.length;d++){var r=_slicedToArray(n[d],2),s=r[0],l=r[1];t[s]=$.extend(!1,l,a)}e.inherit("CalendarPanel.types.callistentry")},task_status_checkbox:function(){function a(e,a,t){var n=a.parents(".CalendarPanelItem"),d=n.find(".xds-task_status_checkbox").hasClass("xds-f_checkbox-checked")?1:2;a[1===d?"removeClass":"addClass"]("xds-f_checkbox-checked"),n[1===d?"removeClass":"addClass"]("xds-CalendarPanel-completed"),a[0].elements.taskstatus.value=d,e.e.stopPropagation(),e.trigger("submit")}function t(e,a,t){e.event("ajax_post")}function n(e,a,t){e.fresh=!0,e.event("stale_form"),e.fresh=!1}return function(d){var r;if([0,3,4,5,6].includes(d.data||0))return d.showTitle=d.sparse,!1;r=e.html.div("",["xds-f_checkbox-ui",e.css.formSprite]),d.arg("title")&&(r+=d.arg("title")),d.showTitle=!1,d.displayVal=r,2===d.data&&d.addClass("xds-f_checkbox-checked"),d.posttag('<input type="hidden" name="rid" value="'+d.rnode.rid+'"/><input type="hidden" name="taskstatus" value="'+(2===d.data?1:2)+'"/>'),d.addClass("xds-task_status_checkbox"),d.on("click",a),d.on("submit",t),d.on("ajax_post",n),d.inherit("form")}}},events:{attendance:function(a,t,n){var d=a.rnode.render||a.rnode;(d.attendance_code||d.take_attendance)&&a.newEvent("lightbox",{nid:a.temp.att_nid,xds:a.temp.att_xds,targetDate:e.dateFormat(d.sdate,"iso")})},navigate:function(a,t,n){var d,l=a.parents("."+s(a).path),i=a.get_arg("target_date")||r(a),o=a.get_arg("date_offset")||0,u=a.get_arg("month_offset")||0;l.length&&(i.setDate(i.getDate()+o),i.setMonth(i.getMonth()+u),d={month:a.get_arg("month"),target:"#"+l[0].id,targetDate:new Date(i)},a.get_setting("inline_cal")&&(d.inline_cal=!0),function(a,t,n){var d,l=s(a),i=e.dateFormat(n.targetDate||r(a),"yyyymmdd"),o=e.dateFormat(new Date,"yyyymmdd"),u={},p=n.target||a.get_arg("target");p||(p=a.parents("#"+a.build.uuid).parent()),l["pnid-rid-nid"]||(d=a.get_setting("url").match(/.*\/node.json(\/\d+)+[?#]/))&&(l["pnid-rid-nid"]=d.slice(1).join("").substr(1)),u.nid=l["pnid-rid-nid"],a.get_arg("month")?(u.xds=a.xds_full.xds_month||"CalendarPanelMonth",i!==o&&(u.targetDate=i)):i===o?u.xds=a.xds_full.xds_core||"CalendarPanel":(u.xds=a.xds_full.xds_nav||"CalendarPanelNav",u.targetDate=i),n.inline_cal&&(u.inline_cal=n.inline_cal),$(p).xdo.newEvent?$(p).xdo.newEvent("loadxds",u):a.newEvent("loadPage",u)}(a,0,d))},open:function(a,t,n){e.get_func("CalendarPanel.utils.open_item")(a,a.rnode.render||a.rnode,a.e)},punchthru_dismiss:function(e,a,t){}},utils:{get_date:function(e){return r(e)},get_event_type:function(e){var a=e.rnode.render?"render-":"";return[""+e.get_val(a+"type","rnode"),""+e.get_val(a+"subtype","rnode")].join(".")},is_lightbox:function(e){return e.build.target.hasClass("lightbox")},open_item:function(a,t,n){var d;t.openXDS&&(n.stopPropagation(),t.openPath?a.newEvent("loadPage",{href:t.openPath}):t.openPage?(d=[],t.pnid&&d.push("pn="+t.pnid),t.pnodetype&&t.pnodesubtype&&d.push("pt="+t.pnodetype+"."+t.pnodesubtype),t.pname&&d.push("pnm="+encodeURIComponent(t.pname)),d.push("occurrence="+e.dateFormat(t.sdate,"iso")),a.newEvent("loadPage",{href:e.tpl(e.gbl[d.length?"loadPageParam":"loadPage"],{xds:t.openXDS,nid:t.nid,params:d.join("&")})})):(d={xds:t.openXDS,nid:[t.pnid,t.rid,t.nid].join("/"),noPath:!0,data:{pnid:t.pnid,pname:t.pname,pnodetype:t.pnodetype,pnodesubtype:t.pnodesubtype,occurrence:t.sdate}},a.state.top().get("nodetype")+"."+a.state.top().get("nodesubtype")===e.nt.User.Student()?d.snid=a.state.top().get("nid"):""+e.gbl.user.nodesubtype===e.nt.User.Student(!0)&&(d.snid=e.gbl.user.nid),a.newEvent("lightbox",d)))},pending_classes:function(a,t,d,r){var s=n;d=a.get_val(d||"timetabletodaydata","data_this")||{},r=e.dateFormat(r||new Date,"yyyymmddHHMMss");for(var l=Object.values(d),i=0;i<l.length;i++){var o=l[i];(r<=e.dateFormat(o.sdate,"yyyymmddHHMMss")||r<e.dateFormat(o.edate,"yyyymmddHHMMss"))&&(!s||o.sdate<s)&&(s=o.sdate)}return s||!1}}}});

/* resources: CalendarPanelMonth */

"use strict";cf.resource("CalendarPanelMonth",function(e,t,a,d){var n=864e5;return{types:{calendar:function(t){var a,d,s,r,o,l,g,i,u,f,m,c,D,h=6,y={},v={},_={};if(d=(a=e.get_func("CalendarPanel.utils.get_date")(t)).getTime(),t.data_full.targetDate=a,s=function(e,t){var a,d,s,r,o=e.getFullYear(),l=e.getMonth(),g=new Date(o,l,1),i=new Date(o,l+1,0);return a=(t+6)%7,(d=new Date(g.getTime())).getDay()!=t&&d.setDate(1-(d.getDay()+7-t)%7),(s=new Date(i.getTime())).getDay()!=a&&s.setDate(s.getDate()+(a+7-s.getDay())%7),r=Math.round((s.getTime()-d.getTime())/(7*n)),{start:d,end:s,monthstart:g,monthend:i,weeks:r,days:7*r}}(a,h=(h+1)%7),t.data_full.body||(t.data_full.body={}),u={header:{date:a},weekdays:{day:[]},rows:{week:[]}},(c=t.data.caldata||{}).schedules)for(g in c.schedules)(o=e.dateFormat(c.schedules[g].date,"obj"))&&(y[o.getTime()]=!0);if(c.overdue)for(g in c.overdue)_[c.overdue[g].nid]=!0;if(c.active)for(g in c.active)_[c.active[g].nid]=!0;if(c.common)for(g in c.common)if((D=c.common[g]).taskstatus)_[D.nid]||(v[e.dateFormat(D.completeddate?D.completeddate:D.duedate,"obj").setHours(0,0,0,0)]=!0);else for((o=e.dateFormat(D.sdate,"obj"))<s.start&&(o=new Date(s.start)),o.setHours(0,0,0,0),(l=e.dateFormat(D.edate,"obj"))>s.end&&(l=new Date(s.end));o<l;)v[o.getTime()]=!0,o.setDate(o.getDate()+1);for(g=7,o=h,i=e.dateFormat.getWeekdays(!0);g-- >0;)u.weekdays.day.push(i[o]),o=(o+1)%7;for(o=s.start,r=a.getMonth(),f=u.rows.week,g=0,m=[];o<=s.end;)l=o.getTime(),m.push({fullDate:new Date(l),date:o.getDate(),havesched:y[l],haveitems:v[l],istarget:l===d,foreign:o.getMonth()!==r}),7==++g&&(f.push({cells:m}),m=[],g=0),o.setDate(o.getDate()+1);t.map({month_data:u})}},events:{navMonth:function(t,a,d){var n,s,r,o=t.get_arg("offset")||1,l=t.data_full.targetDate;for((s=l.getDate())>28&&l.setDate(28),l.setMonth(l.getMonth()+o),r=l.getMonth();s!==l.getDate()&&r===l.getMonth();)l.setDate(l.getDate()+1);r!==l.getMonth()&&l.setDate(0),n={target:t.parents(".xds-cont"),targetDate:e.dateFormat(l,"yyyymmdd"),xds:t.xds_full.id,nid:t.get_setting("nid")},t.get_setting("inline_cal")&&(n.inline_cal=!0),t.newEvent("loadxds",n)},selectDate:function(t,a,d){var n=$(t.e.delegateTarget),s=n.xdo.data,r=s.fullDate;r.getTime()!==t.data_full.targetDate.getTime()&&(s.foreign||(t.data_full.targetDate=r)),n.parents(".xds-CalendarPanelMonth-types-calendar").find(".xds-curdate").removeClass("xds-curdate"),n.addClass("xds-curdate"),t.build.cal_date=r,t.event("loadxds",{xds:t.xds_full.xds_nav||"CalendarPanelNav",targetDate:e.dateFormat(r,"yyyymmdd"),inline_cal:!0})}}}});

/* resources: CalendarPunchThru */

"use strict";cf.resource("CalendarPunchThru",function(t){return{form:function(){function e(e,n,a){t.get_func("CalendarPanel.utils.is_lightbox")(e)?e.temp.updated=!0:e.trigger("newCalendarContentAvailable")}function n(e,n,a){var l=e.dom().parents(".lightbox-"+e.xds_full.id),d=e.caller();if(d){var o=d.dom().offset();0===e.dom().parents(".xl-3").length&&("CalendarPunchThru"!==e.xds_full.id&&l.addClass("lightbox-CalendarPunchThru"),l.addClass("xds-lightbox-accessoryclose"),$(document.body).removeClass("xds-hasLightbox"),l.parents(".lightbox-cont").addClass("lightbox-disablecont"),l.css("position","absolute"),l.css("top",o.top+40+"px"),o.left>document.body.clientWidth/2?l.css("right",document.body.clientWidth-(o.left+48)+"px"):l.css("left",o.left-224+"px"))}else t.get("lightbox").close()}function a(t,e,a){t.on(window,"resize",function(t){n(t)});var l=t.dom().parents(".lightbox-"+t.xds_full.id).parents("body").find(".xds-lightbox-background");0===t.dom().parents(".xl-3").length&&l.on("click.punchthru",function(e){l.off("click.punchthru"),e.stopPropagation(),e.preventDefault(),t.event("lightbox.close"),t.temp.updated&&caller.trigger("newCalendarContentAvailable",{})}),n(t)}return function(t){$(document.body).removeClass("xds-hasLightbox"),t.arg("editable",t.has_write(t.xds_full.xds_edit||"CalendarPunchThruEdit")),t.inherit("form"),t.on("xds-punchthru-updated",e),t.ready(a)}}(),select:function(t,e,n){t.event("post",{nid:t.get_val("nid","node"),xds:t.xds_full.xds_edit||"CalendarPunchThruEdit",data:{pt_nid:t.get_val("nid","rnode"),cal_pt:t.val()}})},is_empty:function(t){return!(""+t.state.get("nodetype")=="1"||t.state.get("groups")||t.state.get("classes")||t.state.get("places"))},unload:function(t,e,n){var a=t.caller();a&&t.temp.updated&&a.trigger("newCalendarContentAvailable",{})}}});

/* resources: ClassList */

"use strict";cf.resource("ClassList",function(e,t,n,r){return{create_evidence:function(){return function(e,t,n){var i=e.get_arg("xdsEvidence");e.newEvent("lightbox.open",{xds:e.get_arg("xds")||"EvidenceGatherStudentSelector",nid:e.nid("rnode")}).then(function(t){return function(e,t){var n=arguments.length>2&&arguments[2]!==r?arguments[2]:"EvidenceGatherPhoto";if(t&&t.altprops&&t.altprops.selectedStudents){var i=Object.keys(t.altprops.selectedStudents).join(",");e.newEvent("lightbox",{xds:n,nid:e.nid("rnode"),class:e.nid("rnode"),model:e.state.get("modelNid"),command:"create",noPath:!0,student:i})}}(e,t,i)})}}(),EvidenceShowIf:function(e){var t=(e.state.get("classRights")||{}).xdii||{};return!e.state.get("evidenceHide")&&1&(t.EvidenceGatherPhoto||0)},link:function(t){t.inherit("loadPage",{xds:e.get_func("ClassList.open_xds")(t)})},LinkIf:function(t){var n,i,a,s=e.get_func("currentUserIsType"),d=t.data_full.nid===e.gbl.user.nid?t.state.get("role"):r,o=t.state.get("classRights"),l=(o||{}).xdii||{};if(o)return 1&(l.CourseSafe||l.CourseSafeMobile||l.Course||l.CourseMobile||0);if(d||(s(t,[e.nt.User.SysAdmin(!0),e.nt.User.Root(!0)])?d="SysAdmin":s(t,[e.nt.User.Parent(!0)])?d="Parent":s(t,[e.nt.User.Student(!0)])?d="Student":e.get_func("currentUserIsStaffType")(t)&&(t.arg("isChild")?d="Parent":((n=t.state.get("teacherNid"))&&!e.is_arr(n)&&(n=[n]),(i=t.state.get("assistantNid"))&&!e.is_arr(i)&&(i=[i]),d=13!==t.get_val("reltype")&&(t.data_full.nid===e.gbl.user.nid||n&&e.in_array(e.gbl.user.nid,n)>-1||t.state.get("isowner"))?"Class Owner":13!==t.get_val("reltype")&&(t.data_full.nid===e.gbl.user.nid||n&&e.in_array(e.gbl.user.nid,i)>-1)?"TeacherAssistant":e.get_func("currentUserIsAdminType")(t)?"Administrator":t.has_role("Guidance")?"Guidance":"Teacher"))),"Parent"===d){if(!(a=t.state.get("parentsAllowed"))||"0"===a)return!1}else if("Student"===d){if(1===(a=t.state.get("studentLock"))||13===t.get_val("reltype"))return!1}else if("SysAdmin"!==d&&"Class Owner"!==d&&"TeacherAssistant"!==d&&"Administrator"!==d&&"Guidance"!==d&&t.data_full.nid!==e.gbl.user.nid)return!1;return!0},open_attendance_details:function(t,n,r){var i=t.build.target.xdo,a={command:"open_node",noPath:!0,nidSource:"node"};if(i&&""+e.user.nodesubtype===e.nt.User.Parent(!0)){for(;i.build.target.xdo&&i!==i.build.target.xdo;)i=i.build.target.xdo;a.nid=i.rnode?[i.data_full.nid,i.rnode.rid,i.rnode.nid].join("/"):i.data_full.nid,a.classNid=t.rnode.nid}else a.nid=[t.rnode.nid,t.rnode.rid,t.get_val("nid","node")].join("/");t.event("lightbox",a)},open_class:function(t,n,r){var i;e.get_func("ClassList.LinkIf")(t)||(t.e.stopPropagation(),t.e.preventDefault(),i={message:1===t.get_val("studentLock")?t.arg("titleNoStudents"):t.arg("titleNoOpen")},t.arg("titleNoOpenAltAction")&&(i.message+="  "+t.arg("titleNoOpenAltAction")),t.newEvent("alert",i))},open_evidence:function(e,t,n){e.newEvent("loadPage",{xds:e.get_arg("xds")||"Evidence",nid:e.nid("rnode")})},open_report_card:function(t,n,r){e.links.openUrl(e.tpl(e.gbl.printPage,{xds:t.get_arg("xds")||t.arg("xds"),nid:t.get_arg("nid")||t.arg("nid")||t.cnid()}),"reportcard")},open_xds:function(t){var n=e.get_func("currentUserIsType"),r="Parent"===t.state.get("role")||n(t,[e.nt.User.Parent(!0)]),i=t.get_arg("xdsSafe")||t.arg("xdsSafe");return 1===t.state.get("defaultView")?t.arg("xdsContentView"):i&&r&&3===t.state.get("parentsAllowed")?i:t.get_arg("xds")||t.arg("xds")||"Course"},pluraliser:function(e){""+e.get_val()=="1"&&(e.displayVal=e.arg("title1"),e.showTitle=!1),e.inherit("sepList.item")},report_card_button:function(e){e.arg("mode",e.state.get("arperiod")>1?"red":"blue"),e.inherit("button")},ReportCardShowIf:function(e){return 1&(((e.state.get("classRights")||{}).xdii||{}).ReportCard||0)},SectionTitleShowIf:function(e,t){var n=e.rnode.reltype;return"string"==typeof t&&(t=JSON.parse(t)),!!t.includes(n)&&((0===e.get_index()||e.xds._lastreltype!==n)&&(e.xds._lastreltype=n,!0))}}});

/* resources: CourseFeed */

"use strict";cf.resource("CourseFeed",function(e,t,n,a){return{feed:function(t){var n,a,o=t.get_val("item");if(e.is_obj(o))for(a in o)n=o[a],e.get_nt(n)!==e.nt.Document.Assignment()&&e.get_nt(n)!==e.nt.Message.LessonSummary()||(n.thread=n.nid);t.inherit("feed"),t.ready(function(e){e._pageHidden>0&&e.temp&&e.temp._infiniteScrollFunc&&e.temp._infiniteScrollFunc()})},showif:function(t){if(t.data._nt===e.nt.Message.LessonSummary()&&t.data._parsedDate){var n=new Date;return t.root_xdo()._pageHidden=(t.root_xdo()._pageHidden||0)+1,t.data._parsedDate.getTime()<=n.getTime()}return t.data.state!=a&&3==t.data.state?(t.root_xdo()._pageHidden=(t.root_xdo()._pageHidden||0)+1,!1):(t.root_xdo()._pageEmitted=(t.root_xdo()._pageEmitted||0)+1,!0)}}});

/* resources: FeedItemComponent */

"use strict";cf.resource("FeedItemComponent",function(e,t,n){var a="itembody-content-bodycontent-fileWrapper-files",r={has_attachments:function(e){return void 0!==e.get_val(a)},showifs:{pin:function(e){var t=e.state.get("pin")||e.get_val("pin");return!(1&t)},edit:function(t){return t.get_val("createid")==e.user.nid&&(t.nt()==e.nt.Message.FeedReply()||t.nt()==e.nt.Message.Message())},libraryadd:function(e){return!(2&(e.state.get("pin")||e.get_val("pin")))&&r.has_attachments(e)},libraryremove:function(e){return 2&(e.state.get("pin")||e.get_val("pin"))&&r.has_attachments(e)},deleteFullThread:function(e){return e.get_val("_threadlen")>1&&e.get_val("_threadhead")},deleteThreadOnlyItem:function(e){return 1==e.get_val("_threadlen")||!e.get_val("_threadhead")}},itembody:function(e){var t=e.state.get("itembody")||e.data;e.data=t,e.set_val(t)},component:function(t){if(t.attr("role","article"),t.data){t.data&&t.data.itembody&&t.data.itembody.content&&!t.data.itembody.content instanceof DataRow&&(t.data.itembody.content=new DataRow(t.data.itembody.content)),t.get_val("_threadlastitem"),t.get_setting("targetNid")&&t.nid()==t.get_setting("targetNid")&&!t.get_setting("isolateTarget")&&t.addClass("xdl-search-resultItem"),t.has_write(t.arg("xdsReply"))&&t.state.set("xdsReply",t.arg("xdsReply"));var n=t.state.get("updatedContents");t.state.setnx("updatedContents",void 0),n&&(t.state.set("itembody",n.itembody),t.state.set("version",(t.state.get("version")||0)+1));var a=e.clone(t.xds.fields.actions.fields);t.state.set("actions",a),t.get_val("_threadlastitem")&&t.map({userpic:e.gbl.user.profpic}),t.inherit("feeds.feedItem");t.on("xds-pinned xds-unpinned",function(e){var t=e.get_arg("pin");e.state.set("pin",t.to,!0)}),t.on("deleted",function(e){e.dom().safeRemove()})}else t.exitBlank()},contents:function(e){},actions:function(e){var t=e.state.get("actions");for(var n in e.removeChildren(),t)t[n].topLevel&&e.addChild({xds:t[n]})},actionsMenu:function(e){var t=e.state.get("actions");e.state.get("pin");for(var n in e.removeChildren(),t)t[n].topLevel||e.addChild({xds:t[n]});e.inherit("dd.glyph")},edit:function(t){e.get_func("lightbox.open")(t).then(function(){t.trigger("edited")})},doreply:function(t){var n=t.state.get("xdsReply")||t.get_arg("xds")||t.arg("xds"),a={xdsr:t.global("xdsReplyResponse"),xds:n},r=!1;if((t.get_arg("nodetype")||t.arg("nodetype"))&&(a.nodetype=t.get_arg("nodetype")||t.arg("nodetype")),e.layout.isPhone()?(e.extend(a,{nid:t.get_val("nid","node"),command:"create",threadid:t.get_val("thread")||t.nid(),thread:t.get_val("thread")||t.nid(),replyto:t.nid(),replytouser:t.get_val("createid"),noPath:!0}),r="lightbox.open"):(a.parentSelector=t.get_arg("parentSelector")||t.arg("parentSelector")||".xds-FeedItemComponent-component",a.loadTarget=t.get_arg("loadTarget")||t.arg("loadTarget")||"*loaderForm",r="doreply"),r){var d=t.newEvent(r,a);d&&d.then&&d.then(function(n){if(!n.altprops||!n.altprops.isCancel){var a=t.get_arg("parentSelector")||t.arg("parentSelector")||".xds-FeedItemComponent-component",r=t.parents(a).parent().find(".xds-threadid-"+t.get_val("thread")),d=e.get_obj(r[r.length-1]),o=e.extend({append:"after",noCont:!0,appendOnlySubPath:"item"},n.altprops);d.newEvent("feeds.insertReply",o)}}).catch(function(e){})}},reply:function(e){e.attr("role","button"),e.sparse=!0;var t=e.state.get("xdsReply");t&&e.has_write(t)?(e.inherit("fa.icon"),e.xds.events||e.on("click",r.doreply)):e.exitBlank()},copylink:function(t){var n=t.get_val("nid","node"),a=t.get_val("thread")||t.nid(),r=(t.get_val("thread")||t.nid(),t.nid()),d=e.gbl.server+"/p/PermaLink/"+n+"?thread="+a+"&targetNid="+r;e.clipboard.copyText(d)}};return r});

/* resources: LightboxComponent */

"use strict";cf.resource("LightboxComponent",function(e,t,i){return{types:{lightbox:function(t){var i={title:!0,eatClicks:!1,closeOnAjaxPost:!0,noForm:!1},s="lightbox";if(e.layout.isPhone()&&(s="page"),t.get_setting("target")==e.gbl.page&&t.addSubClass("fullpage"),t.xds.fields.config){if(t.xds.fields.config){for(var o in i)void 0!==t.xds.fields.config[o]&&(i[o]=t.xds.fields.config[o]);t.removeChild("config")}i.eatClicks&&t.on("click",function(e){e.stopPropagation()}),i.closeOnPost&&t.on("ajax_post",e.get_func("lightbox.close"))}i.mode=s,t.state.set("lightboxConfig",i);var n="form";i.noForm&&(n=!1),"page"==s?(n&&t.arg("inherit",n),t.inherit("responsive.layout.page")):n&&t.inherit(n)},actions:function(t){if(t.xds.fields){var i={destructive:!1,cancel:!1,constructive:!1,auxiliary:!1},s=function(e){return e.title||e.icon&&e.fields};for(var o in i)t.xds.fields[o]&&s(t.xds.fields[o])&&(i[o]=e.clone(t.xds.fields[o]));t.state.set("lightboxActions",i)}t.inherit("sys")},title:function(t){var i=t.state.get("lightboxActions"),s=t.state.get("lightboxConfig")||{};if(t.xds.title=s.title||e.lang("Title"),i&&"page"==s.mode&&i.constructive){var o={};(o=i.constructive.fields&&Object.keys(i.constructive.fields).length>1?{type:"dd.bars",id:"right",sparse:!0,title:i.constructive.title,icon:i.constructive.icon,fields:Object.values(e.clone(i.constructive.fields))}:{type:"fa.icon"}).sparse=1,t.addChild(o)}t.inherit("lightbox.title")},body:function(e){"page"==(e.state.get("lightboxConfig")||{}).mode&&e.inherit("responsive.layout.body")},footer:function(t){var i=t.state.get("lightboxActions"),s=t.state.get("lightboxConfig");if("page"!=s.mode||i&&(i.destructive||i.auxiliary)){if(i&&(i.destructive||i.auxiliary)||i.constructive){if(i.destructive){var o={xds:{id:"left",type:"confirmDelete",title:i.destructive.title||e.lang("Delete"),confirm:i.destructive.confirm||e.lang("Are you sure?"),mode:"button"}};i.destructive.events&&(o.events=i.destructive.events),t.addChild(o,0)}var n=function(e,t){if(e.fields&&Object.keys(e.fields).length>1){var i=Object.values(e.fields).reverse(),s=[];for(var o in i)i[o].type="button",o<i.length-1&&(i[o].mode="grey"),s.push(i[o]);return s}var n={type:"button",id:t,title:e.title};return e.events&&(n.events=e.events),e.showif&&(n.showif=e.showif),[n]},l=[];if(i.auxiliary)for(var r=n(i.auxiliary,"auxiliary"),c=0;c<r.length;c++)l.push(r[c]);if((i.cancel||i.destructive)&&l.push({xds:{type:"cancel",title:i.cancel&&i.cancel.title||e.lang("Cancel")}}),i.constructive&&"page"!=s.mode)for(var a=n(i.constructive,"constructive"),d=0;d<a.length;d++)l.push(a[d]);l.length>0&&t.addChild({id:"right",sparse:!0,fields:l},1),t.inherit("lightbox.footer")}}else t.exitBlank()}}}});

/* resources: MasterMobileControls */

"use strict";cf.resource("MasterMobileControls",function(e,t,r){var i={anid:function(){return e.storage("StudentActive-nid")},cacheActiveUser:function(t){e.storage("ActiveUser-nid",t.nid()),t.arg("inherit")&&t.inherit(t.arg("inherit"))},activateStudentMode:function(t){t.has_role("Parent of Child")&&t.nt()==e.nt.User.Student()&&e.storage("StudentActive-nid",t.nid()),t.arg("inherit")&&t.inherit(t.arg("inherit"))},resetMode:function(t){e.storage("StudentActive-nid",e.user.nid),e.storage("ActiveUser-nid",e.user.nid),e.history.clear(),t.inherit("responsive.layout.page")},key:function(e){return e.get_arg("returnKey")?e.get_arg("returnKey"):i.anid()+(e.get_arg("key")||e.arg("key")||e.xds.id)},setActiveHistory:function(t,r){t.arg("clearActive")&&e.storage("StudentActive-nid",e.user.nid);var n=i.key(t),a=e.history.stacks[n];if(t.arg("scrollTo")&&{scrollTo:t.arg("scrollTo")},t.arg("clearActive")||!a||!a.stack.length||e.history.active&&e.history.active.id===n){if((a=new e.history.XDSHistory(n)).stack=[],a.index=-1,a.activate(),!r||!r.noEvent){var s={xds:t.arg("xds")||t.get_arg("xds"),nid:t.arg("nid")||i.anid()};t.arg("scrollTo")&&(s.scrollTo=t.arg("scrollTo")),t.event("loadPage",s)}}else a.activate(),a.loadLatest()},tabBar:function(r){if(!e.layout.isPhone())return r.exit(!0);if(e.browser.sticky){r.pretag('<div class="xds-MasterMobileControls-init-spacer"></div>');r.on(t,"xds-loaded",function(){var e=r.find(".xds-MasterMobileControls-init-spacer",1);e.css("min-height",n-r.target("xds-cont").height()+e.height()+"px")})}else r.addStyle({position:"fixed",width:"100%"}),r.pretag('<div style="height:46px;"></div>');var n=e.window.height();i.anid()&&"default"!==e.history.active.id||e.storage("StudentActive-nid",e.user.nid),r.state.set("ActiveUser",e.storage("ActiveUser-nid")),r.state.set("StudentActive",i.anid())},studentSelector:function(t){var r,n=[e.clone(e.user)].concat(e.obj_to_arr(e.user.children));if(e.localStorage("userSelected")||(e.localStorage("userSelected",!0),t.ready("trigger",{eventName:"click"})),null!=e.user.nid){for(var a in e.user.children)if(null==e.user.children[a].nid){r=e.user.children[a];break}}else r=e.user;for(var s in r)t.state.set("StudentActive-"+s,r[s]);n=n.map(function(e){return e.value=e.nid,e.nid}),t.state.set("children",n),t.inherit("dd.menu",{noArrow:!0}),t.addClass("xds-fa-iconTab"),t.on("xds-picker-picked",function(t){var r=t.get_arg("xdo").rnode.nid,n=i.anid();e.storage("StudentActiveHistory-"+n,e.history.active.id),e.storage("StudentActive-nid",r);var a=e.storage("StudentActiveHistory-"+r);t.event("MasterMobileControls.setActiveHistory",{key:"classes",xds:r==e.gbl.uid?t.arg("xdsParentHome"):t.arg("xdsSelectStudent"),returnKey:a})})},tab:function(t){t.renderNoPerm=!0;var r=i.key(t);if(t.arg("renderNid")&&t.arg("renderNid")!=i.anid())return!1;(e.history.active.id===r||"default"===e.history.active.id&&t.arg("default"))&&(t.arg("selected",!0),"default"===e.history.active.id&&i.setActiveHistory(t,{noEvent:!0})),t.on("click",i.setActiveHistory),t.inherit("fa.iconTab")},tabs:{classes:function(t){return!!(t.has_role("Student")||t.has_role("Teacher")||t.has_role("Parent")&&i.anid()!=e.gbl.uid)},activity:function(t){return!(!t.has_role("Parent")||i.anid()==e.gbl.uid)},messages:function(t){return!(i.anid()!=e.gbl.uid)},groups:function(e){return!!i.tabs.messages(e)}}};return i});

/* resources: MobileHome */

"use strict";cf.resource("MobileHome",function(e,t,n){return{open_report_card:function(t,n,r){e.links.openUrl(e.tpl(e.gbl.printPage,{xds:t.get_arg("xds")||t.arg("xds"),nid:t.get_arg("nid")||t.arg("nid")||t.cnid()}),"reportcard")},plan_absence:function(t,n,r){t.event("lightbox",{data:{fixeddate:!0,targetdate:e.dateFormat(new Date,"iso")}})}}});

/* resources: UserSidebar */

"use strict";cf.resource("UserSidebar",function(r,e,c){return{}});

/* resources: VideoGoLiveButton */

"use strict";cf.resource("VideoGoLiveButton",function(e){return{button:function(e){var t=e.state.get("videoenabled"),o=e.state.get("videomeetingactive");return t&&(o||!e.arg("noStart")&&(e.has_role("Class Owner")||e.has_role("Moderator")))?void 0:e.exitBlank()}}});

/* resources: pinned */

"use strict";cf.resource("pinned",function(e,i,t,a){return{wrapper:function(i){var t=!1,n=i.arg("lightboxxds");try{var l=i.data.rich.filecatcher.file.file.ContentType;if("image"===l.substr(0,5)&&!~l.indexOf("photoshop")&&!~l.indexOf("tiff"))t=!1,n="fileView";else{t=!0;var o="file";try{o=i.xds.fields.rich.fields.filecatcher.fields.file.field,n=i.xds.fields.rich.fields.filecatcher.fields.file.xds}catch(e){}o==a&&(o="file");var s=e.gbl.dl+i.cnid()+"?field="+o+"&attach=1"+(n?"&xds="+n:"");i.pretag('<a target="_blank" href="'+s+'">').inherit("boxModel").postclosetag("</a>")}}catch(e){t=!1}t||(i.inherit("boxModel").on("click",function(i){i.args={xds:n},e.get_func("lightbox")(i),i.e.stopPropagation()}),i.attr("aria-label",e.lang("View Item")))},expando:function(e){e.inherit("boxModel").ready(function(e){e.find(".xds-boxModel-inner").height()>e.dom().height()&&e.target("sibling:expand").show()}).on("expand",function(e){e.dom().css("max-height","initial"),e.target("sibling:expand").hide(),e.target("sibling:collapse").show()}).on("collapse",function(e){e.dom().css("max-height",""),e.target("sibling:expand").show(),e.target("sibling:collapse").hide()})}}});
});
