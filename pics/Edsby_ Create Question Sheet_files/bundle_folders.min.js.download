/**
 * Version: baf4caef7b0dd7471dd76c3dc5db25e58fe75145ce31e12f9f3da02c27b2a1fb
 * Bundle: folders
 **/

cf.resources.confirm('bundle_folders', function() {

/* modules: dynamicrenderers */

"use strict";cf.module("dynamicrenderers",function(e,t,a,n){var r={},d=function(t,a){var n=!1;for(var d in r[t]||(r[t]={}),t=r[t])if(t[d].id==a.id){t[d]=a,n=d;break}return n||(t[n=e.get("guid").rfc4122()]=a),n},i=function(e,t,a){r[e]||(r[e]={}),e=r[e];var n={priority:0,renderer:!1};for(var d in e){var i={priority:e[d].matches(a,e[d]),renderer:e[d]};t&&e[d].classifier!=t&&(i.priority=-1),i.priority&&i.priority>n.priority&&(n=i)}return n.renderer},o=function(e,t){var a={};for(var n in r[e]||(r[e]={}),a=r[e])t.removeChild([e,"dnya",a[n].id].join("_").replace(/\./g,"_"))},c=function(t,a,r,d){var i=arguments.length>4&&arguments[4]!==n&&arguments[4],o={xds:e.clone(d.xds)};d.data===a.data&&(i=!0),i?d.data instanceof DataRow?o.data=d.data:o.data=e.clone(d.data):o.data=d.data,o.xds.id=[t,"dnya",r].join("_").replace(/\./g,"_"),o.xds.include&&o.xds.included&&(o.xds.proxyCSS=o.xds.include,o.xds.include=o.xds.included.replace("..","")),a.addChild(o)},s={matchers:{viewer:function(t,a){var n=!1;return t.data.file&&(n=e.get("files").registry.get(t.data.file.ContentType,t.data.file.ContentName)),!!n&&18},nodedefs:function(t,a){var n=e.get("nodedefs");return!!n.lookup(t,t.arg("lookup"))&&2},complex:function(e,t){return e.nt()==t.matchdef.nodetype?3:t.matchdef.nodetypes&&t.matchdef.nodetypes[e.nt()]?t.matchdef.nodetypes[e.nt()]||2:!(!t.matchdef.nodetypes||!Array.isArray(t.matchdef.nodetypes)||!t.matchdef.nodetypes.includes(e.nt())&&!t.matchdef.nodetypes.includes(parseFloat(e.nt())))&&3},folder:function(t){return(t.nt()==e.nt.Container.Folder()||t.nt()==e.nt.Container.UserFolder()||t.nt()==e.nt.Container.PersonalFolder())&&3},album:function(t){return!!(t.data&&t.data.files&&t.data.files.length>0&&t.nt()!=e.nt.Container.Folder()&&t.nt()!=e.nt.Container.UserFolder())&&19},bookmark:function(t){return t.nt()==e.nt.Document.Bookmark()?5:!(!t.data||!t.data.files||1!=t.data.files.length||[t.data.files[0].Content.nodetype,t.data.files[0].Content.nodesubtype].join(".")!=e.nt.Document.Bookmark())&&4},image:function(e){return e.data&&e.data.files&&1==e.data.files.length&&e.data.files[0].Content&&new RegExp("image/.*").test(e.data.files[0].Content.ContentType)?20:!!(e.data&&e.data.file&&e.data.file&&new RegExp("image/.*").test(e.data.file.ContentType))&&20},cartridge:function(t){return(t.nt()==e.nt.Container.PersonalCourse()||t.nt()==e.nt.File.Cartridge()||t.nt()==e.nt.Document.LearningObject())&&5},always:function(e){return 1}},register:function(t){var a=t.arg("scope")||t.get_arg("scope")||"global",n=t.arg("classifier")||"default";if(t.exitBlank(),t.xds.fields.renderer){var r,i=t.arg("matchtype")||t.get_arg("matchtype"),o=function(e){return e.arg("matchtype")||e.get_arg("matchtype")?(e.arg("matchtype")||e.get_arg("matchtype"))==i?1:-1:1},c={id:t.name(),xds:e.clone(t.xds.fields.renderer),classifier:n};t.arg("lookup")&&(c.lookup=t.get_arg("lookup")||t.arg("lookup")),(r=t.arg("match")||t.get_arg("match"))&&("string"==typeof r?o=e.get_func(t.arg("match")||t.get_arg("match")):(o=s.matchers.complex,c.matchdef=r)),c.matches||(c.matches=o);var l=d(a,c);return t.state.set(["dynamicrenderers-scope",a,n].join("-"),e.get("guid").rfc4122()),l}},draw:function(e){var t=e.arg("scope")||e.get_arg("scope")||"global",a=e.state.parent().get("dynamicclassifier",e)||e.arg("defaultClassifier")||"default";o(t,e),e.state.get(["dynamicrenderers-scope",t,a].join("-"),e);var n;(n=i(t,a,e))?c(t,e,n.id,{xds:n.xds,data:e.data}):e.exitBlank()},purgeScope:function(e){delete r[e]}};return s});

/* modules: folders */

"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}cf.module("folders",function(e,t,n,o){var r={types:{tip:function(t){t.nt()==e.nt.Container.PersonalFolder()&&(t.data=e.lang("My Personal Folder")),t.arg("splitPath")&&(t.data=t.data.split("/").pop()),t.attr("title",t.data).tag("div")},global:function(e){e.global(e.arg("varName"),e.arg("varData"))},compoundIcon:function(t){t.data.fileThumbnail?(t.arg("width",34).arg("height",34).arg("nocnid",!0).arg("fileName",!1),t.data=t.data.fileThumbnail,t.inherit("files.smartThumb").on("click",function(e){e.newEvent("lightbox.open",{xds:"itemPreviewLB",stopPropagation:1,noPath:!0,currentContainer:e.global("currentContainer")})})):e.get("folders.isFolderType")(t)?t.inherit("folders.folderIcon"):(t.arg("fileName",!1),t.inherit("files.typeIcon"))},folderIcon:function(e){e.addClass("xds-folders-folderIcon-medium")},smartIcon:function(e){e.inherit("files.typeIcon")},size:function(t){t.arg("detailed")&&(t.tooltip=e.tpl(e.lang("{{size}} bytes"),{size:t.data}));var n,r,a=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],l=0;for(n=0;n<a.length&&!(Math.pow(1024,n)>t.data);n++)l=n;_typeof(t.data)===o||!1===t.data?t.data="-":(r=Math.round(t.data/Math.pow(1024,l)*100)/100,t.data=e.tpl("{{rounded}} {{suffix}}",{rounded:""+r,suffix:a[l]}))}},fn:{itemClick:function(e){if(r.fn.isFolderType(e))e.trigger("getNewFolderItems",{newNid:e.nid(),newName:e.get_val("details-name")}),e.global("folderSelection",!1),e.global("selectionObject",!1),e.get_target("*foot-use").hide();else if("folderNavOnly"!=e.global("itemClickMode"))if(e.get_target("*folderItemPreview").length>0){e.global("folderSelection",e.nid());var t={nid:e.nid(),from:e.parent_xdo().nid(),container:e.global("currentFolder"),name:e.get_val("details-name"),nt:e.nt(),xdscopy:"CopyCoursePlanEntry",nodetype:e.get_val("nodetype"),nodesubtype:e.get_val("nodesubtype")};e.data.icon&&e.data.icon.fileThumbnail&&(t.file=e.data.icon.fileThumbnail),e.global("selectionObject",t),e.event("loadxds",{noPath:!0,xds:"itemPreview",target:"*folderItemPreview",currentFolder:e.global("currentFolder")}),e.get_target("*foot-use").show()}else e.trigger("itemSelected",{nid:e.nid(),from:e.parent_xdo().nid(),name:e.get_val("details-name"),nt:e.nt(),xdscopy:"CopyCoursePlanEntry"})},remapNavigationCrumbs:function(t){var n=t.get_arg("newNid"),o=t.get_arg("newName");"PersonalFolder"==o&&(o=e.lang("My Personal Folder"));var r=t.get_val("crumbs");Array.isArray(r)||(r.nid=t.nid(),r=[r]);for(var a=[],l=!1,i=0;i<r.length;i++)if(a.push(r[i]),r[i].nid==n){l=!0;break}l||a.push({nid:n,name:o}),t.map({hanselAndGretel:a}),t.update()},getFolderItems:function(t){var n=t.get_arg("newNid"),r=t.get_arg("newName");n&&(t.map({folderItems:[],loading:!0,noContent:!1}),t.update(),e.ajax({xdo:t,url:{nid:n,xds:t.xds_full.id},callback:function(a){if(a.slices){t.global("currentFolder",n),t.global("currentFolderType",a.slices[0].data.nodetype+"."+a.slices[0].data.nodesubtype);var l=[];a.slices&&a.slices[0].data&&a.slices[0].data.body&&a.slices[0].data.body.list&&a.slices[0].data.body.list.items&&(l=a.slices[0].data.body.list.items),t.map({folderItems:l,loading:!1,noContent:!0}),t.update(),t.trigger("clearPreview"),t.global("currentFolder")===o||t.global("currentFolder")==t.nid()?t.target("*body-schools").show():t.target("*body-schools").hide(),t.target("*crumbContainer").trigger("remapCrumbs",{newNid:n,newName:r})}else if(a.error)try{e.log.debug("folders.getFolderItems[error]: ".concat(JSON.stringify(a.error)))}catch(e){}}}))},checkFilter:function(t){var n={};n[e.nt.Group.School()]={};var o=n[e.nt.Group.School()];o[e.nt.Container.UserFolder()]=!0,o[e.nt.Container.PLC()]=!0,o[e.nt.Container.Conference()]=!0,o[e.nt.Container.Team()]=!0,o[e.nt.Container.Club()]=!0;for(var r=e.lookup("MetaTypes","Organizations").val(),a=0;a<r.length;a++)n[r[a]]=n[e.nt.Group.School()];var l=t.get_setting("folderFilter"),i={};if(i[e.nt.Document.TimeTableEntry()]=!1,i[e.nt.Document.Room()]=!1,i[e.nt.Document.Any()]=!1,l&&(i[e.nt.Container.PersonalFolder()]=!0,i[e.nt.Container.UserFolder()]=!0,i[l]=!0),n[t.global("currentFolderType")||t.nt("node")])return!!n[t.global("currentFolderType")||t.nt("node")][t.nt()];if("allcontainers"==t.global("mode")&&(t.nt("rnode",!0)==e.nt.Container()||t.nt("rnode",!0)==e.nt.Group())){i[e.nt.Container.PersonalFolder()]=!0,i[e.nt.Container.UserFolder()]=!0,i[e.nt.Container.Class()]=!0,i[e.nt.Container.PLC()]=!0,i[e.nt.Container.Course()]=!0,i[e.nt.Container.Conference()]=!0,i[e.nt.Container.Team()]=!0,i[e.nt.Container.Club()]=!0;for(var d=0;d<r.length;d++)i[r[d]]=!0;return i[t.nt()]||!1}return!!i[t.nt()]||(i[t.nt()]||!1)},isFolderType:function(t){var n={};return n[e.nt.Container.PersonalFolder()]=!0,n[e.nt.Container.UserFolder()]=!0,"allcontainers"==t.global("mode")&&(n[e.nt.Container.Class()]=!0,n[e.nt.Container.PLC()]=!0,n[e.nt.Container.Course()]=!0,n[e.nt.Container.Conference()]=!0,n[e.nt.Container.Team()]=!0,n[e.nt.Container.Club()]=!0,n[e.nt.Group.School()]=!0,n[e.nt.Group.District()]=!0),n[t.nt()]||!1}}};return r});

/* resources: FolderCore */

"use strict";cf.resource("FolderCore",function(e,t,a){var n={getSelection:function(t){var a=t.state.top().get("selections",t),n=[];for(var r in a)a.hasOwnProperty(r)&&n.push(e.get_obj("#"+a[r].ref.path));return n},clearSelection:function(e){e.state.top().set("selections",[])},selectAll:function(e){for(var t=e.target(".xds-selectionmanager-selectable"),a=0;a<t.length;a++)$(t[a]).xdo.state.set("selected",1)},allSelectionsCopiable:function(t){var a=t.state.top().get("selections",t);for(var n in a)if(a[n].nt==e.nt.Container.UserFolder()||a[n].nt==e.nt.Container.Folder())return!1;return!0},massageItemData:function(e){},showif:{itemShowIf:function(e){return!1!==e.data._doShowThisItem&&("3.16"==e.nt()?e.get_val("rfrom")!=e.nid():0!=e.nt().indexOf("3.")&&0!=e.nt().indexOf("2."))},crumbs:function(t){return!e.lookup("MetaTypes","Organizations").val().concat(e.nt.Container.PersonalFolder()).includes(t.nt())}},bindifs:{libraryViewer:function(t){return 4.3!=t.nt()&&(t.nt()!==e.nt.Document.Rubric()&&t.nt()!==e.nt.Document.OnlineTest()&&t.nt()!==e.nt.Document.Lesson()&&t.nt()!==e.nt.Message.LessonSummary()&&t.nt()!==e.nt.Document.Assignment()&&t.nt()!==e.nt.Document.LTILink()&&("3.16"!==t.nt()&&!(t.data&&t.data.grid&&t.data.grid.legacyFile&&t.data.grid.legacyFile.file&&"application/pdf"===t.data.grid.legacyFile.file.ContentType)))}},utils:{prefilterPasteBuffer:function(t,a){var n,r={},o={};for(n in a)a.hasOwnProperty(n)&&(r[n]=a[n]);r.nodes=[];var i={};for(i[e.nt.Container.UserFolder()]=!0,i[e.nt.Document.Unit()]=!0,i[e.nt.Document.OnlineTestQuestion()]=!0,[e.nt.Container.Course(),e.nt.Container.Class()].indexOf(t.nt())>=0&&(i[e.nt.Document.OnlineTest()]=!0,i[e.nt.Container.PersonalCourse()]=!0,i[e.nt.Document.Rubric()]=!0,i[e.nt.Document.LTILink()]=!0),n=0;n<a.nodes.length;n++)i[a.nodes[n].nt]?a.nodes[n].nt===e.nt.Document.Unit()&&(o[a.nodes[n].nid.split("/").pop()]=a.nodes[n].name):r.nodes.push(a.nodes[n]);for(n=0;n<r.nodes.length;n++)r.nodes[n].thread&&o[""+r.nodes[n].thread]&&(r.nodes[n]._extraData={unitName:o[""+r.nodes[n].thread]});return r},checkPermissions:function(t){return t.has_write()&&t.has_delete()&&t.nt()!=e.nt.Document.Assignment()}},removeItem:function(t){var a,r,o,i=!1;if(t.global("xdsPin")){for(var s=t.arg("rids")||[t.rid()],l=[],d=0;d<s.length;d++)l.push((a=t.global("folderNid"),r=s[d],o=t.global("xdsPin"),e.get("cfnp").putfield(t,{nid:a,rid:r,xds:o,field:e.constant.np.Library(),value:0})));i=Promise.all(l)}else i=e.get("cfnp").delete(!1,{nids:t.arg("nids")||[t.cnid()],xds:t.global("xdsDelete")});return i.then(function(e){for(var a=t.state.get("currentFolderData"),r={items:[]},o=0;o<a.length;o++)a[o].nid!=t.nid()&&r.items.push(a[o]);t.state.set("currentFolderData",r),n.clearSelection(t)})},events:{handleDrop:function(t){var a=t.get_arg("draggable"),r=t.get_arg("modifiers")||{},o=e.get("cfnp").link(!1,{to:t.nid(),nid:a.nid(),xds:t.global("xdsMove"),fields:{pin:e.constant.np.Library()}});return r.shift||o.then(function(e){return n.removeItem(a)}),o.catch(function(t){e.dialog(t.errorstr)}),o},manageTags:function(t){for(var a=n.getSelection(t),r=[],o=[],i=function(e){var t=e;"string"==typeof e&&(t=e.split(","));var a={};for(var n in t)""!=t[n]&&(a[t[n]]=!0);return a},s=0;s<a.length;s++){o.push(a[s].nid());var l=i(a[s].get_val("tags"));if(0==s)r=l;else for(var d in r)l[d]||delete r[d]}return r=Object.keys(r),t.args={nid:t.nid(),tags:r,nids:o,xds:t.arg("xds")},e.get("lightbox").open(t)},validateCommands:function(t,a,n){var r=t.global("selection")||{},o=0;for(var i in r)r.hasOwnProperty(i)&&1==r[i]&&o++;o>0?t.target("*copyCommand").show():t.target("*copyCommand").hide();var s=e.get_func("copier.pasteAvailable")(t);t.state.global().forget("copier-pasteAvailable"),s?t.target("*pasteCommand").show():t.target("*pasteCommand").hide()},itemToggled:function(e,t,a){var n=e.global("selection")||{};n[e.nid()]=e.get_arg("newValue"),0==n[e.nid()]&&delete n[e.nid()],e.global("selection",n),e.trigger("xds-Folder-selectionChanged")},toggleGearMode:function(e){e.target("*body").toggleClass("xds-gearMode-enabled"),e.trigger("xds-Folder-selectionChanged")},checkIfDragged:function(e){e.dom().hasClass("preventNextClick")&&(e.dom().removeClass("preventNextClick"),e.stopPropagation(),e.preventDefault())},setFolderLayout:function(e){for(var t=["table","grid"],a=$(".FolderCore-body"),n=0;n<t.length;n++)a.removeClass("xds-FolderCore-layout-"+t[n]);a.addClass("xds-FolderCore-layout-"+e.args.layout),localStorage["Folder-config-layout"]=e.args.layout},sortChanged:function(e,t,a){if(e.get_arg("item")){var n=e.get_arg("item").id;e.trigger("sortChanged",{sort:n})}},filterChanged:function(t,a,n){var r=!1;if(t.get_arg("item")){var o=t.get_arg("item").value;if(r={newFilter:o},o.indexOf(":")>=0){var i=o.split(":");r.newFilter=i[0],r.filterKey=i[1]}}else t.get_arg("type")&&"search"==t.get_arg("type")&&(r={newFilter:"search",filterKey:t.val()},e.storage("folder-searchValue",t.val()||-1));r&&t.trigger("filterChanged",r)},createItem:function(t,a,n){var r=t.get_arg("item");if(r){var o,i=r.id,s=r.command||"create",l=!1,d=!1;switch(i){case"folder":o="createFolder";break;case"album":o="FolderNewAlbum";break;default:r&&((o=r.xds)||(o="bookPlanEntry"),(l=r.nst)||(l=3),(d=r.nt)||(d=6))}var g={command:s,xds:o,suppressUnitPicker:!0,suppressCrossPoster:!0,enforcePinBit:2};t.global("classNID")&&(g.classNid=t.global("classNID")),l&&(g.nodesubtype=l),d&&(g.nodetype=d);var c="lightbox.open";r&&r.mode&&"page"==r.mode?(g.target=e.gbl.page,c="loadxds"):r&&r.mode&&"body"==r.mode&&(g.target="*body",c="loadxds"),t.newEvent(c,g)}},moveItem:function(t,a,n){var r=t.get_arg("draggable"),o=r.nid(),i=t.nid(),s={_dest:o,pin:2};e.post({url:{command:"link",nid:i,xds:"Folder"},data:s,success:function(){r.nt()!=e.nt.Document.Assignment()&&t.global("noUsePinBits")?e.post({url:"/core/delete/"+r.cnid()+"?xds=folderDeleteItem",success:function(){t.dom().trigger("newLibraryContentAvailable")}}):r.find(".libraryItem-unpin").trigger("click")}})}},types:{itemSource:function(t){var a=t.state.get("itemSourceData")||t.data;if(a.item){var n={};for(var r in a.item){var o=a.item[r];"3"==o.nodetype&&o.rfrom==o.nid?e.settings.dev:([o.nodetype,o.nodesubtype].join(".")!=e.nt.File.Upload()&&[o.nodetype,o.nodesubtype].join(".")!=e.nt.File.Attachment()||(o.file&&o.file.ContentSize&&(o.size=o.file.ContentSize),o.file&&o.file.ContentName&&(o.name=o.file.ContentName)),n[r]=o)}a.item=n}var i=function(n){var r=[];for(var o in a.item)r.push(a.item[o]);n&&n.filterGlobal&&(r=e.filter(n.filterGlobal,r)),n&&n.filter&&(r=e.filter(n.filter,r)),t.state.top().set("currentFolderData",{items:r})};i(t.state.top().get("facetSettings")),t.state.top().watch("facetSettings",i),t.exitBlank()},itemRender:function(t){var a=t.state.get("currentFolderData"),r=t.state.get("classifier")||"icon",o=t.state.get("itemSort"),i={row:{"flex-direction":"column","flex-wrap":"nowrap"},icon:{"flex-direction":"row","flex-wrap":"wrap"}};if(t.state.set("dynamicclassifier",r),t.addStyles(i[r]||i.icon),a&&a.items){var s=!1;o&&(s=e.sort({sortBy:o.sortfield,sortDirection:o.ascending?"forward":"backwards"},a.items)),t.data={item:s}}else t.exitBlank();t.state.watch("classifier",function(e){n._activeMode=e,t.dom().css(i[e]||i.icon),t.state.set("dynamicclassifier",e)})},folder:function(a){a.inherit("responsive.layout.page").global("copierEnforcePinBit",2).global("copierSkipDateUpdate",!0).global("copierPreFilterPasteBuffer",n.utils.prefilterPasteBuffer),a.state.set("itemSort",{sortfield:"name",ascending:!0}),a.global("folderNid",a.nid()),a.global("xdsUploader",a.arg("xdsUploader")),a.global("xdsDelete",a.arg("xdsDelete")),a.global("xdsMove",a.arg("xdsMove")),a.global("xdsFolder",a.arg("xdsFolder")),a.global("xdsRename",a.arg("xdsRename")),a.global("xdsTag",a.arg("xdsTag")),a.global("lookupMenu",a.arg("lookupMenu")),a.arg("xdsPin")&&a.global("xdsPin",a.arg("xdsPin")),a.state.set("classifier",n._activeMode||"icon"),a.state.set("hiddenColumns",a.arg("hiddenColumns")||!1),a.on("xds-smarttoolbar-action-complete",function(e){e.state.data.selections&&e.state.set("selections",JSON.parse(JSON.stringify(e.state.data.selections)))}),a.on("getUpdate",function(n){a.temp._refreshDebounceTimer||(a.temp._refreshDebounceTimer=t.setTimeout(function(){a.arg("xds",a.xds.included&&a.xds.included!=".."+a.xds.include?a.xds.included.replace("..",""):a.xds.id).arg("noCache",!0),e.get("cfnp").get(a).then(function(e){var t=e.slices[0].data.body.table.itemSource;a.trigger("dataReceived",{items:t})}),delete a.temp._refreshDebounceTimer},50))}).on("dataReceived",function(e){e.state.set("itemSourceData",e.get_arg("items"))})},global:function(e){e.global(e.name(),e.data||e.arg("dataSet")),e.inherit("sys")},searchInput:function(t){e.storage("folder-searchValue")&&(t.data=e.storage("folder-searchValue")),t.inherit("f_str")},itemTable:function(a){var n,r="date";a.get_setting("sortByField")&&(r=a.get_setting("sortByField")),n={sortBy:r},"date"==r&&(n.sortBy="date",n.sortType="date"),a.data.items=e.sort(n,a.data.items);var o=a.get_setting("folderFilterType")||"all";if(a.data.items){var i=!0;"search"==o&&(i=!1);for(var s=0;s<a.data.items.length;s++){var l=a.data.items[s];switch(l._doShowThisItem=!0,o){case"folders":l._doShowThisItem="3"==l.nodetype&&"16"==l.nodesubtype;break;case"files":l._doShowThisItem=l.item.left&&l.item.left.files&&l.item.left.files.files&&1==l.item.left.files.files.length||l.item.left.legacyFile;break;case"albums":l._doShowThisItem=!(l.item.left.files&&(l.item.left.files.files&&0==l.item.left.files.files.length||!l.item.left.files.files)||!l.item.left.files||"3"==l.nodetype&&"3"==l.nodesubtype);break;case"tag":var d=a.get_setting("filterKey");if(d){var g=!1;if(l.item&&l.item.right&&l.item.right.footer&&l.item.right.footer.tags)for(var c=l.item.right.footer.tags.split(","),f=0;f<c.length&&!g;f++)c[f]==d&&(g=!0);l._doShowThisItem=g}else l._doShowThisItem=!0;break;default:l._doShowThisItem=i}}if("search"==o){var u=a.data.items;u=e.filter(a.get_setting("filterKey"),u);for(var m=0;m<u.length;m++)u[m]._doShowThisItem=!0}}a.on(t,"sortChanged",function(e,t,a){var n={sortByField:e.get_arg("sort"),tableLayout:$(".FolderCore-body").hasClass("xds-FolderCore-layout-table")};e.event("redraw",n)}).on(t,"filterChanged tagClicked",function(e,t,a){var n={folderFilterType:e.get_arg("newFilter"),tableLayout:$(".FolderCore-body").hasClass("xds-FolderCore-layout-table"),redrawPath:"FolderCore-body"};e.get_arg("filterKey")&&(n.filterKey=e.get_arg("filterKey")),e.event("redraw",n)}).ready(function(){"table"==localStorage["Folder-config-layout"]&&a.set_setting("tableLayout","list"),a.get_setting("tableLayout")?(localStorage["Folder-config-layout"]="table",$(".FolderCore-body").addClass("xds-Folder-layout-table")):localStorage["Folder-config-layout"]="grid"})},tagRegister:function(e){for(var t in n._tags=[],e.data)e.data.hasOwnProperty(t)&&n._tags.push(t);return!1},sortTitle:function(t){t.showTitle=!1;var a=t.arg("sortfield"),n=t.state.top().get("itemSort",t),r={xds:{id:"sort",type:"a",title:t.arg("title"),fields:[]}};n.sortfield==a&&r.xds.fields.push({id:"caret",type:"fa.glyph",icon:n.ascending?"angle-down":"angle-up"}),t.removeChild("sort"),t.addChild(r).on("click",function(t){e.get("FolderCore.changeSort")(t)})}},changeSort:function(e){var t=e.arg("sortfield")||e.get_arg("sortfield"),a=e.state.top().get("itemSort",e),n={sortfield:t,ascending:a.ascending};a.sortfield==t&&(n.ascending=!n.ascending),e.state.top().set("itemSort",n)}};return n});

/* resources: FolderIconBase */

"use strict";cf.resource("FolderIconBase",function(e,a,l,t){return{icon:function(a){e.platform.mobile||(a.arg("droppable")?(a.arg("accepts",".xds-FolderIconBase-icon"),a.arg("inherit","dragdrop.droppable")):a.arg("inherit","dragdrop.draggable")),a.inherit("selectionmanager.selectable")},fileGlyph:function(a){a.data=a.get_val("file"),a.sparse=!0;var l=e.get("files")._utils.getFileGlyph(a),t=e.get("files")._utils.getFileClass(a),i=!1;if("graduation-cap"===l&&a.arg("baseSize")&&a.addStyle("font-size","".concat(Math.floor(.85*a.arg("baseSize")),"px")),"Virus"===a.data.Scan&&(l="fa-exclamation-triangle",a.arg("fa_class","fas"),i="#FFC702"),a.data=!1,a.arg("icon",l||"file"),"fg"===a.arg("mode"))a.arg("fa_class",t||"fal"),i&&a.addStyle("color",i);else{if(t)return a.exitBlank();a.arg("fa_class","fa")}a.inherit("fa.glyph")},glyph:function(a){if(a.data){a.data=!1,a.sparse=!0;var l=e.get("files")._utils.getFileGlyph(a),t=e.get("files")._utils.getFileClass(a);l&&a.arg("icon",l),t&&a.arg("fa_class",t),a.inherit("fa.glyph")}else a.exitBlank()},fn:{openItem:function(a){a.stopPropagation();for(var l=e.lookup(a.global("lookupMenu")||"folderCreateMenu"),t=Object.values(l),i=0;i<t.length;i++){var r=t[i];if(r.params&&r.params.nt&&r.params.nt==a.nt()){a.arg("xds",r.params.xds);var o="lightbox.open";return"page"===r.params.mode&&(o="loadPage"),void a.event(o,{xds:r.params.xds})}}var n=e.get("nodedefs").lookup(a),g=e.get("files"),s=a.get_val("file");if(s&&"Virus"===s.Scan)a.event("virus.warning");else if(n&&n.xdsView&&(a.get_arg("allowLookup")||a.arg("allowLookup")))if(a.has_read(n.xdsView)){var f="lightbox.open";n.mode&&"page"===n.mode&&(f="loadPage"),a.newEvent(f,{xds:n.xdsView})}else e.confirm(e.lang("You do not have permission to view this object"));else if(e.layout.isPhone()&&a.get_val("file")&&g.registry.get(a.get_val("file").ContentType,a.get_val("file").ContentName))a.arg("filesTarget","*file"),a.arg("xds","AlbumLightbox"),a.arg("xdsSingle","AlbumFileViewLB"),g.open_file(a,!1,a.get_val("file"));else if(e.layout.isPhone()&&a.get_val().file&&1===a.get_val().file.length&&a.get_val().file[0].Content&&g.registry.get(a.get_val().file[0].Content.ContentType,a.get_val().file[0].Content.ContentName)){a.arg("filesTarget","*file"),a.arg("xds","AlbumLightbox"),a.arg("xdsSingle","AlbumFileViewLB");var d=a.get_val().file[0].Content;d.nid=a.get_val().file[0].nid,g.open_file(a,!1,d)}else a.arg("loadAlbum",!0),a.arg("containerNid",a.get_val("nid","rnode")),a.arg("xds","AlbumLightbox"),e.get_func("loadLibraryViewer")(a)}}}});

/* resources: FolderManageTags */

"use strict";cf.resource("FolderManageTags",function(t,n,a){var e=t.get("cfnp");return{submit:function(n){var a=n.get_setting("nids");n.arg("nids",a),n.arg("xds","tagItemLightbox");var r=n.target("*tagInput").find("input.xdl-picker-value").val(),i=function(t,n){t=(t||"").split(","),n=(n||"").split(",");for(var a=t.concat(n),e={},r=0;r<a.length;r++)""!=a[r]&&(e[a[r]]=1);return Object.keys(e).join(",")};e.multinode(n).then(function(t){for(var o=[],u=t.slices,g=0;g<a.length;g++){for(var c=!1,s=0;s<u.length;s++)u[s].nid==a[g]&&(c=u[s]);var d=i(r,c.data&&c.data.body&&c.data.body.tagInput||"");n.arg("nid",a[g]),n.arg("postData",{"body-tagInput":d}),o.push(e.put(n))}return Promise.all(o)}).then(function(){t.get_func("lightbox.close")(n)}).catch(function(t){})}}});

/* resources: FolderRowBase */

"use strict";cf.resource("FolderRowBase",function(t,e,a,n){return{types:{row:function(t){t.xds.scopeState=!0,t.inherit("selectionmanager.selectable")},tag:function(t){t.inherit("a").on("click",function(t){var e=$(".xds-facets-buttonFacet ul li[data-val="+t.data+"]");1==e.length&&e.trigger("click"),t.stopPropagation()})}}}});

/* resources: libraryItem */

"use strict";cf.resource("libraryItem",function(r,e,t,c){return{}});
});
