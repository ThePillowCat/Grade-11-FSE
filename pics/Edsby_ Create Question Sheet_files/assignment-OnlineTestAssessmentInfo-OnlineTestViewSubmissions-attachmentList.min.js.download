/*
Copyright CoreFour Inc.
Version: baf4caef7b0dd7471dd76c3dc5db25e58fe75145ce31e12f9f3da02c27b2a1fb
Compiled: 1674919995
*/
cf.resources.confirm("assignment-OnlineTestAssessmentInfo-OnlineTestViewSubmissions-attachmentList", function(){

/*assignment*/
"use strict";cf.resource("assignment",function(t,e,s){var a={assessmentTypeChanged:function(e,s,n){"-4"!=e.data||"-4"==e.val()||t.lookup("assessmentTypes",e.val()).str()||t.constant("assessmentTypes",e.val(),e.val()),e.state.set("type",e.val()),a.updateCalendarBinding(e,s,n)},customTypeInput:function(e){e.inherit("dd.select",{list:a.TypeList()}),e.addValidator({type:function(){return e.val()&&-4!=e.val()},message:t.lang("This is a required field.")})},customUnitInput:function(t){t.data==t.nid()&&(t.data=!1),t.inherit("f_str")},dateValidator:function(e){if(!e.get_xdo("*assdate").val())return e.args.message=e.arg("message")||t.lang("Please select a date"),!1},dd_calendarType:function(t){return t.sparse=!0,1==t.state.get("esubmit")?(t.state.set("caltype",0),t.exitBlank(!0)):a.is_custom_assessment(t)?void t.inherit("dd.select"):t.exitBlank(!0)},defaultGS:function(t){t.data||t.picker.itemLookup("gs_outof")&&(t.data="gs_outof",t.picker.set_val("gs_outof"),t.picker.defaultSet=!0,t.trigger("xds-picker-picked"))},defaultUnit:function(e){var s=e.get_val();if(s==e.nid()&&(s=void 0),s||e.xds.forceCombobox)-4==s&&(e.val(""),e.set_val(""),e.dd.addNew.resolve().trigger("click"));else{var a=e.dd,n=new Date,i=a.choices;if(1===e.dd._nitems)e.val(i[1].value);else{var o,d,r;for(var u in i){var l=(o=i[u]).ref.resolve();r=l.get_val("sdate")?t.parseDate(l.get_val("sdate")):void 0,d=l.get_val("edate")?t.parseDate(l.get_val("edate")):void 0;var f=l.get_val("assessments");for(var c in f){var g=f[c];if(g.adate){var v=new Date(g.adate);(!r||v<r)&&(r=v),(!d||v>d)&&(d=v)}}if(n>=r&&n<=d)return void e.val(o.value)}i[a._nitems-2]?e.val(i[a._nitems-2].value):e.val("")}}},editType:function(e,s,a){var n=e.get_val(),i=e.global("status")||{};a&&a.value!=n?i.formative=!0:i.formative=!1,e.global("status",i),setTimeout(function(){a&&a.value==n&&e.id(1).next().hasClass(t.css.validateMsg)&&e.id(1).next().remove()},1)},f_tearoff:function(t){var e=""+t.state.get("esubmit"),s=t.state.get("student_livedocs");if("1"!==e||!s)return t.exitBlank();t.inherit("dd.select")},f_tearoff_complete:function(t){a.has_tearoff(t,!0)&&(t.set(1),t.on("onload",function(){t.trigger("setFormDirty")}),t.trigger("setFormDirty")),t.inherit("f_hidden")},footer:function(t){"lightbox"===t.build.buildTarget&&t.inherit("lightbox.footer")},form:function(t){t.on("ajax_post","assignment.registerCustom"),t.arg("inForm")||t.inherit("form");var e=t.state.data.summative;if(e=void 0===e?1:parseInt(e),t.state.set("summative",e),!t.state.data.type&&t.get_setting("type")){var s=t.get_setting("type"),n=a.getCalType(t.get_setting("type"));t.state.set("type",s),t.state.set("caltype",n),t.map({caltype:n})}},getCalType:function(e,s){var a=t.lookup("assessmentTypes",e||"2"),n=0;return a&&a.params&&(n=a.params["calendar-type"]||0),2==s?"":1==s?0:n},has_tearoff:function(t,e){var s,a,n=!1,i=!0;a=t.caller()&&["bookPlanEntryReadOnly","assignmentReadOnly"].includes(t.caller().xds_full.id)?t.caller().state.get("files"):t.state.get("files");for(var o=Object.values(a||{}),d=0;d<o.length;d++){var r=o[d];(s=r.tearoff||r.Content&&r.Content.tearoff)&&(n=!0,2!==s&&(i=!1))}return e?n&&i:n},is_custom_assessment:function(t){return-4==(t.state.get("type")||t.get_setting("type"))||isNaN(parseInt(t.state.get("type")||2,10))},pin:function(t){var e=0,s=t.state.get("esubmit"),a=t.state.get("state"),n=t.get_val("caltype","siblings");"3"!=a&&(e|=8,"2"!=s&&-1===n||(e|=132)),t.data=""+e,t.inherit("f_hidden")},prefix:function(s){if(s.data=s.state.get("type")||s.data||s.get_setting("type")||"2",s.data){var a=t.lookup("assessmentTypes",s.data).str();a&&""!==a&&(s.data=a),s.displayVal=s.data+":"}s.on("onload","assignment.prefix_calc_width"),s.on(e,"resize","assignment.prefix_calc_width")},prefix_calc_width:function(t,e,s){t.get_target("*name-title",1).width(t.get_target("*name",1).width()-t.get_target("*prefix",1).outerWidth()-1)},registerCustom:function(e,s){var a=e.state.get("type");a&&(t.lookup("assessmentTypes",a).str()||t.constant("assessmentTypes",a,a))},set_student_livedocs:function(e,s,a){var n;try{n=e.data.student.studentnotes.files.studentfiles.files||[]}catch(t){n=[]}for(var i=Object.values(n),o=0;o<i.length;o++){var d=i[o];if(t.get("files").utils.is_live_doc(d))return void e.state.set("student_livedocs",!0)}t.get("addresources").fn.hasSharedUploads(e.get_xdo("*studentnotes").find(".AddFilesInline").xdo)?e.state.set("student_livedocs",!0):e.state.set("student_livedocs",!1)},status:{},showSubmissionButton:function(t){return!0},TypeList:function(){return(t.get("gradebook")||{}).TypeList()},unitChanged:function(t){t.updatefromdom()},updateCalendarBinding:function(t,e,s){var n=t.state.get("type"),i=t.state.get("esubmit");t.state.set("type",n),t.state.set("caltype",a.getCalType(n,i))},update_tearoff_status:function(t,e,s){t.find(".ESubmitAssignment").xdo.get_xdo("*body-tearoff").update()},individualizeAssessmentType:function(e){e.get_xdo("*studentPicker").state.get("studentPicker").includes("all")?e.state.get("nodesubtype")!==t.nt("Document.Assignment").value[1]?e.state.set("newnodesubtype",t.nt("Document.Assignment").value[1]):e.state.set("newnodesubtype",void 0):e.state.get("nodesubtype")!==t.nt("Document.IndividualAssessment").value[1]?e.state.set("newnodesubtype",t.nt("Document.IndividualAssessment").value[1]):e.state.set("newnodesubtype",void 0)},initializeStudentPicker:function(e){e.inherit("sys"),0==e.val()&&e.state.get("nodesubtype")==t.nt("Document.IndividualAssessment").value[1]&&e.state.set("studentPicker","")}};return a});

/*OnlineTestAssessmentInfo*/
"use strict";cf.resource("OnlineTestAssessmentInfo",function(e,n,s){return{types:{init:function(n){var s=n.get_setting("snid");s||(s=n.caller().nt()==e.nt("User.Student").val()?n.caller().nid():e.user.nid),e.get_resource("OnlineTestViewSubmissions").types.init(n,{snid:s})}}}});

/*OnlineTestViewSubmissions*/
"use strict";cf.resource("OnlineTestViewSubmissions",function(t,s,e){return{types:{init:function(s,e){var n;n=e&&e.snid?e.snid:s.get_setting("snid")||t.links.queryParams().snid;var i,a=s.state.get("onlinetest");for(var r in a){i=a[r].nid;break}s.global("student",n),s.global("onlinetest",i),s.state.set("student",n);var l=s.state.get("completedAttempts");(l=l?l[n]:[])&&(l=l.map(function(t,s){return t.snum=s+1,t})),s.state.set("submissionlist",l)},setClassNid:function(s){var e,n=s.state.get("class");for(var i in n)e=n[i].classNid;e||(e=t.gbl.nid),s.global("classNid",e)}}}});

/*attachmentList*/
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}cf.resource("attachmentList",function(t,e,n){var a={bindifs:{notvirus:function(t){return"Virus"!==t.get_val("Content").Scan}},showifs:{download:function(e){var n=e.parent_xdo();n&&n.state.get("quarantined");var a=e.state.get("quarantined");return!(t.layout.isPhone()||t.platform.touch&&t.layout.isTablet())&&!a}},container:function(e){var n=[],a=e.get_val("init-file"),i=e.get_val("init-files"),o=e.get_val("init-links");if(o)for(var s=Object.values(o),r=0;r<s.length;r++){var l=s[r];l.url&&("string"==typeof l.url?l.Content=JSON.parse(l.url):"object"===_typeof(l.url)&&(l.Content=l.url)),l.Content||(l.Content=Object.assign({},l),l.Content.NID=l.id),n.push(l)}else Array.isArray(i)?n=i:"object"===_typeof(i)&&(n=n.concat(Object.values(i)));if(a&&n.unshift({nid:e.nid(),Content:a}),0===n.length)e.exitBlank();else{var u=[],f=[];u.push({file:f});for(var d=!1,c=0;c<n.length;c++){var g=n[c],p=g,m=!1;if(p.Content?p=p.Content:p.Content=Object.assign({},p),p&&(g.tooltip=p.ContentName),p&&p.ContentType&&["image","video"].includes(p.ContentType.split("/").shift())){var v=p.ContentType.split("/").shift();d!==v&&(m=!0),d=v}else"file"!==d&&(m=!0),d="file";g&&[g.nodetype,g.nodesubtype].join(".")===t.nt.Document.Bookmark()&&(p.viewxds="Embed"),"Embed"===p.viewxds&&(g={bookmark:p},m=!0),m&&(f=[],u.push({file:f})),u[u.length-1].contains=d,f.push(g)}e.data.files=u}},wrapper:function(e){var n=e.state.get("Content")||e.get_val("Content");n&&(e.data||(e.data={}),e.data.Content=n,n.Processing&&t.get("files").monitorFileStatus(e)),e.data&&e.data.break?(e.addSubClass("break"),e.data.file=-1):e.data&&(a.isImage(e)?e.addSubClass("containsimage"):a.isBookmark(e)?e.addSubClass("containsbookmark"):a.isVideo(e)?e.addSubClass("containsvideo"):a.isAudio(e)&&e.addSubClass("containsaudio"))},file:function(t){if(-1!==t.data){var e=t.state.get("Content")||t.get_val("Content");t.state.setnx(e),t.state.setnx("file",e),"Virus"===e.Scan?t.state.setnx("quarantined",!0):e.Scan&&t.state.setnx("scanned",!0),t.data={content:e}}else t.exitBlank()},smartFileName:function(t){},image:function(t){t.inherit("attachmentList.file")},video:function(t){t.inherit("attachmentList.file")},isImage:function(e){var n=e.state.get("Content")||e.get_val("Content")||{},a=n.ContentType,i=t.get("files").registry.get(a,n.ContentName);return!(!a||!i||"image"!==i.name)},isAudio:function(e){var n=e.state.get("Content")||e.get_val("Content")||{},a=n.ContentType,i=n.Processing;return!(!a||!a.startsWith("audio/")||i)&&t.get("media").isPlayable(e)},isVideo:function(e){var n=e.state.get("Content")||e.get_val("Content")||{},a=n.ContentType,i=n.Processing;return!(!a||!a.startsWith("video/")||i)&&t.get("media").isPlayable(e)},isFile:function(t){return!a.isBookmark(t)&&(!a.isImage(t)&&(!a.isAudio(t)&&!a.isVideo(t)))},audio:function(t){t.inherit("attachmentList.file")},isBookmark:function(t){return"object"===_typeof(t.get_val("bookmark"))},shortFileType:function(e){var n=e.get_val().split(".").pop().toUpperCase();e.data=t.tpl(e.arg("displayFormat"),{extension:n})},group:function(t){t.data&&t.data.file&&t.attr("data-children",t.data.file.length),t.get_val("contains")&&t.addSubClass(t.get_val("contains"))}};return a});
});