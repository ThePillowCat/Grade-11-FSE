/**
 * Version: baf4caef7b0dd7471dd76c3dc5db25e58fe75145ce31e12f9f3da02c27b2a1fb
 * Bundle: files
 **/

cf.resources.confirm('bundle_files', function() {

/* modules: albums */

"use strict";cf.module("albums",function(e){var a={_cfg:{loaded:!1},utils:{loadFeed:function(a){if(a.has_read(a.arg("xds"))&&!a.get_setting("noFeed")){try{var t,i;a.caller()&&(i=a.caller().rnode,((t=a.caller().node).files||t.right&&t.right.files||t.filesPrep||t.itembody||t.file)&&(!a.caller().nt(void 0,!0)===e.nt.Container()?(t=a.caller().caller&&a.caller().caller()&&a.caller().caller().node.nid?a.caller().caller().node:a.caller().parent_xdo().parent_xdo().parent_xdo().node,i=a.caller().target("*files").xdo):a.caller().repeat_xdo()&&(i=a.caller().repeat_xdo().rnode,t=a.caller().root_xdo().node))),!t&&e.get("UberPlanner")&&(t=e.get("UberPlanner")._config.t.node,i=e.get("UberPlanner")._config._docNidMap[a.nid()].t),a.nid()!=t.nid&&(a.args.nid=t.nid,e.is_xdo(i)?a.args.thread=i.get_val("thread")||i.nid():a.args.thread=i.thread||i.nid),a.nt()==e.nt.Message.LessonSummary()&&(e.is_xdo(i)?a.args.thread=i.nid():a.args.thread=i.nid),a.caller()&&a.caller().get_val("portfolio")&&(a.args.thread=t.nid,a.args.nid=a.caller().get_val("portfolio")[0].nid)}catch(e){}a.args.thread||a.exitBlank(),e.get_func("loadThread")(a)}else a.exitBlank()}},types:{initGrid:function(e){var a=[];if(e.data.file&&a.push({Content:e.data.file,nid:e.nid()}),e.data.files)for(var t=0;t<e.data.files.length;t++){var i=e.data.files[t];a.push(i)}e.state.set(e.arg("stateKey")||"amalgamatedFiles",a),e.exitBlank()},grid:function(e){var a=e.state.get(e.arg("stateKey")||"amalgamatedFiles");if(0==a.length)e.exitBlank();else{if(e.arg("forceLimit")&&a.length>e.arg("forceLimit")){for(var t=[],i=0;i<e.arg("forceLimit")-1&&i<e.arg("forceLimit");i++)t.push(a[i]);t.push({remainder:"+"+(a.length-e.arg("forceLimit")+1),Content:!1}),a=t}e.data={file:a}}},summary:function(a){var t=a,i={images:0,files:0},l=function(e){if(e&&e.Content&&e.Content.ContentType){var a=e.Content.ContentType;a.indexOf("image")>=0&&!~a.indexOf("photoshop")&&!~a.indexOf("tiff")?i.images=i.images+1:i.files=i.files+1}},n=a.state.get(a.arg("stateKey")||"amalgamatedFiles");if(n&&0!=n.length){for(var r=0;r<n.length;r++)l(n[r]);if(i.images>0||i.files>0){var s=e.lang("{{num}} images"),d=t.arg("verb")||e.lang("uploaded");1==i.images&&(s=e.lang("{{num}} image")),s="<span class='xds-summary-highlight'>"+e.tpl(s,{num:i.images})+"</span>";var g=e.lang("{{num}} files");1==i.files&&(g=e.lang("{{num}} file")),g="<span class='xds-summary-highlight'>"+e.tpl(g,{num:i.files})+"</span>";var o=t.arg("imagesAndFilesTemplate")||e.lang(" {{verb}} {{images}} and {{files}}");0==i.images?o=t.arg("filesOnlyTemplate")||e.lang(" {{verb}} {{files}}"):0==i.files&&(o=t.arg("imagesOnlyTemplate")||e.lang(" {{verb}} {{images}}"));var f=e.tpl(o,{verb:d,images:s,files:g});t.data=f,t.tag("span")}else{var c=t.arg("noUploadsTemplate");if(!c)return!1;t.data=c,t.tag("span")}}else a.exitBlank()},consume:function(e){},gridThumbnail:function(a){var t=!1,i=!1;if(a.data.viewxds)try{var l=JSON.parse(a.data.field);a.data=$.extend(a.data,l)}catch(e){}var n="files.smartThumb",r=a.data,s=a.state.get("viewerBlacklist")||{},d=e.get_func("files.hasViewer")(a),g=d&&!s[d.name];if(a.parent_xdo().data&&a.parent_xdo().data.public&&!r.PublicThumb&&(r.PublicThumb=a.parent_xdo().data.public),1==a.state.get("gridSize")&&a.nt()==e.nt.Document.Bookmark())a.addClass("xds-albums-gridThumbnail-contains-bookmark"),n="wysiwyg.bookmark";else if(1==a.state.get("gridSize")&&g)n="files.viewer";else{1==a.state.get("gridSize")&&a.arg("tag","div");var o=a.state.get("fileThumbnailTweaks");o&&(t=o.width,i=o.square||!1),n="files.smartThumb"}var f=a.state.get("Content")||a.data,c=e.get("files").isProcessing(a,f);if(a.removeChild("file"),a.removeChild("guide"),c)a.inherit("files.processing");else{if(f.Processing&&e.settings.fileprocessors){var h=a.state.get("fileThumbnailTweaks");h&&(t=h.width,i=h.square||!1),n="files.smartThumb"}a.data={thumb:!0},a.removeChild("thumb");var m={id:"thumb",type:n,_styles:[{styles:{"max-width":"100%","align-items":"center",display:"flex","max-height":"100%",height:"100%"}}],events:a.xds.events,viewerOverrideArgs:{tag:"img"}};t&&(m.targetWidth=t,a.state.set("targetWidth",t)),i&&(m.squareImage=!0,m.viewerOverrideArgs.squareImage=!0),a.addChild({xds:m,data:r},0)}},repeatCounter:function(a){var t,i=a.arg("subtract")||0,l=a.arg("target"),n=0;if(0==l.indexOf("sibling:"))(t=a.siblings[l.split(":")[1]])&&(n=t.length);else if(0==l.indexOf("this:")){l=l.split(":")[1].split("-"),t=a.data_full;for(var r=1;r<l.length&&t;r++)t=t[l[r]];t&&t.length?n=t.length:t&&Object.keys(t).length>0&&(n=Object.keys(t).length)}return!(n-i<=0)&&(a.data=n-i,a.tag("a"),a.arg("displayFormat")&&(a.data=e.tpl(a.arg("displayFormat"),{data:a.data})),!0)},album:function(t){if(t.data&&t.data.content){var i=t.data.content.files,l=t.data.content.legacyFile,n=function(e){var a=!1;e.e.target===window?a=e.find(".AlbumFileView"):(e.e.target.className.indexOf("AlbumFileView")>=0||!e.e.target.className)&&(a=e.e.target),a&&$(a).css("height","calc(var(--vh, 1vh) * 100)")};i&&!Array.isArray(i)&&(i=Object.values(i)),a._cfg.nFiles=0,i&&(a._cfg.nFiles=a._cfg.nFiles+i.length),l&&(i||(i=[]),l.nid=t.nid(),i.unshift(l),a._cfg.nFiles=a._cfg.nFiles+1),t.inherit("block").on("album-next",function(e){for(var t=a._cfg.loaded,l=-1,n=0;n<i.length;n++)if(i[n].nid==t){l=n+1;break}var r=e.find(".AlbumLightbox-main-content-files");r.length>l&&l>=0&&(a._cfg.selectedIndex=l,$(r[l]).trigger("click"))}).on("album-previous",function(e){for(var t=a._cfg.loaded,l=-1,n=0;n<i.length;n++)if(i[n].nid==t){l=n-1;break}var r=e.find(".AlbumLightbox-main-content-files");r.length>l&&l>=0&&(a._cfg.selectedIndex=l,$(r[l]).trigger("click"))}).on("xds-loaded",n).on("xds-close",function(e){$(".xds-album-loadtarget").html("")}).preclosetag("<div class='xds-album-loadtarget'></div>").ready(function(a){var t=e.window.height()+"px";a.target("*main-content").css("max-height",t).css("height",t)}).on(window,"resize",n)}else t.exitBlank()},file:function(e){e.inherit("block").on("click",function(e){var t=e.siblings.files,i=0,l=!1;if(t){i=t.length;for(var n=0;n<t.length;n++)if(e.nid()==t[n].nid){a._cfg.selectedIndex=n,l=!0;break}}e.siblings.legacyFile&&!l&&(a._cfg.selectedIndex=i),e.args={xds:e.arg("xds")||"AlbumFileView",target:".xds-album-loadtarget",transition:!1},a.funcs.displayFile(e)})},selectedIndex:function(e){e.data=a._cfg.selectedIndex+1+" of "+a._cfg.nFiles},backArrow:function(e){e.inherit("fa.icon"),e.on("click",function(e){e.trigger("album-previous")})},forwardArrow:function(e){e.inherit("fa.icon"),e.on("click",function(e){e.trigger("album-next")})},clipper:function(a){var t=a.state.get("fileThumbnailTweaks");t&&(t.width&&a.addStyle("width",t.width+"px"),t.height&&a.addStyle("height",t.height+"px"),t.flex&&(a.addStyle("flex",t.flex),a.addStyle("height","100%")),t.square&&a.addClass("xds-clipper-square")),1==a.state.get("gridSize")?(a.data&&a.data.Content&&[a.data.Content.nodetype,a.data.Content.nodesubtype].join(".")==e.nt.Document.Bookmark()&&a.addClass("xds-clipper-contains-bookmark"),a.addClass("xds-clipper-singleton")):a.addClass("xds-clipper-multi")},smartGrid:function(a){var t={default:{1:{maxScreenWidth:397},2:{flex:"0 0 50%",square:!0},4:{flex:"0 0 50%",square:!0},default:{limit:9,flex:"0 0 33%",square:!0}},smallGrid:{default:{width:128,height:128}},mobile:{1:{height:1,width:1,maxScreenWidth:397},2:{flex:"0 0 50%",square:!0},4:{flex:"0 0 50%",square:!0},default:{limit:4,width:2,height:1,square:!0}}};if(a.arg("viewerBlacklist")){for(var i=a.arg("viewerBlacklist").split(","),l={},n=0;n<i.length;n++)l[i[n]]=!0;a.state.set("viewerBlacklist",l)}if(e.layout.isPhone()){var r=e.layout.wWidth-40;for(var s in t=t.mobile)if(t.hasOwnProperty(s)){var d=t[s];d.width=parseInt(r/d.width),d.height=d.width,(!d.maxScreenWidth||d.maxScreenWidth>d.width)&&(d.maxScreenWidth=d.width)}}else a.arg("gridMode")&&t[a.arg("gridMode")]?(t=t[a.arg("gridMode")],a.addClass("albums-smartGrid-gridMode-"+a.arg("gridMode"))):t=t.default;var g=0;if(a.arg("stateKey")){var o=a.state.get(a.arg("stateKey")||"amalgamatedFiles");o&&(g=o.length,a.data={files:{file:o}})}else if(a.data.init&&(a.data.init.file&&(g+=1),a.data.init.files)){if(!Array.isArray(a.data.init.files)){var f=a.data.init.files;for(var c in a.data.init.files=[],f)a.data.init.files.push(f[c])}g+=a.data.init.files.length}a.state.set("gridSize",g),0==g&&a.exitBlank();var h=t.default;t[g=Math.min(h.limit,g)]?(a.state.set("fileThumbnailTweaks",t[g]),h=t[g]):t.default&&a.state.set("fileThumbnailTweaks",t.default),a.tag("div").addClass("albums-smartGrid-"+g).addClass("albums-smartGrid-width-"+h.width).addClass("albums-smartGrid-height-"+h.height),(h.gridHeight||h.align)&&a.ready(function(){h.gridHeight&&!e.layout.isPhone()&&a.id(1).css("max-height",h.gridHeight+"px").css("overflow-y","auto"),h.align&&a.id(1).css("text-align",h.align)})},smartFileThumbnail:function(a){a.inherit("fileThumbnail").ready(function(a){if(a.data&&a.data.MaxSize&&2==a.data.MaxSize.length){var t=a.data.MaxSize[0],i=a.data.MaxSize[1];if(t>0&&i>0&&(a.id(1).css("max-width",i+"px").css("max-height",t+"px").find(".xds-screen").css("max-width",i+"px").css("max-height",t+"px"),a.arg("fillViewport"))){var l=function(){a.find(".xds-screen").css("height",e.window.height()+"px")};l(),a.on("window","resize",l)}}})}},funcs:{displayFile:function(t){a._cfg.loaded=t.nid(),e.get_func("loadxds")(t)},onkeyup:function(e){var a={39:"album-next",32:"album-next",37:"album-previous"};a[e.e.keyCode]&&e.trigger(a[e.e.keyCode])}}};return a});

/* modules: code */

"use strict";cf.module("code",function(e,m,t){var a=e.gbl.lib+"codemirror/".concat("5.61.0"),i={_resources:{codemirror:{basePath:a,css:["".concat(a,"/lib/codemirror.css")],js:"".concat(a,"/lib/codemirror.js"),modes:[{name:"APL",mime:"text/apl",mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"C",mime:"text/x-csrc",mode:"clike",ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:["cpp","c++","cc","cxx","hpp","h++","hh","hxx"],alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj","cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists.txt$/},{name:"CoffeeScript",mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"CQL",mime:"text/x-cassandra",mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff","patch"]},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",mode:"erlang",ext:["erl"]},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth","fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy","gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Pug",mime:"text/x-pug",mode:"pug",ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"javascript",ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},{name:"Jinja2",mime:"null",mode:"jinja2"},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mime:"text/n-triples",mode:"ntriples",ext:["nt"]},{name:"Objective C",mime:"text/x-objectivec",mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p","pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",mode:"php",ext:["php","php3","php4","php5","phtml"]},{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:["txt","text","conf","def","list","log"]},{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r"],alias:["rscript"]},{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mime:"text/x-sh",mode:"shell",ext:["sh","ksh","bash"],alias:["bash","sh","zsh"],file:/^PKGBUILD$/},{name:"Sieve",mime:"application/sieve",mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",mode:"verilog",ext:["v"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:["1","2","3","4","5","6","7","8","9"]},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn","ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"Twig",mime:"text/x-twig",mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"XML",mimes:["application/xml","text/xml"],mode:"xml",ext:["xml","xsl","xsd"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",ext:["xy","xquery"]},{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mime:"text/x-yaml",mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}]},highlight:{basePath:e.gbl.lib+"highlight-9.7.0",css:[e.gbl.lib+"highlight-9.7.0/styles/github.css"],js:e.gbl.lib+"highlight-9.7.0/highlight.pack.js"}},types:{editor:function(e){var m=e.get_setting("seedContent");m&&"localStorage"==e.get_setting("seedSource")&&(m={data:localStorage[m]}),e.data=e.data||m&&m.data,e.sparse=!0,e.inherit("f_textarea"),e.ready(function(e){e.newEvent("code.loadResources",{filter:{codemirror:!0}})}).on("xds-code-resourcesLoaded",function(e){e.newEvent("code.loadModeResources")}).on("xds-code-modesLoaded",function(e){var m=e.find(".xdl-forms-input");e.temp.codemirror=CodeMirror.fromTextArea(m[0],{mode:"javascript",lineNumbers:!0,autofocus:!0}),e.temp.codemirror.on("change",function(m){e.temp.codemirror.save()})}).on("xds-code-saveDelta",function(e){e.get_setting("editor").trigger("xds-delta",{delta:e.temp.codemirror.getValue(),deltaSource:"code"}),e.trigger("xds-deltaSaved")})},render:function(m){m.tag("div").posttag('<pre style="white-space:pre-wrap;"><code class="html">').preclosetag("</code></pre>"),m.data&&m.data.fileContents&&(m.displayVal=m.data.fileContents),m.ready(function(e){e.newEvent("code.loadResources",{filter:{highlight:!0}})}).on("xds-code-resourcesLoaded",function(m){if("undefined"!=typeof Worker){var t=m.dom()[0].childNodes[0].textContent,a=new Worker(e.gbl.lib+"workers/highlight.js");a.onmessage=function(e){try{m.dom()[0].childNodes[0].innerHTML=e.data}catch(e){}a.terminate(),a=void 0,m.trigger("xds-code-render-ready")},a.postMessage(t)}else hljs.highlightBlock(m.dom()[0].childNodes[0]),m.trigger("xds-code-render-ready")})}},fn:{saveDelta:function(e){e.target("*editor").trigger("xds-code-saveDelta")},loadModeResources:function(m){var t=["javascript"];m.get_arg("mode")&&(t=m.get_arg("mode").split(","));for(var a={},o=[],s=0;s<i._resources.codemirror.modes.length;s++)a[i._resources.codemirror.modes[s].mode]=i._resources.codemirror.modes[s];for(var x=0;x<t.length;x++){var r=a[t[x]];r&&o.push([i._resources.codemirror.basePath,"mode",r.mode,r.mode+".js"].join("/"))}e.resources.load(o,function(){m.trigger("xds-code-modesLoaded")})},loadResources:function(m){var t=[],a=!1;for(var o in m.get_arg("filter")&&(a=m.get_arg("filter")),i._resources)if(!a||a[o]){if(i._resources.hasOwnProperty(o)&&i._resources[o].css)if("string"==typeof i._resources[o].css)t.push(i._resources[o].css);else for(var s=0;s<i._resources[o].css.length;s++)t.push(i._resources[o].css[s]);i._resources.hasOwnProperty(o)&&i._resources[o].js&&t.push(i._resources[o].js)}e.resources.load(t,function(){m.trigger("xds-code-resourcesLoaded")})}}};return i});

/* modules: csv */

"use strict";cf.module("csv",function(e,t,n,r){e.resources.load(e.gbl.lib+"pkg/node_modules/jquery-csv/src/jquery.csv.js");return{types:{readCSV:function(t){if("undefined"!=typeof FileReader){var n=new FileReader;n.onload=function(e){!function e(t,n){var r,s=n.target.result;if(jQuery.csv){try{s=s.replace(/\r\n|\n|\r/g,"\n"),r=jQuery.csv.toObjects(s)}catch(e){return void t.trigger("csv-error")}t.trigger("csv-success",{results:r}),t.id(1).html('<span class="xds-csv-types-readCSV-filename">'+t.temp.file.name+"</span>"),t.temp.results=r,t.sparse=!0}else setTimeout(function(){e(t,s)},100)}(t,e)},t.preclosetag('<button class="xds-button">'+e.lang("Browse")+"</button>"),t.preclosetag('<input type="file">'),t.on("change",function(e,t){var r=t.find("input")[0].files;e.temp.file=r[0],n.readAsText(e.temp.file)}),t.ready(function(e,t){e.find(".xds-button").on("click",function(t){e.find("input").trigger("click")})})}else t.xds.title=e.lang("Sorry, your browser does not support CSV imports."),t.inherit("noContent").exit()}}}});

/* modules: sheets */

"use strict";cf.module("sheets",function(e,a,t){var s={_resources:{xlsx:{basePath:e.gbl.lib+"bower_components/js-xlsx",js:e.gbl.lib+"bower_components/js-xlsx/dist/xlsx.full.min.js"},csv:"CSV-JS",handsontable:{name:"handsontable",basePath:e.gbl.lib+"bower_components/handsontable/dist/",css:[e.gbl.lib+"bower_components/handsontable/dist/handsontable.full.min.css"],js:e.gbl.lib+"bower_components/handsontable/dist/handsontable.full.min.js"}},drawXLSXFile:function(a){var t=e.tpl("{{dl}}{{nid}}?field={{field}}&xds={{xds}}&ui={{ui}}",{dl:e.gbl.dl,nid:a.cnid(),field:"file",xds:"fileThumbnail",ui:a.cssPath}),n=a.state.get("xlsxViewer");void 0===n?(e.get("resourceutils").xdoReady(a,[s._resources.handsontable,s._resources.xlsx,s._resources.csv]).then(function(s){var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=function(t){for(var s=n.response,r=new Uint8Array(s),d=[],l=0;l<r.length;++l)d[l]=String.fromCharCode(r[l]);var o,i=d.join("");try{var c=XLSX.read(i,{type:"binary"});JSON.parse(JSON.stringify(a.data));var h=XLSX.utils.sheet_to_csv(c.Sheets[c.SheetNames[0]]);try{CSV.RELAXED=!0,new Handsontable(a.dom()[0],{data:CSV.parse(h),readOnly:!0,search:!0})}catch(t){try{CSV.IGNORE_QUOTES=!0,new Handsontable(a.dom()[0],{data:CSV.parse(e.unescapeRichText(h)),readOnly:!0,search:!0})}catch(t){CSV.IGNORE_QUOTES=!1,e.dialog(e.lang("Error: Unable to preview this file."))}}}catch(t){var u=new TextDecoder("utf-8").decode(r);CSV.RELAXED=!0,o=!1;try{o=CSV.parse(u)}catch(t){CSV.IGNORE_QUOTES=!0,o=CSV.parse(u)}o?new Handsontable(a.dom()[0],{data:o,readOnly:!0,search:!0}):e.dialog(e.lang("Error: Unable to preview this file."))}a.target("*loading").hide()},n.send()},function(e){}),a.data.loading=!0,a.addChild({id:"loading",type:"files.loading"})):(a.data=n,a.data.loading=!1,a.inherit("sheets.draw"))},drawCSVFile:function(a){var t=e.tpl("{{dl}}{{nid}}?field={{field}}&xds={{xds}}&ui={{ui}}",{dl:e.gbl.dl,nid:a.cnid(),field:"file",xds:"fileThumbnail",ui:a.cssPath}),n=a.state.get("csvViewer");void 0===n?(e.get("resourceutils").xdoReady(a,[s._resources.handsontable,s._resources.csv]).then(function(s){e.ajax({xdo:a,url:t,callback:function(e){var t=JSON.parse(JSON.stringify(a.data));t.fileContents=e.errorstr,t.loading=!1,a.state.set("csvViewer",t)}})},function(e){}),a.data.loading=!0,a.addChild({id:"loading",type:"files.loading"})):(a.data=n,a.data.loading=!1,a.inherit("sheets.draw"))},draw:function(t){t.displayVal="",e.get("resourceutils").xdoReady(t,[s._resources.handsontable,s._resources.xlsx,s._resources.csv]).then(function(s){var n=t.data;t.data.fileContents&&(n=t.data.fileContents),n=e.mlunescape(n);var r,d={readOnly:!1,columnSorting:!0,colHeaders:!0,fixedRowsTop:1,manualColumnResize:!0,manualRowResize:!0,sortIndicator:!0,trimWhitespace:!1,rowHeaders:!0,search:!0};try{CSV.RELAXED=!0,CSV.IGNORE_QUOTES=!1,r=CSV.parse(n),d.data=r,d.colHeaders=r.shift(),t.temp.handsontable=new Handsontable(t.dom()[0],d)}catch(a){try{CSV.IGNORE_QUOTES=!0,r=CSV.parse(n),d.data=r,d.colHeaders=r.shift(),t.temp.handsontable=new Handsontable(t.dom()[0],d)}catch(a){CSV.IGNORE_QUOTES=!1,t.data.fallback="files.text",t.global("statekey")&&t.state.set(t.global("statekey"),t.data),e.dialog(e.lang("Error: Unable to preview this file."))}}t.temp.handsontable&&t.temp.handsontable.search&&t.temp.handsontable.search.query&&t.on("xds-sheets-search",function(e){a.clearTimeout(e.temp.searchtimeout);var t=e.temp.handsontable.search.query(e.get_arg("query"));e.state.set("xds-sheets-query-resultcount",t.length),e.temp.searchtimeout=a.setTimeout(function(){delete e.temp.searchtimeout,e.temp.handsontable.render()},100)}),t.trigger("xds-sheets-render-ready")},function(e){})},edit:function(e){}};return s});

/* resources: compoundFileThumbnail */

"use strict";cf.resource("compoundFileThumbnail",function(e,i,a){return{smartThumb:function(e){var i=e.arg("iconLimit");if(e.tag("div"),i){for(var a=[],t=0;t<i&&t<e.data.files.length;t++)a.push(e.data.files[t]);e.data.files=a}e.data&&e.data.files&&e.addClass("xds-compoundFileThumbnail-smartThumb-grid-"+e.data.files.length)},fileThumb:function(a){var t,l=a.get_val(),n=l.thumbnail||l.file||l,d=n.ContentType||"",s=!1,r=a.get_val("nid"),u=r,f=a.arg("size");if(!isNaN(parseInt(f))){for(var o=e.get("files")._defs.validThumbnailSizes.square,h=0,g=0;g<o.length;g++)if(f<=o[g]){h=o[g];break}0==h&&(h=1024),f=h}var m=f?"orig"===f?"&size=orig":"&size="+f+","+f:"&size=128,128";if(!l)return!1;if(a.tag("div"),a.data&&a.data.viewxds&&"Embed"==a.data.viewxds)try{var c=JSON.parse(a.data.field);if(d="image/jpeg",!c.thumbnail_url){var b=parseInt(a.arg("size")||128);return a.addStyles({"font-size":b/2+"px","line-height":b+"px",width:b+"px",display:"block","text-align":"center"}),a.arg("icon","link"),void a.inherit("fa.icon")}s=e.get("files").utils.embedExternalImageURI(a,c.thumbnail_url)}catch(e){}if("image"===d.substr(0,5)&&!~d.indexOf("photoshop")&&!~d.indexOf("tiff")||l&&l.thumbnail){var p=!0;e.get("files")._getFilePublicThumbnailUrl(a,!1)&&(s=e.get("files")._getFilePublicThumbnailUrl(a,!1),p=!1),s?t=s:l&&l.thumbnail?(l.rid&&(a.rnode.rid=l.rid,u=a.cnid()),t=e.gbl.p+"core/nodedl/"+(u||r)+"?field=file&xds=fileThumbnail"+m):t=e.gbl.p+"core/nodedl/"+(u||r)+"?field="+(("thumbnail"===a.xds.field?"file":a.xds.field)||"file")+"&xds=fileThumbnail"+m;var x=a.state.get(a.id()+"queueFinished");if(p&&!x){e.get("queues").get("net::imageCache").queue(t,a,{rescan:!1}).promise.then(function(e){i.setTimeout(function(){a.state.set(a.id()+"queueFinished",!0)},1)}).catch(function(e){});var v=parseInt(a.arg("size")||128);a.addStyles({"font-size":v/2+"px","line-height":v+"px",width:v+"px",display:"block","text-align":"center"}),a.arg("icon","image"),a.inherit("fa.icon")}else a.posttag([e.html.div(d,["xds-fileThumb-image"],{style:"background-image:url("+t+")"},!0),e.html.p(n.ContentName,"xds-compoundFileThumbnail-fileThumb-name",void 0,!0)]);a.displayVal=""}else a.inherit("files.typeIcon").addClass("xds-fileThumbnail-icon")}}});

/* resources: fileViewer */

"use strict";cf.resource("fileViewer",function(e,i,r){e.extend.fn({fileViewerUpdateFullScreen:function(i,r){if($(".lightbox-galleryFullScreen").length){var l=$(".fileViewer-fileView"),t=$(".galleryFullScreen");l.xds.rnode.nid!=t.xds.node.nid&&(i.args.xds="galleryFullScreen",i.args.nid=l.xds.rnode.nid,i.args.rid=l.xds.rnode.rid,i.args.transition=!1,i.args.target=".galleryFullScreen",e.fn.loadxds(i))}},fileViewerShowIf:function(e,i){return!0}});var l=!1,t={updateImageSize:function(e,r){var a=$(".fileViewer-fileView-box-file img");if(0!=a.length){var n=a[0].width,f=a[0].height;!l||e.e&&"onload"==e.e.type?((l=new Image).onload=t.updateImageSize,l.src=a[0].src):(l.onload=null,n=l.width,f=l.height);var s=$(i).height()-70,d=s+"px";$(".fileViewer-fileView-box").css("line-height",d),$(".fileViewer-fileView-box-file").css("height",d),$(".fileViewer-fileView-box-file img").css("max-height",d);var w=90,h=$(".fileViewer-threadBox");h.length>0&&(w+=$(h[0]).width());var o=$(i).width()-w,g=o+"px";$(".fileViewer-fileView-box").css("width",g),$(".fileViewer-fileView-box-file").css("width",g),$(".fileViewer-fileView-box-file img").css("max-width",g);var c=Math.max(n,f),x=Math.max(o,s);if(c<x){var V=a[0].src.split("size=");a[0].src=V[0]+"size="+x,l.src=a[0].src}}}};return t});

/* resources: fileViewerFeed */

"use strict";cf.resource("fileViewerFeed",function(e,i,r,d){return e.extend.fn({fileViewerFeedLoadReply:function(i){var r=$(".fileViewerFeed .feedItem-right");if(r.length){var d=r[r.length-1],l=$(d).xdo;l.has_write("fileViewerFeedReply")&&(l.args={callernid:i.nid(),xds:"fileViewerFeedReply"},e.get_func("doreply")(l))}}}),{}});
});
